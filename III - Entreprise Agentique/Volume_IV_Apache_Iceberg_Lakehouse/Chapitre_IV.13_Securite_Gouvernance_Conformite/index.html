
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Corpus encyclopédique francophone — science informatique, interopérabilité et entreprise agentique">
      
      
        <meta name="author" content="André-Guy Bruneau">
      
      
        <link rel="canonical" href="https://agbruneau.github.io/CorpusInformatique/III%20-%20Entreprise%20Agentique/Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.13_Securite_Gouvernance_Conformite/">
      
      
        <link rel="prev" href="../Chapitre_IV.12_Evolution_Streaming_Lakehouse/">
      
      
        <link rel="next" href="../Chapitre_IV.14_Integration_Microsoft_Fabric_PowerBI/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>IV.13 — Sécurité, gouvernance et conformité - Corpus Informatique</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapitre-iv13-securite-gouvernance-et-conformite-du-lakehouse" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../.." title="Corpus Informatique" class="md-header__button md-logo" aria-label="Corpus Informatique" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Corpus Informatique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              IV.13 — Sécurité, gouvernance et conformité
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/agbruneau/CorpusInformatique" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agbruneau/CorpusInformatique
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.1_Fondements_Logiques_Raisonnement/" class="md-tabs__link">
          
  
  
    
  
  I — Science et Génie Informatique

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.1_Introduction_Problematique/" class="md-tabs__link">
          
  
  
    
  
  II — Interopérabilité

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.1_Crise_Integration_Systemique/" class="md-tabs__link">
          
  
  
    
  
  III — Entreprise Agentique

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Corpus Informatique" class="md-nav__button md-logo" aria-label="Corpus Informatique" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Corpus Informatique
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/agbruneau/CorpusInformatique" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agbruneau/CorpusInformatique
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    I — Science et Génie Informatique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    I — Science et Génie Informatique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume I — Fondements Mathématiques et Théorie de l'Informatique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume I — Fondements Mathématiques et Théorie de l'Informatique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.1_Fondements_Logiques_Raisonnement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.1 — Fondements logiques et raisonnement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.2_Structures_Discretes_Combinatoire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.2 — Structures discrètes et combinatoire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.3_Theorie_Graphes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.3 — Théorie des graphes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.4_Langages_Formels_Automates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.4 — Langages formels et automates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.5_Calculabilite_Decidabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.5 — Calculabilité et décidabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.6_Theorie_Complexite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.6 — Théorie de la complexité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume II — Architecture des Ordinateurs et Systèmes Numériques
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume II — Architecture des Ordinateurs et Systèmes Numériques
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.7_Systemes_Numeriques_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.7 — Systèmes numériques et données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.8_Circuits_Combinatoires/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.8 — Circuits combinatoires
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.9_Circuits_Sequentiels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.9 — Circuits séquentiels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.10_Conception_Systeme_HDL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.10 — Conception système HDL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.11_Architecture_ISA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.11 — Architecture ISA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.12_Conception_CPU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.12 — Conception CPU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.13_Parallelisme_ILP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.13 — Parallélisme ILP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.14_Hierarchie_Memoire_Stockage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.14 — Hiérarchie mémoire et stockage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.15_Systemes_IO_Accelere/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.15 — Systèmes I/O accélérés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume III — Systèmes d'Exploitation, Langages et Environnements
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume III — Systèmes d'Exploitation, Langages et Environnements
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.16_Systemes_Exploitation_OS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.16 — Systèmes d'exploitation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.17_Gestion_Concurrence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.17 — Gestion de la concurrence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.18_Gestion_Memoire_Fichiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.18 — Gestion mémoire et fichiers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.19_Conception_Langages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.19 — Conception des langages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.20_Compilation_Interpretation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.20 — Compilation et interprétation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.21_Environnements_Virtualisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.21 — Environnements et virtualisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume IV — Structures de Données, Algorithmique et Génie Logiciel
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume IV — Structures de Données, Algorithmique et Génie Logiciel
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.22_Structures_Donnees_Fondamentales/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.22 — Structures de données fondamentales
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.23_Structures_Donnees_Avancees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.23 — Structures de données avancées
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.24_Conception_Analyse_Algorithmes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.24 — Conception et analyse d'algorithmes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.25_Algorithmes_Graphes_Avances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.25 — Algorithmes de graphes avancés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.26_Processus_Developpement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.26 — Processus de développement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.27_Architecture_Logicielle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.27 — Architecture logicielle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.28_Qualite_Test_Maintenance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.28 — Qualité, test et maintenance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.29_DevOps_SRE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.29 — DevOps et SRE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume V — Données, Réseaux, Cloud et Sécurité
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume V — Données, Réseaux, Cloud et Sécurité
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.30_SGBD_Fondements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.30 — SGBD fondements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.31_SGBD_Implementation_Transactions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.31 — SGBD implémentation et transactions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.32_Donnees_Modernes_BigData/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.32 — Données modernes et Big Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.33_Fondements_Reseaux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.33 — Fondements des réseaux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.34_Protocoles_Internetworking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.34 — Protocoles et internetworking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.35_Systemes_Distribues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.35 — Systèmes distribués
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.36_Cloud_Infrastructures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.36 — Cloud et infrastructures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.37_Fondements_Securite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.37 — Fondements de la sécurité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.38_Cryptographie_Appliquee/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.38 — Cryptographie appliquée
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.39_Securite_Reseaux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.39 — Sécurité des réseaux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.40_Securite_Systemes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.40 — Sécurité des systèmes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume VI — Intelligence Artificielle et Systèmes Interactifs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume VI — Intelligence Artificielle et Systèmes Interactifs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.41_Fondements_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.41 — Fondements de l'IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.42_Connaissance_Raisonnement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.42 — Connaissance et raisonnement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.43_ML_Fondements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.43 — ML fondements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.44_DeepLearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.44 — Deep Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.45_Reinforcement_Learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.45 — Reinforcement Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.46_TALN_NLP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.46 — TALN / NLP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.47_Vision_Ordinateur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.47 — Vision par ordinateur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.48_Infographie_Visualisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.48 — Infographie et visualisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.49_IHM_HCI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.49 — IHM / HCI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.50_Robotique_IoT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.50 — Robotique et IoT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume VII — Technologies Émergentes et Frontières
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume VII — Technologies Émergentes et Frontières
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.51_Informatique_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.51 — Informatique quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.52_Algorithmes_Cryptographie_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.52 — Algorithmes et cryptographie quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.53_HPC_Exascale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.53 — HPC et exascale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.54_Architectures_Post_Moore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.54 — Architectures post-Moore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.55_Modeles_Fondateurs_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.55 — Modèles fondateurs IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.56_AGI_Alignement_Securite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.56 — AGI, alignement et sécurité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.57_Sciences_Computationnelles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.57 — Sciences computationnelles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.58_CyberPhysiques_Jumeaux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.58 — Systèmes cyber-physiques et jumeaux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.59_Web3_Decentralise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.59 — Web3 et décentralisé
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.60_Synthese_Frontieres/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.60 — Synthèse et frontières
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume VIII — Convergence AGI–Quantique : Fondements et Algorithmes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume VIII — Convergence AGI–Quantique : Fondements et Algorithmes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.61_Introduction_Informatique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.61 — Introduction à l'informatique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.62_Convergence_AGI_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.62 — Convergence AGI-quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.63_Evolution_IA_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.63 — Évolution IA-quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.64_Reseaux_Neuronaux_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.64 — Réseaux neuronaux quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.65_Algorithmes_Evolutionnaires_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.65 — Algorithmes évolutionnaires quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.66_Renforcement_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.66 — Renforcement quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.67_Architectures_Hybrides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.67 — Architectures hybrides
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.68_SVM_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.68 — SVM quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.69_Codage_Donnees_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.69 — Codage de données quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.70_Scalabilite_Correction_Erreurs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.70 — Scalabilité et correction d'erreurs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume IX — Convergence AGI–Quantique : Applications et Perspectives
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume IX — Convergence AGI–Quantique : Applications et Perspectives
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.71_TALN_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.71 — TALN quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.72_Securite_Confidentialite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.72 — Sécurité et confidentialité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.73_Ethique_Reglementaire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.73 — Éthique et réglementaire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.74_Implementation_Materielle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.74 — Implémentation matérielle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.75_Middleware_Software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.75 — Middleware et software
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.76_Etudes_Cas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.76 — Études de cas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.77_Durabilite_Energie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.77 — Durabilité et énergie
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.78_Metriques_Bancs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.78 — Métriques et bancs d'essai
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.79_Perspectives_Avenir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.79 — Perspectives d'avenir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.80_Infrastructure_Centres_Donnees_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.80 — Infrastructure et centres de données IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    II — Interopérabilité
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    II — Interopérabilité
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.1_Introduction_Problematique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.1 — Introduction et problématique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.2_Fondements_Theoriques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.2 — Fondements théoriques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.3_Integration_Applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.3 — Intégration des applications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.4_Integration_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.4 — Intégration des données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.5_Integration_Evenements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.5 — Intégration des événements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.6_Standards_Contrats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.6 — Standards et contrats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.7_Resilience_Observabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.7 — Résilience et observabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.8_Collaboration_Automatisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.8 — Collaboration et automatisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.9_Architecture_Reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.9 — Architecture de référence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.10_Order_to_Cash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.10 — Order-to-Cash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.11_Entreprise_Agentique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.11 — Entreprise agentique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.12_Securite_Identite_Conformite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.12 — Sécurité, identité et conformité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.A_Annexes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annexes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    III — Entreprise Agentique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    III — Entreprise Agentique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume I — Fondations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume I — Fondations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.1_Crise_Integration_Systemique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.1 — Crise d'intégration systémique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.2_Fondements_Dimensions_Interoperabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.2 — Fondements et dimensions de l'interopérabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.3_Cadres_Reference_Standards_Maturite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.3 — Cadres de référence, standards et maturité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.4_Principes_Architecture_Reactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.4 — Principes d'architecture réactive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.5_Ecosysteme_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.5 — Écosystème API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.6_Architecture_Evenements_EDA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.6 — Architecture événements (EDA)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.7_Contrats_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.7 — Contrats de données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.8_Conception_Implementation_Observabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.8 — Conception et implémentation de l'observabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.9_Etudes_Cas_Architecturales/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.9 — Études de cas architecturales
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.10_Limites_Interoperabilite_Semantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.10 — Limites de l'interopérabilité sémantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.11_IA_Moteur_Interoperabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.11 — IA moteur d'interopérabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.12_Definition_Interoperabilite_Cognitivo_Adaptative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.12 — Définition de l'interopérabilité cognitivo-adaptative
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.13_Ere_IA_Agentique_Modele_Travailleur_Numerique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.13 — Ère IA agentique et modèle du travailleur numérique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.14_Maillage_Agentique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.14 — Maillage agentique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.15_Ingenierie_Systemes_Cognitifs_Protocoles_Interaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.15 — Ingénierie des systèmes cognitifs et protocoles d'interaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.16_Modele_Operationnel_Symbiose_Humain_Agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.16 — Modèle opérationnel de symbiose humain-agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.17_Gouvernance_Constitutionnelle_Alignement_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.17 — Gouvernance constitutionnelle et alignement IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.18_AgentOps_Industrialisation_Securisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.18 — AgentOps : industrialisation et sécurisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.19_Architecte_Intentions_Role_Sociotechnique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.19 — Architecte des intentions : rôle sociotechnique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.20_Cockpit_Berger_Intention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.20 — Cockpit du berger d'intention
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.21_Feuille_Route_Transformation_Agentique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.21 — Feuille de route de la transformation agentique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.22_Gestion_Strategique_Portefeuille_Applicatif_APM_Cognitif/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.22 — Gestion stratégique du portefeuille applicatif (APM cognitif)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.23_Patrons_Modernisation_Agentification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.23 — Patrons de modernisation et agentification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.24_Industrialisation_Ingenierie_Plateforme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.24 — Industrialisation et ingénierie de plateforme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.25_Economie_Cognitive_Diplomatie_Algorithmique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.25 — Économie cognitive et diplomatie algorithmique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.26_Gestion_Risques_Systemiques_Superalignement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.26 — Gestion des risques systémiques et superalignement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.27_Prospective_Agent_Auto_Architecturant_AGI_Entreprise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.27 — Prospective : agent auto-architecturant et AGI d'entreprise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.28_Conclusion_Architecture_Intentionnelle_Sagesse_Collective/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.28 — Conclusion : architecture intentionnelle et sagesse collective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume II — Infrastructure Agentique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume II — Infrastructure Agentique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.1_Ingenierie_Plateforme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.1 — Ingénierie de plateforme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.2_Fondamentaux_Apache_Kafka_Confluent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.2 — Fondamentaux Apache Kafka et Confluent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.3_Conception_Modelisation_Flux_Evenements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.3 — Conception et modélisation des flux d'événements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.4_Contrats_Donnees_Gouvernance_Semantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.4 — Contrats de données et gouvernance sémantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.5_Flux_Temps_Reel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.5 — Flux temps réel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.6_Google_Cloud_Vertex_AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.6 — Google Cloud et Vertex AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.7_Ingenierie_Contexte_RAG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.7 — Ingénierie de contexte et RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.8_Integration_Backbone_Evenementiel_Couche_Cognitive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.8 — Intégration backbone événementiel et couche cognitive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.9_Patrons_Architecturaux_Avances_AEM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.9 — Patrons architecturaux avancés (AEM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.10_Pipelines_CI_CD_Deploiement_Agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.10 — Pipelines CI/CD et déploiement d'agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.11_Observabilite_Comportementale_Monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.11 — Observabilité comportementale et monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.12_Tests_Evaluation_Simulation_Systemes_Multi_Agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.12 — Tests, évaluation et simulation de systèmes multi-agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.13_Paysage_Menaces_Securite_Systemes_Agentiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.13 — Paysage des menaces et sécurité des systèmes agentiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.14_Securisation_Infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.14 — Sécurisation de l'infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.15_Conformite_Reglementaire_Gestion_Confidentialite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.15 — Conformité réglementaire et gestion de la confidentialité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume III — Apache Kafka : Guide de l'Architecte
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume III — Apache Kafka : Guide de l'Architecte
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.1_Decouvrir_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.1 — Découvrir Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.2_Architecture_Cluster_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.2 — Architecture du cluster Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.3_Clients_Kafka_Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.3 — Clients Kafka en production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.4_Applications_Consommatrices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.4 — Applications consommatrices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.5_Cas_Utilisation_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.5 — Cas d'utilisation Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.6_Contrats_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.6 — Contrats de données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.7_Patrons_Interaction_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.7 — Patrons d'interaction Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.8_Conception_Application_Streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.8 — Conception d'application streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.9_Gestion_Kafka_Entreprise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.9 — Gestion Kafka en entreprise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.10_Organisation_Projet_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.10 — Organisation d'un projet Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.11_Operer_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.11 — Opérer Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.12_Avenir_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.12 — L'avenir de Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume IV — Apache Iceberg et Lakehouse
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume IV — Apache Iceberg et Lakehouse
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.1_Monde_Lakehouse_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.1 — Le monde Lakehouse et Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.2_Anatomie_Technique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.2 — Anatomie technique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.3_Mise_Pratique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.3 — Mise en pratique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.4_Preparer_Passage_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.4 — Préparer le passage à Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.5_Selection_Couche_Stockage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.5 — Sélection de la couche de stockage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.6_Architecture_Couche_Ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.6 — Architecture de la couche d'ingestion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.7_Implementation_Couche_Catalogue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.7 — Implémentation de la couche catalogue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.8_Conception_Couche_Federation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.8 — Conception de la couche de fédération
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.9_Comprendre_Couche_Consommation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.9 — Comprendre la couche de consommation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.10_Maintenir_Lakehouse_Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.10 — Maintenir le Lakehouse en production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.11_Operationnaliser_Apache_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.11 — Opérationnaliser Apache Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.12_Evolution_Streaming_Lakehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.12 — Évolution du streaming Lakehouse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    IV.13 — Sécurité, gouvernance et conformité
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.13 — Sécurité, gouvernance et conformité
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv131-architecture-de-securite-multicouche" class="md-nav__link">
    <span class="md-ellipsis">
      
        IV.13.1 Architecture de Sécurité Multicouche
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IV.13.1 Architecture de Sécurité Multicouche">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#le-defi-de-la-securite-distribuee" class="md-nav__link">
    <span class="md-ellipsis">
      
        Le Défi de la Sécurité Distribuée
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securite-du-stockage-objet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sécurité du Stockage Objet
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#le-chiffrement-natif-iceberg" class="md-nav__link">
    <span class="md-ellipsis">
      
        Le Chiffrement Natif Iceberg
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#securite-au-niveau-du-catalogue" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sécurité au Niveau du Catalogue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-nessie-git-pour-les-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Nessie : Git pour les Données
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-des-cles-et-rotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestion des Clés et Rotation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv132-controles-dacces-granulaires" class="md-nav__link">
    <span class="md-ellipsis">
      
        IV.13.2 Contrôles d'Accès Granulaires
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IV.13.2 Contrôles d&#39;Accès Granulaires">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#les-niveaux-de-controle-dacces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Les Niveaux de Contrôle d'Accès
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-level-security-rls" class="md-nav__link">
    <span class="md-ellipsis">
      
        Row-Level Security (RLS)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#column-level-security-et-masquage-dynamique" class="md-nav__link">
    <span class="md-ellipsis">
      
        Column-Level Security et Masquage Dynamique
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vues-dynamiques-securisees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vues Dynamiques Sécurisées
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patterns-de-masquage-avances" class="md-nav__link">
    <span class="md-ellipsis">
      
        Patterns de Masquage Avancés
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tableaux-de-bord-de-gouvernance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tableaux de Bord de Gouvernance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qualite-des-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Qualité des Données
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#catalogage-et-decouverte-des-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Catalogage et Découverte des Données
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv134-conformite-reglementaire-au-canada" class="md-nav__link">
    <span class="md-ellipsis">
      
        IV.13.4 Conformité Réglementaire au Canada
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IV.13.4 Conformité Réglementaire au Canada">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#la-loi-25-du-quebec" class="md-nav__link">
    <span class="md-ellipsis">
      
        La Loi 25 du Québec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-lprpde-federale" class="md-nav__link">
    <span class="md-ellipsis">
      
        La LPRPDE Fédérale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conformite-sectorielle-bsif-sox" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conformité Sectorielle (BSIF, SOX)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv135-audit-et-surveillance" class="md-nav__link">
    <span class="md-ellipsis">
      
        IV.13.5 Audit et Surveillance
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IV.13.5 Audit et Surveillance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#journalisation-des-acces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Journalisation des Accès
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alertes-de-securite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alertes de Sécurité
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reponse-aux-incidents-de-securite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Réponse aux Incidents de Sécurité
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv136-etudes-de-cas-canadiennes" class="md-nav__link">
    <span class="md-ellipsis">
      
        IV.13.6 Études de Cas Canadiennes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iv137-resume" class="md-nav__link">
    <span class="md-ellipsis">
      
        IV.13.7 Résumé
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IV.13.7 Résumé">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture-de-securite-multicouche" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture de Sécurité Multicouche
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controles-dacces-granulaires" class="md-nav__link">
    <span class="md-ellipsis">
      
        Contrôles d'Accès Granulaires
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gouvernance-des-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gouvernance des Données
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conformite-canadienne" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conformité Canadienne
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-et-reponse-aux-incidents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Audit et Réponse aux Incidents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommandations-strategiques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommandations Stratégiques
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        Références
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Références">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references-croisees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Références croisées
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.14_Integration_Microsoft_Fabric_PowerBI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.14 — Intégration Microsoft Fabric et Power BI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.15_Contexte_Canadien_Etudes_Cas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.15 — Contexte canadien et études de cas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.16_Conclusion_Perspectives_2026_2030/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.16 — Conclusion et perspectives 2026-2030
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.Annexe_A_Specification_Apache_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annexe A — Spécification Apache Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_IV.Annexe_B_Glossaire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annexe B — Glossaire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume V — Développeur Renaissance
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume V — Développeur Renaissance
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.0_Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.0 — Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.1_Convergence_Ages_Or/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.1 — Convergence des âges d'or
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.2_Curiosite_Appliquee/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.2 — Curiosité appliquée
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.3_Pensee_Systemique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.3 — Pensée systémique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.4_Nouvelle_Communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.4 — Nouvelle communication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.5_Imperatif_Qualite_Responsabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.5 — Impératif qualité et responsabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.6_Capital_Humain_Profil_Polymathe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.6 — Capital humain et profil polymathe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.7_Art_Batir_Futur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.7 — L'art de bâtir le futur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.8_Bibliotheque_Developpeur_Renaissance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.8 — Bibliothèque du développeur Renaissance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.9_Mandat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.9 — Mandat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.10_Spec_Driven_Development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.10 — Spec-Driven Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="chapitre-iv13-securite-gouvernance-et-conformite-du-lakehouse">Chapitre IV.13 - SÉCURITÉ, GOUVERNANCE ET CONFORMITÉ DU LAKEHOUSE<a class="headerlink" href="#chapitre-iv13-securite-gouvernance-et-conformite-du-lakehouse" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>La démocratisation des données constitue l'une des promesses les plus séduisantes du Data Lakehouse. En centralisant les données organisationnelles dans un format ouvert et accessible par une multitude de moteurs de requête, l'architecture Iceberg permet à chaque analyste, scientifique de données et application d'accéder aux informations dont ils ont besoin. Cependant, cette accessibilité accrue s'accompagne d'une responsabilité proportionnelle : protéger les données sensibles, contrôler les accès, et démontrer la conformité aux cadres réglementaires de plus en plus stricts.</p>
<p>Pour les organisations canadiennes, ces enjeux revêtent une importance particulière. La Loi 25 au Québec, entrée pleinement en vigueur en septembre 2024, impose des exigences strictes en matière de consentement explicite, de droit à l'effacement et de portabilité des données. La LPRPDE (Loi sur la protection des renseignements personnels et les documents électroniques) au niveau fédéral, actuellement en cours de modernisation, établit les principes fondamentaux de protection de la vie privée. Dans les secteurs réglementés tels que les services financiers, les directives du BSIF ajoutent des exigences supplémentaires de résilience opérationnelle et de gestion des risques technologiques.</p>
<p>Ce chapitre présente une approche holistique de la sécurité et de la gouvernance du Lakehouse. Nous examinerons d'abord l'architecture de sécurité multicouche qui protège les données à chaque niveau, du stockage objet au catalogue. Puis nous explorerons les mécanismes de contrôle d'accès, des permissions grossières au niveau des tables jusqu'au masquage dynamique au niveau des colonnes. Ensuite, nous aborderons la gouvernance des données à travers le lignage, la qualité et l'observabilité. Enfin, nous présenterons les stratégies de conformité spécifiques au contexte canadien, illustrées par des études de cas d'organisations ayant réussi cette transformation.</p>
<hr />
<h2 id="iv131-architecture-de-securite-multicouche">IV.13.1 Architecture de Sécurité Multicouche<a class="headerlink" href="#iv131-architecture-de-securite-multicouche" title="Permanent link">&para;</a></h2>
<h3 id="le-defi-de-la-securite-distribuee">Le Défi de la Sécurité Distribuée<a class="headerlink" href="#le-defi-de-la-securite-distribuee" title="Permanent link">&para;</a></h3>
<p>L'architecture du Data Lakehouse introduit des défis de sécurité uniques par rapport aux systèmes monolithiques traditionnels. Dans un entrepôt de données classique, un seul système contrôle l'accès aux données, simplifiant la gestion des permissions. Dans un Lakehouse, les données résident sur un stockage objet (S3, ADLS, GCS), les métadonnées sont gérées par un catalogue (REST Catalog, Glue, Polaris), et de multiples moteurs de requête (Spark, Flink, Trino, Dremio) peuvent accéder aux mêmes tables. Cette distribution crée des vecteurs d'attaque potentiels à chaque couche.</p>
<p>La spécification Apache Iceberg elle-même ne définit pas de mécanismes de gouvernance ou de contrôle d'accès. Ce choix architectural délibéré permet la flexibilité et l'interopérabilité, mais transfère la responsabilité de la sécurité aux couches adjacentes de l'écosystème. Une stratégie de sécurité efficace doit donc couvrir simultanément le stockage, le catalogue et les moteurs de calcul.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>┌─────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>│             ARCHITECTURE DE SÉCURITÉ MULTICOUCHE DU LAKEHOUSE           │
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├─────────────────────────────────────────────────────────────────────────┤
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>│                                                                         │
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>│  COUCHE 1 : STOCKAGE OBJET                                              │
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>│  ┌───────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>│  │  • Chiffrement au repos (SSE-S3, SSE-KMS, SSE-C)                   │ │
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>│  │  • Chiffrement en transit (TLS 1.2+)                               │ │
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>│  │  • Politiques de bucket (IAM, S3 ACL)                              │ │
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>│  │  • Versioning et Object Lock                                        │ │
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>│  │  • VPC Endpoints / Private Link                                    │ │
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>│  └───────────────────────────────────────────────────────────────────┘ │
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>│                                    │                                    │
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>│                                    ▼                                    │
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>│  COUCHE 2 : FORMAT DE TABLE (ICEBERG)                                   │
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>│  ┌───────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>│  │  • Chiffrement natif des fichiers Parquet                          │ │
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>│  │  • Isolation des métadonnées par table                             │ │
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>│  │  • Time Travel et audit par snapshots                              │ │
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>│  │  • Chemins de fichiers isolés par namespace                        │ │
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>│  └───────────────────────────────────────────────────────────────────┘ │
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>│                                    │                                    │
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>│                                    ▼                                    │
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>│  COUCHE 3 : CATALOGUE                                                   │
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>│  ┌───────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>│  │  • RBAC (Role-Based Access Control)                                │ │
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>│  │  • Credential Vending (jetons temporaires)                         │ │
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>│  │  • Authentification OAuth2/OIDC                                    │ │
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>│  │  • Audit logging des opérations                                    │ │
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>│  │  • Isolation multi-tenant                                          │ │
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>│  └───────────────────────────────────────────────────────────────────┘ │
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>│                                    │                                    │
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>│                                    ▼                                    │
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>│  COUCHE 4 : MOTEURS DE CALCUL                                           │
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>│  ┌───────────────────────────────────────────────────────────────────┐ │
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>│  │  • FGAC (Fine-Grained Access Control)                              │ │
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>│  │  • Row-Level Security / Column Masking                             │ │
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>│  │  • Query Audit et Logging                                          │ │
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>│  │  • Vues dynamiques sécurisées                                      │ │
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>│  └───────────────────────────────────────────────────────────────────┘ │
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>│                                                                         │
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h3 id="securite-du-stockage-objet">Sécurité du Stockage Objet<a class="headerlink" href="#securite-du-stockage-objet" title="Permanent link">&para;</a></h3>
<p>La première ligne de défense réside dans le stockage objet qui héberge les fichiers de données et de métadonnées Iceberg. Cette couche doit assurer la confidentialité, l'intégrité et la disponibilité des données au repos.</p>
<p><strong>Le chiffrement au repos</strong> constitue la protection fondamentale. AWS S3 offre trois options de chiffrement côté serveur. SSE-S3 utilise des clés gérées par AWS, offrant simplicité et absence de coût supplémentaire. SSE-KMS utilise AWS Key Management Service, permettant le contrôle des clés, l'audit de leur utilisation et la rotation automatique. SSE-C (clés fournies par le client) offre le contrôle maximal mais nécessite une gestion des clés par l'organisation.</p>
<p>Pour les organisations canadiennes soumises à des exigences réglementaires strictes, SSE-KMS avec des clés CMK (Customer Master Key) hébergées dans une région canadienne représente généralement le meilleur compromis entre sécurité et opérabilité.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Configuration Terraform pour un bucket S3 sécurisé hébergeant Iceberg</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="c1"># Région canadienne avec chiffrement KMS et versioning</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="n">resource</span> <span class="s2">&quot;aws_kms_key&quot;</span> <span class="s2">&quot;lakehouse_key&quot;</span> <span class="p">{</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>  <span class="n">description</span>             <span class="o">=</span> <span class="s2">&quot;Clé KMS pour le chiffrement du Lakehouse&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>  <span class="n">deletion_window_in_days</span> <span class="o">=</span> <span class="mi">30</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  <span class="n">enable_key_rotation</span>     <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>  <span class="n">policy</span> <span class="o">=</span> <span class="n">jsonencode</span><span class="p">({</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">Version</span> <span class="o">=</span> <span class="s2">&quot;2012-10-17&quot;</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>    <span class="n">Statement</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>      <span class="p">{</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>        <span class="n">Sid</span>    <span class="o">=</span> <span class="s2">&quot;Enable IAM User Permissions&quot;</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        <span class="n">Effect</span> <span class="o">=</span> <span class="s2">&quot;Allow&quot;</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>        <span class="n">Principal</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>          <span class="n">AWS</span> <span class="o">=</span> <span class="s2">&quot;arn:aws:iam::$</span><span class="si">{data.aws_caller_identity.current.account_id}</span><span class="s2">:root&quot;</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>        <span class="p">}</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>        <span class="n">Action</span>   <span class="o">=</span> <span class="s2">&quot;kms:*&quot;</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>        <span class="n">Resource</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>      <span class="p">},</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>      <span class="p">{</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>        <span class="n">Sid</span>    <span class="o">=</span> <span class="s2">&quot;Allow Lakehouse Services&quot;</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>        <span class="n">Effect</span> <span class="o">=</span> <span class="s2">&quot;Allow&quot;</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>        <span class="n">Principal</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>          <span class="n">Service</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s3.amazonaws.com&quot;</span><span class="p">,</span> <span class="s2">&quot;glue.amazonaws.com&quot;</span><span class="p">]</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>        <span class="p">}</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>        <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>          <span class="s2">&quot;kms:Encrypt&quot;</span><span class="p">,</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>          <span class="s2">&quot;kms:Decrypt&quot;</span><span class="p">,</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>          <span class="s2">&quot;kms:GenerateDataKey*&quot;</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>        <span class="p">]</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>        <span class="n">Resource</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>      <span class="p">}</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>    <span class="p">]</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>  <span class="p">})</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>  <span class="n">tags</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>    <span class="n">Environment</span> <span class="o">=</span> <span class="s2">&quot;production&quot;</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>    <span class="n">DataClass</span>   <span class="o">=</span> <span class="s2">&quot;confidential&quot;</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>    <span class="n">Compliance</span>  <span class="o">=</span> <span class="s2">&quot;loi25-lprpde&quot;</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>  <span class="p">}</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="p">}</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="n">resource</span> <span class="s2">&quot;aws_s3_bucket&quot;</span> <span class="s2">&quot;lakehouse&quot;</span> <span class="p">{</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>  <span class="n">bucket</span> <span class="o">=</span> <span class="s2">&quot;entreprise-lakehouse-ca-central-1&quot;</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>  <span class="n">tags</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>    <span class="n">Environment</span> <span class="o">=</span> <span class="s2">&quot;production&quot;</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>    <span class="n">DataClass</span>   <span class="o">=</span> <span class="s2">&quot;confidential&quot;</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>  <span class="p">}</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="p">}</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="n">resource</span> <span class="s2">&quot;aws_s3_bucket_versioning&quot;</span> <span class="s2">&quot;lakehouse&quot;</span> <span class="p">{</span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a>  <span class="n">bucket</span> <span class="o">=</span> <span class="n">aws_s3_bucket</span><span class="o">.</span><span class="n">lakehouse</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>  <span class="n">versioning_configuration</span> <span class="p">{</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a>    <span class="n">status</span> <span class="o">=</span> <span class="s2">&quot;Enabled&quot;</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a>  <span class="p">}</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="p">}</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="n">resource</span> <span class="s2">&quot;aws_s3_bucket_server_side_encryption_configuration&quot;</span> <span class="s2">&quot;lakehouse&quot;</span> <span class="p">{</span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a>  <span class="n">bucket</span> <span class="o">=</span> <span class="n">aws_s3_bucket</span><span class="o">.</span><span class="n">lakehouse</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a>  <span class="n">rule</span> <span class="p">{</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a>    <span class="n">apply_server_side_encryption_by_default</span> <span class="p">{</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a>      <span class="n">kms_master_key_id</span> <span class="o">=</span> <span class="n">aws_kms_key</span><span class="o">.</span><span class="n">lakehouse_key</span><span class="o">.</span><span class="n">arn</span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a>      <span class="n">sse_algorithm</span>     <span class="o">=</span> <span class="s2">&quot;aws:kms&quot;</span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a>    <span class="p">}</span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a>    <span class="n">bucket_key_enabled</span> <span class="o">=</span> <span class="n">true</span>  <span class="c1"># Réduit les coûts KMS</span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a>  <span class="p">}</span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="p">}</span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="n">resource</span> <span class="s2">&quot;aws_s3_bucket_public_access_block&quot;</span> <span class="s2">&quot;lakehouse&quot;</span> <span class="p">{</span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a>  <span class="n">bucket</span> <span class="o">=</span> <span class="n">aws_s3_bucket</span><span class="o">.</span><span class="n">lakehouse</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a>  <span class="n">block_public_acls</span>       <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a>  <span class="n">block_public_policy</span>     <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a>  <span class="n">ignore_public_acls</span>      <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a>  <span class="n">restrict_public_buckets</span> <span class="o">=</span> <span class="n">true</span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a><span class="p">}</span>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="c1"># Politique de bucket restrictive</span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="n">resource</span> <span class="s2">&quot;aws_s3_bucket_policy&quot;</span> <span class="s2">&quot;lakehouse&quot;</span> <span class="p">{</span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a>  <span class="n">bucket</span> <span class="o">=</span> <span class="n">aws_s3_bucket</span><span class="o">.</span><span class="n">lakehouse</span><span class="o">.</span><span class="n">id</span>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a>
<a id="__codelineno-1-85" name="__codelineno-1-85" href="#__codelineno-1-85"></a>  <span class="n">policy</span> <span class="o">=</span> <span class="n">jsonencode</span><span class="p">({</span>
<a id="__codelineno-1-86" name="__codelineno-1-86" href="#__codelineno-1-86"></a>    <span class="n">Version</span> <span class="o">=</span> <span class="s2">&quot;2012-10-17&quot;</span>
<a id="__codelineno-1-87" name="__codelineno-1-87" href="#__codelineno-1-87"></a>    <span class="n">Statement</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-88" name="__codelineno-1-88" href="#__codelineno-1-88"></a>      <span class="p">{</span>
<a id="__codelineno-1-89" name="__codelineno-1-89" href="#__codelineno-1-89"></a>        <span class="n">Sid</span>       <span class="o">=</span> <span class="s2">&quot;EnforceHTTPS&quot;</span>
<a id="__codelineno-1-90" name="__codelineno-1-90" href="#__codelineno-1-90"></a>        <span class="n">Effect</span>    <span class="o">=</span> <span class="s2">&quot;Deny&quot;</span>
<a id="__codelineno-1-91" name="__codelineno-1-91" href="#__codelineno-1-91"></a>        <span class="n">Principal</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-1-92" name="__codelineno-1-92" href="#__codelineno-1-92"></a>        <span class="n">Action</span>    <span class="o">=</span> <span class="s2">&quot;s3:*&quot;</span>
<a id="__codelineno-1-93" name="__codelineno-1-93" href="#__codelineno-1-93"></a>        <span class="n">Resource</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-94" name="__codelineno-1-94" href="#__codelineno-1-94"></a>          <span class="n">aws_s3_bucket</span><span class="o">.</span><span class="n">lakehouse</span><span class="o">.</span><span class="n">arn</span><span class="p">,</span>
<a id="__codelineno-1-95" name="__codelineno-1-95" href="#__codelineno-1-95"></a>          <span class="s2">&quot;$</span><span class="si">{aws_s3_bucket.lakehouse.arn}</span><span class="s2">/*&quot;</span>
<a id="__codelineno-1-96" name="__codelineno-1-96" href="#__codelineno-1-96"></a>        <span class="p">]</span>
<a id="__codelineno-1-97" name="__codelineno-1-97" href="#__codelineno-1-97"></a>        <span class="n">Condition</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-98" name="__codelineno-1-98" href="#__codelineno-1-98"></a>          <span class="n">Bool</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-99" name="__codelineno-1-99" href="#__codelineno-1-99"></a>            <span class="s2">&quot;aws:SecureTransport&quot;</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span>
<a id="__codelineno-1-100" name="__codelineno-1-100" href="#__codelineno-1-100"></a>          <span class="p">}</span>
<a id="__codelineno-1-101" name="__codelineno-1-101" href="#__codelineno-1-101"></a>        <span class="p">}</span>
<a id="__codelineno-1-102" name="__codelineno-1-102" href="#__codelineno-1-102"></a>      <span class="p">},</span>
<a id="__codelineno-1-103" name="__codelineno-1-103" href="#__codelineno-1-103"></a>      <span class="p">{</span>
<a id="__codelineno-1-104" name="__codelineno-1-104" href="#__codelineno-1-104"></a>        <span class="n">Sid</span>       <span class="o">=</span> <span class="s2">&quot;RestrictToVPCEndpoint&quot;</span>
<a id="__codelineno-1-105" name="__codelineno-1-105" href="#__codelineno-1-105"></a>        <span class="n">Effect</span>    <span class="o">=</span> <span class="s2">&quot;Deny&quot;</span>
<a id="__codelineno-1-106" name="__codelineno-1-106" href="#__codelineno-1-106"></a>        <span class="n">Principal</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-1-107" name="__codelineno-1-107" href="#__codelineno-1-107"></a>        <span class="n">Action</span>    <span class="o">=</span> <span class="s2">&quot;s3:*&quot;</span>
<a id="__codelineno-1-108" name="__codelineno-1-108" href="#__codelineno-1-108"></a>        <span class="n">Resource</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-1-109" name="__codelineno-1-109" href="#__codelineno-1-109"></a>          <span class="n">aws_s3_bucket</span><span class="o">.</span><span class="n">lakehouse</span><span class="o">.</span><span class="n">arn</span><span class="p">,</span>
<a id="__codelineno-1-110" name="__codelineno-1-110" href="#__codelineno-1-110"></a>          <span class="s2">&quot;$</span><span class="si">{aws_s3_bucket.lakehouse.arn}</span><span class="s2">/*&quot;</span>
<a id="__codelineno-1-111" name="__codelineno-1-111" href="#__codelineno-1-111"></a>        <span class="p">]</span>
<a id="__codelineno-1-112" name="__codelineno-1-112" href="#__codelineno-1-112"></a>        <span class="n">Condition</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-113" name="__codelineno-1-113" href="#__codelineno-1-113"></a>          <span class="n">StringNotEquals</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-114" name="__codelineno-1-114" href="#__codelineno-1-114"></a>            <span class="s2">&quot;aws:SourceVpce&quot;</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">vpc_endpoint_id</span>
<a id="__codelineno-1-115" name="__codelineno-1-115" href="#__codelineno-1-115"></a>          <span class="p">}</span>
<a id="__codelineno-1-116" name="__codelineno-1-116" href="#__codelineno-1-116"></a>        <span class="p">}</span>
<a id="__codelineno-1-117" name="__codelineno-1-117" href="#__codelineno-1-117"></a>      <span class="p">}</span>
<a id="__codelineno-1-118" name="__codelineno-1-118" href="#__codelineno-1-118"></a>    <span class="p">]</span>
<a id="__codelineno-1-119" name="__codelineno-1-119" href="#__codelineno-1-119"></a>  <span class="p">})</span>
<a id="__codelineno-1-120" name="__codelineno-1-120" href="#__codelineno-1-120"></a><span class="p">}</span>
</code></pre></div>
<p><strong>L'isolation réseau</strong> via VPC Endpoints (AWS) ou Private Link (Azure, GCP) garantit que le trafic vers le stockage ne transite jamais par l'internet public. Cette configuration est particulièrement importante pour les données sensibles et constitue souvent une exigence explicite des politiques de sécurité d'entreprise.</p>
<h3 id="le-chiffrement-natif-iceberg">Le Chiffrement Natif Iceberg<a class="headerlink" href="#le-chiffrement-natif-iceberg" title="Permanent link">&para;</a></h3>
<p>Au-delà du chiffrement au niveau du stockage, Apache Iceberg supporte le chiffrement natif des fichiers Parquet. Ce mécanisme permet un contrôle plus granulaire, où différentes colonnes peuvent être chiffrées avec différentes clés.</p>
<p>Le chiffrement Iceberg utilise une architecture à deux niveaux de clés. Les clés de chiffrement de données (DEK - Data Encryption Keys) chiffrent les données elles-mêmes. Ces DEK sont ensuite chiffrées par des clés maîtresses (KEK - Key Encryption Keys) stockées dans un système de gestion de clés externe comme AWS KMS ou HashiCorp Vault.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">// Configuration du chiffrement Iceberg avec Spark</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">SparkConf</span><span class="w"> </span><span class="n">conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SparkConf</span><span class="p">()</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">    </span><span class="p">.</span><span class="na">setAppName</span><span class="p">(</span><span class="s">&quot;Lakehouse-Encrypted&quot;</span><span class="p">)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="c1">// Configuration du gestionnaire de clés</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;spark.sql.catalog.lakehouse.io-impl&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">         </span><span class="s">&quot;org.apache.iceberg.aws.s3.S3FileIO&quot;</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">    </span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;spark.sql.catalog.lakehouse.encryption.manager&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">         </span><span class="s">&quot;org.apache.iceberg.encryption.StandardEncryptionManager&quot;</span><span class="p">)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">    </span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;spark.sql.catalog.lakehouse.encryption.kms&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">         </span><span class="s">&quot;org.apache.iceberg.aws.kms.AwsKmsClient&quot;</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">    </span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="s">&quot;spark.sql.catalog.lakehouse.encryption.kms.key-id&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">         </span><span class="s">&quot;arn:aws:kms:ca-central-1:123456789:key/abcd-1234&quot;</span><span class="p">);</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="c1">// Création d&#39;une table avec chiffrement par colonne</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="n">spark</span><span class="p">.</span><span class="na">sql</span><span class="p">(</span><span class="s">&quot;&quot;&quot;</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="s">    CREATE TABLE lakehouse.clients.donnees_personnelles (</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="s">        client_id STRING,</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="s">        nom STRING,</span>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="s">        prenom STRING,</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="s">        nas STRING,           -- Numéro d&#39;assurance sociale (chiffré)</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="s">        date_naissance DATE,  -- (chiffré)</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="s">        courriel STRING,</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="s">        telephone STRING</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="s">    )</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="s">    USING iceberg</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="s">    TBLPROPERTIES (</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="s">        &#39;encryption.column.nas&#39; = &#39;key1&#39;,</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="s">        &#39;encryption.column.date_naissance&#39; = &#39;key1&#39;,</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="s">        &#39;encryption.key.key1&#39; = &#39;arn:aws:kms:ca-central-1:123456789:key/nas-key&#39;</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="s">    )</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="s">&quot;&quot;&quot;</span><span class="p">);</span>
</code></pre></div>
<p>Cette approche offre plusieurs avantages pour la conformité réglementaire. Les colonnes contenant des données sensibles (numéro d'assurance sociale, informations médicales, données financières) peuvent être protégées indépendamment. L'accès aux clés de déchiffrement peut être contrôlé séparément de l'accès aux tables, permettant une séparation des responsabilités.</p>
<h3 id="securite-au-niveau-du-catalogue">Sécurité au Niveau du Catalogue<a class="headerlink" href="#securite-au-niveau-du-catalogue" title="Permanent link">&para;</a></h3>
<p>Le catalogue représente le point de contrôle centralisé pour la gouvernance du Lakehouse. Les catalogues modernes comme Apache Polaris, Unity Catalog ou Nessie offrent des capacités de sécurité avancées qui vont bien au-delà du simple stockage de métadonnées.</p>
<p><strong>Apache Polaris</strong>, en incubation à la fondation Apache, émerge comme le standard de facto pour les catalogues Iceberg. Lancé en 2024 par Snowflake et donné à la communauté open source, Polaris implémente intégralement l'API REST Iceberg et ajoute des capacités de gouvernance essentielles.</p>
<p>Le modèle RBAC de Polaris distingue deux types de rôles. Les <strong>Principal Roles</strong> sont attribués aux utilisateurs ou aux applications (service principals) et définissent leur identité dans le système. Les <strong>Catalog Roles</strong> définissent les permissions sur les objets (catalogues, namespaces, tables, vues) et sont attribués aux Principal Roles.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Configuration d&#39;Apache Polaris avec RBAC</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="c1"># Création des rôles et attribution des permissions</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">PolarisAdminClient</span><span class="p">:</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">admin_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>            <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">admin_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>            <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        <span class="p">}</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_catalog_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">role_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>                            <span class="n">privileges</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Crée un rôle de catalogue avec des privilèges spécifiques.&quot;&quot;&quot;</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">role_name</span><span class="p">,</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{}</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>        <span class="p">}</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v1/catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/catalog-roles&quot;</span><span class="p">,</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>            <span class="n">json</span><span class="o">=</span><span class="n">payload</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>        <span class="p">)</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>        <span class="c1"># Attribution des privilèges au rôle</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>        <span class="k">for</span> <span class="n">privilege</span> <span class="ow">in</span> <span class="n">privileges</span><span class="p">:</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_grant_privilege</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">role_name</span><span class="p">,</span> <span class="n">privilege</span><span class="p">)</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_grant_privilege</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">role_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>                         <span class="n">privilege</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Attribue un privilège à un rôle de catalogue.&quot;&quot;&quot;</span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v1/catalogs/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/catalog-roles/&quot;</span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">role_name</span><span class="si">}</span><span class="s2">/grants&quot;</span><span class="p">,</span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>            <span class="n">json</span><span class="o">=</span><span class="n">privilege</span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a>        <span class="p">)</span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_principal_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Crée un rôle principal.&quot;&quot;&quot;</span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">role_name</span><span class="p">,</span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a>            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{}</span>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a>        <span class="p">}</span>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v1/principal-roles&quot;</span><span class="p">,</span>
<a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a>            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
<a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>            <span class="n">json</span><span class="o">=</span><span class="n">payload</span>
<a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>        <span class="p">)</span>
<a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a>        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a>
<a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">assign_catalog_role_to_principal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">principal_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a>                                         <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
<a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a>                                         <span class="n">catalog_role</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Attribue un rôle de catalogue à un rôle principal.&quot;&quot;&quot;</span>
<a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/api/v1/principal-roles/</span><span class="si">{</span><span class="n">principal_role</span><span class="si">}</span><span class="s2">/&quot;</span>
<a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a>            <span class="sa">f</span><span class="s2">&quot;catalog-roles/</span><span class="si">{</span><span class="n">catalog</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">catalog_role</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a>            <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span>
<a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a>        <span class="p">)</span>
<a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
<a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a>
<a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a>
<a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="c1"># Exemple d&#39;utilisation : Configuration RBAC pour une équipe analytique</span>
<a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="n">admin</span> <span class="o">=</span> <span class="n">PolarisAdminClient</span><span class="p">(</span>
<a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a>    <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://polaris.entreprise.ca&quot;</span><span class="p">,</span>
<a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a>    <span class="n">admin_token</span><span class="o">=</span><span class="s2">&quot;admin_token_secret&quot;</span>
<a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a><span class="p">)</span>
<a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a>
<a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a><span class="c1"># Créer les rôles de catalogue avec différents niveaux d&#39;accès</span>
<a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a><span class="n">admin</span><span class="o">.</span><span class="n">create_catalog_role</span><span class="p">(</span>
<a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a>    <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span>
<a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a>    <span class="n">role_name</span><span class="o">=</span><span class="s2">&quot;analyst_readonly&quot;</span><span class="p">,</span>
<a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a>    <span class="n">privileges</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a>        <span class="p">{</span>
<a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TABLE_READ&quot;</span><span class="p">,</span>
<a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a>            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;ventes&quot;</span><span class="p">,</span>
<a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a>            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a>        <span class="p">},</span>
<a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a>        <span class="p">{</span>
<a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TABLE_READ&quot;</span><span class="p">,</span> 
<a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a>            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;marketing&quot;</span><span class="p">,</span>
<a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a>            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a>        <span class="p">}</span>
<a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a>    <span class="p">]</span>
<a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a><span class="p">)</span>
<a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a>
<a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a><span class="n">admin</span><span class="o">.</span><span class="n">create_catalog_role</span><span class="p">(</span>
<a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a>    <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span>
<a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a>    <span class="n">role_name</span><span class="o">=</span><span class="s2">&quot;data_engineer&quot;</span><span class="p">,</span>
<a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a>    <span class="n">privileges</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a>        <span class="p">{</span>
<a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TABLE_FULL&quot;</span><span class="p">,</span>
<a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a>            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
<a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a>            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a>        <span class="p">},</span>
<a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a>        <span class="p">{</span>
<a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;NAMESPACE_CREATE&quot;</span><span class="p">,</span>
<a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a>            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
<a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a>        <span class="p">}</span>
<a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a>    <span class="p">]</span>
<a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a><span class="p">)</span>
<a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a>
<a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a><span class="c1"># Restreindre l&#39;accès aux données sensibles</span>
<a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a><span class="n">admin</span><span class="o">.</span><span class="n">create_catalog_role</span><span class="p">(</span>
<a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a>    <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span> 
<a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a>    <span class="n">role_name</span><span class="o">=</span><span class="s2">&quot;pii_access&quot;</span><span class="p">,</span>
<a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a>    <span class="n">privileges</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a>        <span class="p">{</span>
<a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TABLE_READ&quot;</span><span class="p">,</span>
<a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a>            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;clients&quot;</span><span class="p">,</span>
<a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a>            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;donnees_personnelles&quot;</span>
<a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a>        <span class="p">}</span>
<a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a>    <span class="p">]</span>
<a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a><span class="p">)</span>
<a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a>
<a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a><span class="c1"># Créer les rôles principaux et les attributions</span>
<a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a><span class="n">admin</span><span class="o">.</span><span class="n">create_principal_role</span><span class="p">(</span><span class="s2">&quot;equipe_analytique&quot;</span><span class="p">)</span>
<a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a><span class="n">admin</span><span class="o">.</span><span class="n">create_principal_role</span><span class="p">(</span><span class="s2">&quot;equipe_ingenierie&quot;</span><span class="p">)</span>
<a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a><span class="n">admin</span><span class="o">.</span><span class="n">create_principal_role</span><span class="p">(</span><span class="s2">&quot;equipe_conformite&quot;</span><span class="p">)</span>
<a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a>
<a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a><span class="c1"># Attribuer les rôles de catalogue aux rôles principaux</span>
<a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a><span class="n">admin</span><span class="o">.</span><span class="n">assign_catalog_role_to_principal</span><span class="p">(</span>
<a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a>    <span class="n">principal_role</span><span class="o">=</span><span class="s2">&quot;equipe_analytique&quot;</span><span class="p">,</span>
<a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a>    <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span>
<a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a>    <span class="n">catalog_role</span><span class="o">=</span><span class="s2">&quot;analyst_readonly&quot;</span>
<a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a><span class="p">)</span>
<a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a>
<a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a><span class="n">admin</span><span class="o">.</span><span class="n">assign_catalog_role_to_principal</span><span class="p">(</span>
<a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a>    <span class="n">principal_role</span><span class="o">=</span><span class="s2">&quot;equipe_conformite&quot;</span><span class="p">,</span>
<a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a>    <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;production&quot;</span><span class="p">,</span> 
<a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a>    <span class="n">catalog_role</span><span class="o">=</span><span class="s2">&quot;pii_access&quot;</span>
<a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="p">)</span>
</code></pre></div>
<p><strong>Le Credential Vending</strong> représente une innovation majeure des catalogues modernes. Plutôt que de configurer des identifiants statiques (access keys) sur chaque moteur de calcul, le catalogue émet des jetons temporaires (STS tokens) à la demande. Ces jetons ont une durée de vie limitée (typiquement 1 heure) et sont scopés aux tables spécifiques que l'utilisateur est autorisé à accéder.</p>
<p>Ce mécanisme offre plusieurs avantages de sécurité. Il élimine la nécessité de distribuer et gérer des identifiants permanents. En cas de compromission, les jetons expirent automatiquement. L'audit devient plus précis car chaque accès est associé à un jeton spécifique. Les politiques d'accès sont appliquées de manière cohérente quel que soit le moteur de calcul utilisé.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>┌─────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>│                      FLUX DE CREDENTIAL VENDING                         │
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>├─────────────────────────────────────────────────────────────────────────┤
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>│                                                                         │
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>│  ┌──────────┐     1. Authentification      ┌────────────────────┐      │
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>│  │  Client  │ ─────────────────────────────▶│  Identity Provider │      │
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>│  │  (Spark) │                               │  (Okta, Azure AD)  │      │
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>│  └────┬─────┘                               └─────────┬──────────┘      │
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>│       │                                               │                 │
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>│       │ 2. Requête table                              │ 1b. Token JWT   │
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>│       │    + JWT token                                ▼                 │
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>│       │                                     ┌────────────────────┐      │
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>│       └────────────────────────────────────▶│   Apache Polaris   │      │
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>│                                             │     Catalog        │      │
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>│                                             └─────────┬──────────┘      │
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>│                                                       │                 │
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>│       ┌───────────────────────────────────────────────┘                 │
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>│       │                                                                 │
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>│       │ 3. Vérification permissions RBAC                                │
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>│       │ 4. Génération STS credentials (scopés à la table)               │
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>│       │ 5. Retour métadonnées + credentials temporaires                 │
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>│       ▼                                                                 │
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>│  ┌──────────┐                               ┌────────────────────┐      │
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>│  │  Client  │     6. Accès direct S3        │   AWS S3           │      │
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>│  │  (Spark) │ ─────────────────────────────▶│   (avec STS)       │      │
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>│  └──────────┘     avec credentials temp.    └────────────────────┘      │
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>│                                                                         │
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>│  Avantages :                                                            │
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>│  • Pas de credentials permanents côté client                            │
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>│  • Jetons temporaires (1h par défaut)                                   │
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>│  • Scope limité aux tables autorisées                                   │
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>│  • Audit précis de chaque accès                                         │
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>│                                                                         │
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h3 id="project-nessie-git-pour-les-donnees">Project Nessie : Git pour les Données<a class="headerlink" href="#project-nessie-git-pour-les-donnees" title="Permanent link">&para;</a></h3>
<p><strong>Project Nessie</strong> offre une approche alternative à la gouvernance du catalogue, inspirée des concepts de contrôle de version Git. Développé par Dremio et donné à la communauté open source, Nessie permet de gérer les tables Iceberg avec des branches, des tags et des commits atomiques multi-tables.</p>
<p>Cette approche apporte des avantages uniques pour la gouvernance. Les <strong>branches</strong> permettent d'isoler les environnements (développement, test, production) tout en partageant le même stockage physique. Les <strong>tags</strong> marquent des états stables (version auditée, point de conformité). Les <strong>commits atomiques</strong> garantissent la cohérence lors des modifications multi-tables.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Configuration de Nessie avec contrôles d&#39;accès basés sur les branches</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pynessie</span><span class="w"> </span><span class="kn">import</span> <span class="n">init</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pynessie.auth</span><span class="w"> </span><span class="kn">import</span> <span class="n">NessieAuthConfig</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1"># Connexion au serveur Nessie avec authentification</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">nessie</span> <span class="o">=</span> <span class="n">init</span><span class="p">(</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="s2">&quot;http://nessie.entreprise.ca:19120/api/v1&quot;</span><span class="p">,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>    <span class="n">auth</span><span class="o">=</span><span class="n">NessieAuthConfig</span><span class="p">(</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bearer&quot;</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        <span class="n">token</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">{NESSIE_AUTH_TOKEN}</span><span class="s2">&quot;</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="p">)</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="p">)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c1"># Créer une branche pour l&#39;équipe analytique</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="c1"># Cette branche est en lecture seule pour la production</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="n">branch_analytique</span> <span class="o">=</span> <span class="n">nessie</span><span class="o">.</span><span class="n">create_branch</span><span class="p">(</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;analytique-q1-2025&quot;</span><span class="p">,</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="n">ref</span><span class="o">=</span><span class="s2">&quot;main&quot;</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="p">)</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="c1"># Créer une branche pour les développements</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="n">branch_dev</span> <span class="o">=</span> <span class="n">nessie</span><span class="o">.</span><span class="n">create_branch</span><span class="p">(</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dev-feature-xyz&quot;</span><span class="p">,</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>    <span class="n">ref</span><span class="o">=</span><span class="s2">&quot;main&quot;</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="p">)</span>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="c1"># Les permissions Nessie contrôlent :</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="c1"># - Qui peut lire chaque branche</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="c1"># - Qui peut committer sur chaque branche</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="c1"># - Qui peut créer/supprimer des branches</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="c1"># Configuration des règles d&#39;accès (via fichier de configuration)</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="n">nessie_access_rules</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a><span class="s2">authorization:</span>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="s2">  rules:</span>
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="s2">    # Production : lecture seule sauf pour les data engineers</span>
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a><span class="s2">    - pattern: &quot;main&quot;</span>
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a><span class="s2">      actions:</span>
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="s2">        - allow: READ</span>
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a><span class="s2">          principals: [&quot;group:analystes&quot;, &quot;group:data_engineers&quot;]</span>
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a><span class="s2">        - allow: COMMIT</span>
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="s2">          principals: [&quot;group:data_engineers&quot;]</span>
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a><span class="s2">        - allow: CREATE_REFERENCE</span>
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a><span class="s2">          principals: [&quot;group:data_engineers&quot;]</span>
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="s2">    # Branches analytiques : lecture seule</span>
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="s2">    - pattern: &quot;analytique-*&quot;</span>
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a><span class="s2">      actions:</span>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="s2">        - allow: READ</span>
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a><span class="s2">          principals: [&quot;group:analystes&quot;]</span>
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a><span class="s2">        - allow: COMMIT</span>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a><span class="s2">          principals: []  # Personne ne peut modifier</span>
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a><span class="s2">    # Branches de développement : accès complet pour les devs</span>
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a><span class="s2">    - pattern: &quot;dev-*&quot;</span>
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a><span class="s2">      actions:</span>
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a><span class="s2">        - allow: READ</span>
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a><span class="s2">          principals: [&quot;group:developpeurs&quot;, &quot;group:data_engineers&quot;]</span>
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a><span class="s2">        - allow: COMMIT</span>
<a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a><span class="s2">          principals: [&quot;group:developpeurs&quot;, &quot;group:data_engineers&quot;]</span>
<a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a><span class="s2">        - allow: DELETE_REFERENCE</span>
<a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a><span class="s2">          principals: [&quot;group:data_engineers&quot;]</span>
<a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a><span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>
<p>La gouvernance basée sur les branches offre un contrôle temporel unique. Un auditeur peut examiner l'état exact des données à un moment donné en créant un tag, sans risque que ces données soient modifiées. Les analystes peuvent travailler sur une branche stable pendant que les ingénieurs préparent des modifications sur une autre branche.</p>
<h3 id="gestion-des-cles-et-rotation">Gestion des Clés et Rotation<a class="headerlink" href="#gestion-des-cles-et-rotation" title="Permanent link">&para;</a></h3>
<p>La gestion du cycle de vie des clés de chiffrement constitue un aspect critique souvent négligé. Une stratégie robuste doit couvrir la création, la distribution, la rotation et la révocation des clés.</p>
<p><strong>La rotation automatique des clés</strong> limite l'impact d'une compromission potentielle. AWS KMS permet de configurer une rotation annuelle automatique des CMK. Cependant, cette rotation ne re-chiffre pas automatiquement les données existantes; les anciennes versions des clés sont conservées pour déchiffrer les données historiques.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Stratégie de rotation des clés pour le Lakehouse</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">GestionnaireClésLakehouse</span><span class="p">:</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="sd">    Gère le cycle de vie des clés KMS pour le Lakehouse.</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="sd">    Stratégie recommandée :</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="sd">    - Rotation automatique annuelle via KMS</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="sd">    - Re-chiffrement périodique des données sensibles</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="sd">    - Séparation des clés par classification de données</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ca-central-1&#39;</span><span class="p">):</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kms</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">creer_cle_pour_classification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>                                       <span class="n">classification</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>                                       <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="sd">        Crée une clé KMS dédiée à une classification de données.</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="sd">        Classifications suggérées :</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="sd">        - RESTREINT : Données hautement sensibles (NAS, financières)</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="sd">        - CONFIDENTIEL : Données personnelles (PII)</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="sd">        - INTERNE : Données métier non publiques</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="sd">        - PUBLIC : Données sans restriction</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">create_key</span><span class="p">(</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>            <span class="n">Description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Lakehouse - </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>            <span class="n">KeyUsage</span><span class="o">=</span><span class="s1">&#39;ENCRYPT_DECRYPT&#39;</span><span class="p">,</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>            <span class="n">KeySpec</span><span class="o">=</span><span class="s1">&#39;SYMMETRIC_DEFAULT&#39;</span><span class="p">,</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>            <span class="n">Origin</span><span class="o">=</span><span class="s1">&#39;AWS_KMS&#39;</span><span class="p">,</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>            <span class="n">Tags</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>                <span class="p">{</span><span class="s1">&#39;TagKey&#39;</span><span class="p">:</span> <span class="s1">&#39;Environment&#39;</span><span class="p">,</span> <span class="s1">&#39;TagValue&#39;</span><span class="p">:</span> <span class="s1">&#39;production&#39;</span><span class="p">},</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>                <span class="p">{</span><span class="s1">&#39;TagKey&#39;</span><span class="p">:</span> <span class="s1">&#39;Classification&#39;</span><span class="p">,</span> <span class="s1">&#39;TagValue&#39;</span><span class="p">:</span> <span class="n">classification</span><span class="p">},</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>                <span class="p">{</span><span class="s1">&#39;TagKey&#39;</span><span class="p">:</span> <span class="s1">&#39;Application&#39;</span><span class="p">,</span> <span class="s1">&#39;TagValue&#39;</span><span class="p">:</span> <span class="s1">&#39;lakehouse&#39;</span><span class="p">},</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>                <span class="p">{</span><span class="s1">&#39;TagKey&#39;</span><span class="p">:</span> <span class="s1">&#39;ManagedBy&#39;</span><span class="p">,</span> <span class="s1">&#39;TagValue&#39;</span><span class="p">:</span> <span class="s1">&#39;data-platform-team&#39;</span><span class="p">}</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>            <span class="p">]</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>        <span class="p">)</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>        <span class="n">key_id</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;KeyMetadata&#39;</span><span class="p">][</span><span class="s1">&#39;KeyId&#39;</span><span class="p">]</span>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>        <span class="c1"># Activer la rotation automatique</span>
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">enable_key_rotation</span><span class="p">(</span><span class="n">KeyId</span><span class="o">=</span><span class="n">key_id</span><span class="p">)</span>
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>
<a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>        <span class="c1"># Créer un alias pour faciliter l&#39;utilisation</span>
<a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>        <span class="n">alias</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;alias/lakehouse-</span><span class="si">{</span><span class="n">classification</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">create_alias</span><span class="p">(</span>
<a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>            <span class="n">AliasName</span><span class="o">=</span><span class="n">alias</span><span class="p">,</span>
<a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>            <span class="n">TargetKeyId</span><span class="o">=</span><span class="n">key_id</span>
<a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>        <span class="p">)</span>
<a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>
<a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>        <span class="k">return</span> <span class="n">key_id</span>
<a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>
<a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">planifier_rechiffrement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
<a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>                                <span class="n">table_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>                                <span class="n">spark_session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a><span class="sd">        Planifie le re-chiffrement d&#39;une table Iceberg.</span>
<a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a>
<a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a><span class="sd">        Le re-chiffrement est nécessaire pour :</span>
<a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a><span class="sd">        - Révoquer l&#39;accès aux anciennes versions de clés</span>
<a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a><span class="sd">        - Migrer vers des algorithmes plus forts</span>
<a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a><span class="sd">        - Conformité aux politiques de rotation</span>
<a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>        <span class="c1"># Réécrire les fichiers de données avec la nouvelle version de clé</span>
<a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a>        <span class="n">spark_session</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a><span class="s2">            CALL system.rewrite_data_files(</span>
<a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a><span class="s2">                table =&gt; &#39;</span><span class="si">{</span><span class="n">table_path</span><span class="si">}</span><span class="s2">&#39;,</span>
<a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a><span class="s2">                options =&gt; map(</span>
<a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a><span class="s2">                    &#39;rewrite-all&#39;, &#39;true&#39;,</span>
<a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a><span class="s2">                    &#39;target-file-size-bytes&#39;, &#39;268435456&#39;</span>
<a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a><span class="s2">                )</span>
<a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a><span class="s2">            )</span>
<a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a>
<a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a>        <span class="c1"># Expirer les anciens snapshots (chiffrés avec l&#39;ancienne clé)</span>
<a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a>        <span class="n">spark_session</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a><span class="s2">            CALL system.expire_snapshots(</span>
<a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a><span class="s2">                table =&gt; &#39;</span><span class="si">{</span><span class="n">table_path</span><span class="si">}</span><span class="s2">&#39;,</span>
<a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a><span class="s2">                older_than =&gt; TIMESTAMP &#39;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;,</span>
<a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a><span class="s2">                retain_last =&gt; 1</span>
<a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a><span class="s2">            )</span>
<a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a>
<a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a>        <span class="c1"># Nettoyer les fichiers orphelins</span>
<a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a>        <span class="n">spark_session</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a><span class="s2">            CALL system.remove_orphan_files(</span>
<a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a><span class="s2">                table =&gt; &#39;</span><span class="si">{</span><span class="n">table_path</span><span class="si">}</span><span class="s2">&#39;</span>
<a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a><span class="s2">            )</span>
<a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a><span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a>
<a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">auditer_utilisation_cles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a><span class="sd">        Audite l&#39;utilisation des clés KMS pour identifier :</span>
<a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a><span class="sd">        - Clés non utilisées (candidates à la suppression)</span>
<a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a><span class="sd">        - Clés sur-utilisées (risque de performance)</span>
<a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a><span class="sd">        - Patterns d&#39;accès anormaux</span>
<a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a>        <span class="c1"># Récupérer toutes les clés du Lakehouse</span>
<a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a>        <span class="n">paginator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">get_paginator</span><span class="p">(</span><span class="s1">&#39;list_keys&#39;</span><span class="p">)</span>
<a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a>
<a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a>        <span class="n">rapport</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a>            <span class="s1">&#39;cles_actives&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-6-108" name="__codelineno-6-108" href="#__codelineno-6-108"></a>            <span class="s1">&#39;cles_desactivees&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-6-109" name="__codelineno-6-109" href="#__codelineno-6-109"></a>            <span class="s1">&#39;cles_sans_rotation&#39;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-6-110" name="__codelineno-6-110" href="#__codelineno-6-110"></a>            <span class="s1">&#39;alertes&#39;</span><span class="p">:</span> <span class="p">[]</span>
<a id="__codelineno-6-111" name="__codelineno-6-111" href="#__codelineno-6-111"></a>        <span class="p">}</span>
<a id="__codelineno-6-112" name="__codelineno-6-112" href="#__codelineno-6-112"></a>
<a id="__codelineno-6-113" name="__codelineno-6-113" href="#__codelineno-6-113"></a>        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">paginator</span><span class="o">.</span><span class="n">paginate</span><span class="p">():</span>
<a id="__codelineno-6-114" name="__codelineno-6-114" href="#__codelineno-6-114"></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">page</span><span class="p">[</span><span class="s1">&#39;Keys&#39;</span><span class="p">]:</span>
<a id="__codelineno-6-115" name="__codelineno-6-115" href="#__codelineno-6-115"></a>                <span class="n">key_id</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="s1">&#39;KeyId&#39;</span><span class="p">]</span>
<a id="__codelineno-6-116" name="__codelineno-6-116" href="#__codelineno-6-116"></a>
<a id="__codelineno-6-117" name="__codelineno-6-117" href="#__codelineno-6-117"></a>                <span class="c1"># Récupérer les métadonnées</span>
<a id="__codelineno-6-118" name="__codelineno-6-118" href="#__codelineno-6-118"></a>                <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">describe_key</span><span class="p">(</span><span class="n">KeyId</span><span class="o">=</span><span class="n">key_id</span><span class="p">)[</span><span class="s1">&#39;KeyMetadata&#39;</span><span class="p">]</span>
<a id="__codelineno-6-119" name="__codelineno-6-119" href="#__codelineno-6-119"></a>
<a id="__codelineno-6-120" name="__codelineno-6-120" href="#__codelineno-6-120"></a>                <span class="c1"># Vérifier si c&#39;est une clé Lakehouse</span>
<a id="__codelineno-6-121" name="__codelineno-6-121" href="#__codelineno-6-121"></a>                <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">list_resource_tags</span><span class="p">(</span><span class="n">KeyId</span><span class="o">=</span><span class="n">key_id</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Tags&#39;</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-6-122" name="__codelineno-6-122" href="#__codelineno-6-122"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;TagKey&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Application&#39;</span> <span class="ow">and</span> 
<a id="__codelineno-6-123" name="__codelineno-6-123" href="#__codelineno-6-123"></a>                          <span class="n">t</span><span class="p">[</span><span class="s1">&#39;TagValue&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lakehouse&#39;</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">):</span>
<a id="__codelineno-6-124" name="__codelineno-6-124" href="#__codelineno-6-124"></a>                    <span class="k">continue</span>
<a id="__codelineno-6-125" name="__codelineno-6-125" href="#__codelineno-6-125"></a>
<a id="__codelineno-6-126" name="__codelineno-6-126" href="#__codelineno-6-126"></a>                <span class="c1"># Vérifier l&#39;état</span>
<a id="__codelineno-6-127" name="__codelineno-6-127" href="#__codelineno-6-127"></a>                <span class="k">if</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;KeyState&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Enabled&#39;</span><span class="p">:</span>
<a id="__codelineno-6-128" name="__codelineno-6-128" href="#__codelineno-6-128"></a>                    <span class="n">rapport</span><span class="p">[</span><span class="s1">&#39;cles_actives&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_id</span><span class="p">)</span>
<a id="__codelineno-6-129" name="__codelineno-6-129" href="#__codelineno-6-129"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-130" name="__codelineno-6-130" href="#__codelineno-6-130"></a>                    <span class="n">rapport</span><span class="p">[</span><span class="s1">&#39;cles_desactivees&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_id</span><span class="p">)</span>
<a id="__codelineno-6-131" name="__codelineno-6-131" href="#__codelineno-6-131"></a>
<a id="__codelineno-6-132" name="__codelineno-6-132" href="#__codelineno-6-132"></a>                <span class="c1"># Vérifier la rotation</span>
<a id="__codelineno-6-133" name="__codelineno-6-133" href="#__codelineno-6-133"></a>                <span class="n">rotation_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kms</span><span class="o">.</span><span class="n">get_key_rotation_status</span><span class="p">(</span><span class="n">KeyId</span><span class="o">=</span><span class="n">key_id</span><span class="p">)</span>
<a id="__codelineno-6-134" name="__codelineno-6-134" href="#__codelineno-6-134"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">rotation_status</span><span class="p">[</span><span class="s1">&#39;KeyRotationEnabled&#39;</span><span class="p">]:</span>
<a id="__codelineno-6-135" name="__codelineno-6-135" href="#__codelineno-6-135"></a>                    <span class="n">rapport</span><span class="p">[</span><span class="s1">&#39;cles_sans_rotation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key_id</span><span class="p">)</span>
<a id="__codelineno-6-136" name="__codelineno-6-136" href="#__codelineno-6-136"></a>                    <span class="n">rapport</span><span class="p">[</span><span class="s1">&#39;alertes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-6-137" name="__codelineno-6-137" href="#__codelineno-6-137"></a>                        <span class="sa">f</span><span class="s2">&quot;ALERTE: Clé </span><span class="si">{</span><span class="n">key_id</span><span class="si">}</span><span class="s2"> n&#39;a pas la rotation activée&quot;</span>
<a id="__codelineno-6-138" name="__codelineno-6-138" href="#__codelineno-6-138"></a>                    <span class="p">)</span>
<a id="__codelineno-6-139" name="__codelineno-6-139" href="#__codelineno-6-139"></a>
<a id="__codelineno-6-140" name="__codelineno-6-140" href="#__codelineno-6-140"></a>        <span class="k">return</span> <span class="n">rapport</span>
</code></pre></div>
<p><strong>La séparation des clés par classification</strong> limite l'impact d'une compromission. Une clé compromise pour les données « INTERNE » ne permet pas d'accéder aux données « RESTREINT ». Cette approche complexifie la gestion mais renforce significativement la posture de sécurité.</p>
<hr />
<h2 id="iv132-controles-dacces-granulaires">IV.13.2 Contrôles d'Accès Granulaires<a class="headerlink" href="#iv132-controles-dacces-granulaires" title="Permanent link">&para;</a></h2>
<h3 id="les-niveaux-de-controle-dacces">Les Niveaux de Contrôle d'Accès<a class="headerlink" href="#les-niveaux-de-controle-dacces" title="Permanent link">&para;</a></h3>
<p>La sécurité d'un Lakehouse mature repose sur plusieurs niveaux de contrôle d'accès complémentaires. Chaque niveau adresse des besoins différents et offre des compromis distincts entre granularité, performance et complexité de gestion.</p>
<p><strong>Le Role-Based Access Control (RBAC)</strong> constitue le niveau fondamental. Il contrôle l'accès aux objets (catalogues, namespaces, tables, vues) en fonction des rôles attribués aux utilisateurs. RBAC répond à la question : « Cet utilisateur peut-il accéder à cette table ? ». Ce niveau est typiquement implémenté au niveau du catalogue et s'applique de manière cohérente à tous les moteurs de calcul.</p>
<p><strong>Le Fine-Grained Access Control (FGAC)</strong> affine le contrôle au niveau des lignes et des colonnes. Il répond à des questions plus précises : « Cet utilisateur peut-il voir les lignes correspondant à sa région ? » ou « Cette colonne doit-elle être masquée pour cet utilisateur ? ». FGAC est généralement implémenté au niveau des moteurs de calcul car il nécessite l'évaluation des données elles-mêmes.</p>
<p><strong>L'Attribute-Based Access Control (ABAC)</strong> généralise ces contrôles en définissant des politiques basées sur des attributs (tags, classifications) plutôt que sur des objets individuels. Une politique ABAC pourrait stipuler : « Toutes les colonnes taguées PII doivent être masquées pour les utilisateurs sans le rôle compliance ». Cette approche simplifie la gestion à grande échelle.</p>
<h3 id="row-level-security-rls">Row-Level Security (RLS)<a class="headerlink" href="#row-level-security-rls" title="Permanent link">&para;</a></h3>
<p>La sécurité au niveau des lignes permet de filtrer automatiquement les données qu'un utilisateur peut voir en fonction de son identité ou de ses attributs. Cette capacité est essentielle pour les organisations où différentes équipes ou régions doivent accéder aux mêmes tables mais avec des périmètres de données différents.</p>
<p>Unity Catalog de Databricks offre une implémentation mature de RLS via les filtres de lignes. Ces filtres sont définis comme des fonctions SQL qui retournent TRUE pour les lignes accessibles à l'utilisateur courant.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1">-- Création d&#39;une fonction de filtre pour la sécurité régionale</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="c1">-- Les gestionnaires de compte ne voient que les clients de leur région</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">filtre_region_gestionnaire</span><span class="p">()</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">RETURNS</span><span class="w"> </span><span class="nb">BOOLEAN</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="k">RETURN</span><span class="w"> </span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">    </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;administrateurs_donnees&#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Accès complet</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="k">current_user</span><span class="p">()</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">courriel_gestionnaire</span><span class="w"> </span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">reference</span><span class="p">.</span><span class="n">gestionnaires_regions</span><span class="w"> </span><span class="n">gr</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">gr</span><span class="p">.</span><span class="n">region_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">transactions</span><span class="p">.</span><span class="n">region_id</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="c1">-- Application du filtre à la table des transactions</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">transactions</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="k">SET</span><span class="w"> </span><span class="k">ROW</span><span class="w"> </span><span class="n">FILTER</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">filtre_region_gestionnaire</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="p">();</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="c1">-- Vérification : Un gestionnaire de la région Québec</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="c1">-- ne verra que les transactions de sa région</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">transactions</span><span class="p">;</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="c1">-- Retourne 45,230 (transactions Québec seulement)</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="c1">-- Pour un administrateur de données</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a><span class="c1">-- Retourne 1,234,567 (toutes les transactions)</span>
</code></pre></div>
<p>AWS Lake Formation offre une approche similaire via les Data Filters. Ces filtres peuvent être définis de manière déclarative et appliqués lors de l'attribution des permissions.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Configuration de Row-Level Security avec AWS Lake Formation</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="n">lakeformation</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;lakeformation&#39;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="s1">&#39;ca-central-1&#39;</span><span class="p">)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="c1"># Créer un filtre de données pour les transactions</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">lakeformation</span><span class="o">.</span><span class="n">create_data_cells_filter</span><span class="p">(</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>    <span class="n">TableData</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>        <span class="s1">&#39;DatabaseName&#39;</span><span class="p">:</span> <span class="s1">&#39;lakehouse&#39;</span><span class="p">,</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>        <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;filtre_region_quebec&#39;</span><span class="p">,</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="s1">&#39;TableCatalogId&#39;</span><span class="p">:</span> <span class="s1">&#39;123456789012&#39;</span><span class="p">,</span>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>        <span class="s1">&#39;TableName&#39;</span><span class="p">:</span> <span class="s1">&#39;transactions&#39;</span><span class="p">,</span>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>        <span class="s1">&#39;RowFilter&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>            <span class="s1">&#39;FilterExpression&#39;</span><span class="p">:</span> <span class="s2">&quot;region = &#39;QC&#39;&quot;</span>
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>        <span class="p">}</span>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>    <span class="p">}</span>
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="p">)</span>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="c1"># Créer un filtre pour l&#39;Ontario</span>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="n">lakeformation</span><span class="o">.</span><span class="n">create_data_cells_filter</span><span class="p">(</span>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>    <span class="n">TableData</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>        <span class="s1">&#39;DatabaseName&#39;</span><span class="p">:</span> <span class="s1">&#39;lakehouse&#39;</span><span class="p">,</span>
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>        <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;filtre_region_ontario&#39;</span><span class="p">,</span>
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>        <span class="s1">&#39;TableCatalogId&#39;</span><span class="p">:</span> <span class="s1">&#39;123456789012&#39;</span><span class="p">,</span>
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>        <span class="s1">&#39;TableName&#39;</span><span class="p">:</span> <span class="s1">&#39;transactions&#39;</span><span class="p">,</span>
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>        <span class="s1">&#39;RowFilter&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>            <span class="s1">&#39;FilterExpression&#39;</span><span class="p">:</span> <span class="s2">&quot;region = &#39;ON&#39;&quot;</span>
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>        <span class="p">}</span>
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>    <span class="p">}</span>
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="p">)</span>
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="c1"># Attribuer les permissions avec le filtre</span>
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="n">lakeformation</span><span class="o">.</span><span class="n">grant_permissions</span><span class="p">(</span>
<a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>    <span class="n">Principal</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>        <span class="s1">&#39;DataLakePrincipalIdentifier&#39;</span><span class="p">:</span> <span class="s1">&#39;arn:aws:iam::123456789012:role/AnalysteQuebec&#39;</span>
<a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>    <span class="p">},</span>
<a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>    <span class="n">Resource</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>        <span class="s1">&#39;DataCellsFilter&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>            <span class="s1">&#39;DatabaseName&#39;</span><span class="p">:</span> <span class="s1">&#39;lakehouse&#39;</span><span class="p">,</span>
<a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>            <span class="s1">&#39;TableName&#39;</span><span class="p">:</span> <span class="s1">&#39;transactions&#39;</span><span class="p">,</span>
<a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a>            <span class="s1">&#39;TableCatalogId&#39;</span><span class="p">:</span> <span class="s1">&#39;123456789012&#39;</span><span class="p">,</span>
<a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>            <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="s1">&#39;filtre_region_quebec&#39;</span>
<a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>        <span class="p">}</span>
<a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a>    <span class="p">},</span>
<a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>    <span class="n">Permissions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SELECT&#39;</span><span class="p">]</span>
<a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="p">)</span>
</code></pre></div>
<h3 id="column-level-security-et-masquage-dynamique">Column-Level Security et Masquage Dynamique<a class="headerlink" href="#column-level-security-et-masquage-dynamique" title="Permanent link">&para;</a></h3>
<p>Le masquage de colonnes permet de protéger les données sensibles sans créer de copies multiples des tables. Les utilisateurs autorisés voient les valeurs réelles, tandis que les autres voient des valeurs masquées ou nulles.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">-- Fonction de masquage pour le numéro d&#39;assurance sociale</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_nas</span><span class="p">(</span><span class="n">nas</span><span class="w"> </span><span class="n">STRING</span><span class="p">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">RETURNS</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="k">RETURN</span><span class="w"> </span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="k">CASE</span><span class="w"> </span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;acces_nas_complet&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">nas</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;acces_nas_partiel&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">            </span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;***-***-&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">RIGHT</span><span class="p">(</span><span class="n">nas</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="w">  </span><span class="c1">-- Affiche seulement les 3 derniers chiffres</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;***-***-***&#39;</span><span class="w">  </span><span class="c1">-- Masquage complet</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="c1">-- Fonction de masquage pour les montants (arrondi pour certains utilisateurs)</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_montant</span><span class="p">(</span><span class="n">montant</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="k">RETURNS</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="k">RETURN</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;finance_detail&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">montant</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;finance_apercu&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">            </span><span class="n">ROUND</span><span class="p">(</span><span class="n">montant</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Arrondi au millier</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">NULL</span>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="c1">-- Application des masques à la table</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">donnees_personnelles</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">nas</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">MASK</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_nas</span><span class="p">;</span>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">finance</span><span class="p">.</span><span class="n">transactions</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">montant</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">MASK</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_montant</span><span class="p">;</span>
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="c1">-- Résultat pour un analyste sans accès NAS complet</span>
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">client_id</span><span class="p">,</span><span class="w"> </span><span class="n">nom</span><span class="p">,</span><span class="w"> </span><span class="n">nas</span><span class="p">,</span><span class="w"> </span><span class="n">date_naissance</span><span class="w"> </span>
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">donnees_personnelles</span>
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="k">LIMIT</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>
<a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="c1">-- client_id | nom          | nas         | date_naissance</span>
<a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="c1">-- C001      | Tremblay     | ***-***-234 | 1985-03-15</span>
<a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="c1">-- C002      | Gagnon       | ***-***-891 | 1990-07-22</span>
<a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="c1">-- C003      | Roy          | ***-***-456 | 1978-11-08</span>
</code></pre></div>
<h3 id="vues-dynamiques-securisees">Vues Dynamiques Sécurisées<a class="headerlink" href="#vues-dynamiques-securisees" title="Permanent link">&para;</a></h3>
<p>Les vues dynamiques offrent une approche alternative au masquage au niveau des tables. Elles permettent de définir des transformations de sécurité complexes et de les appliquer de manière transparente aux consommateurs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1">-- Vue sécurisée qui combine RLS et masquage de colonnes</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">vues_securisees</span><span class="p">.</span><span class="n">v_clients_securise</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">SELECT</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="n">client_id</span><span class="p">,</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="n">nom</span><span class="p">,</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="n">prenom</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="c1">-- Masquage du courriel basé sur le groupe</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="k">CASE</span><span class="w"> </span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;marketing_complet&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">courriel</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="n">courriel</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;***@&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">SPLIT_PART</span><span class="p">(</span><span class="n">courriel</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;@&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">courriel</span><span class="p">,</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">    </span><span class="c1">-- Masquage du téléphone</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;service_client&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">telephone</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;(***) ***-&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">RIGHT</span><span class="p">(</span><span class="n">telephone</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">telephone</span><span class="p">,</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">    </span><span class="c1">-- NAS complètement masqué sauf pour compliance</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;compliance_pii&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">nas</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">NULL</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">nas</span><span class="p">,</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">    </span><span class="n">region</span><span class="p">,</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">    </span><span class="n">date_inscription</span><span class="p">,</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">    </span><span class="c1">-- Segment client visible pour le marketing</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">    </span><span class="n">segment_client</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">donnees_personnelles</span>
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="c1">-- RLS : Filtre régional</span>
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="k">WHERE</span><span class="w"> </span>
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">    </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;acces_national&#39;</span><span class="p">)</span>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">    </span><span class="k">OR</span><span class="w"> </span><span class="n">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">region</span><span class="w"> </span>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">reference</span><span class="p">.</span><span class="n">utilisateurs_regions</span><span class="w"> </span>
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">courriel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">current_user</span><span class="p">()</span>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">    </span><span class="p">);</span>
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="c1">-- Attribution des permissions sur la vue uniquement</span>
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="k">GRANT</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">vues_securisees</span><span class="p">.</span><span class="n">v_clients_securise</span><span class="w"> </span>
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="k">TO</span><span class="w"> </span><span class="n">role_analyste_marketing</span><span class="p">;</span>
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a>
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="c1">-- Révocation de l&#39;accès direct à la table source</span>
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="k">REVOKE</span><span class="w"> </span><span class="k">ALL</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">clients</span><span class="p">.</span><span class="n">donnees_personnelles</span><span class="w"> </span>
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="k">FROM</span><span class="w"> </span><span class="n">role_analyste_marketing</span><span class="p">;</span>
</code></pre></div>
<h3 id="patterns-de-masquage-avances">Patterns de Masquage Avancés<a class="headerlink" href="#patterns-de-masquage-avances" title="Permanent link">&para;</a></h3>
<p>Au-delà du masquage simple par remplacement de caractères, plusieurs patterns avancés permettent de préserver l'utilité analytique des données tout en protégeant la confidentialité.</p>
<p><strong>Le masquage préservant le format</strong> maintient la structure des données (longueur, format) tout en remplaçant les valeurs. Cette approche est utile pour les tests et le développement où le réalisme des données est important.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">-- Fonction de masquage préservant le format pour les numéros de carte</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_carte_credit</span><span class="p">(</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="n">numero_carte</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="k">RETURN</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;paiements_complet&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">numero_carte</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">            </span><span class="s1">&#39;****-****-****-&#39;</span><span class="p">,</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">            </span><span class="k">RIGHT</span><span class="p">(</span><span class="n">numero_carte</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Préserve les 4 derniers chiffres</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">        </span><span class="p">)</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="c1">-- Masquage préservant le format pour les codes postaux</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_code_postal</span><span class="p">(</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">    </span><span class="n">code_postal</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="k">RETURN</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;geo_complet&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">code_postal</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">        </span><span class="c1">-- Préserve la région (3 premiers caractères), masque le reste</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="k">LEFT</span><span class="p">(</span><span class="n">code_postal</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; ***&#39;</span><span class="p">)</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="c1">-- Masquage avec bruit différentiel pour les montants</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="c1">-- Permet l&#39;analyse statistique tout en protégeant les valeurs individuelles</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">masque_montant_differentiel</span><span class="p">(</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">    </span><span class="n">montant</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">    </span><span class="n">epsilon</span><span class="w"> </span><span class="n">DOUBLE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="k">RETURN</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;finance_detail&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">montant</span>
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span>
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a><span class="w">            </span><span class="n">montant</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">RAND</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">epsilon</span><span class="p">),</span>
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a><span class="w">            </span><span class="mi">2</span>
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="w">        </span><span class="p">)</span>
<a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
</code></pre></div>
<p><strong>La tokenisation</strong> remplace les valeurs sensibles par des jetons non réversibles, permettant les jointures et agrégations sans exposer les valeurs réelles.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">-- Table de correspondance pour la tokenisation (accès très restreint)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">tokens_clients</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="n">token</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="n">valeur_reelle</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Chiffré avec clé séparée</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="n">type_donnee</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">    </span><span class="c1">-- EMAIL, TELEPHONE, NAS</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span><span class="n">date_creation</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="n">date_expiration</span><span class="w"> </span><span class="k">TIMESTAMP</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">iceberg</span><span class="p">;</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="c1">-- Fonction de tokenisation</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">tokeniser</span><span class="p">(</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">    </span><span class="n">valeur</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">    </span><span class="n">type_donnee</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">PYTHON</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">hashlib</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">    </span><span class="n">import</span><span class="w"> </span><span class="n">hmac</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">    </span><span class="o">#</span><span class="w"> </span><span class="n">Clé</span><span class="w"> </span><span class="n">secrète</span><span class="w"> </span><span class="p">(</span><span class="n">en</span><span class="w"> </span><span class="n">production</span><span class="p">,</span><span class="w"> </span><span class="n">récupérée</span><span class="w"> </span><span class="n">depuis</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="n">gestionnaire</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">secrets</span><span class="p">)</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">    </span><span class="n">secret_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_secret</span><span class="p">(</span><span class="s1">&#39;tokenization_key&#39;</span><span class="p">)</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">    </span><span class="o">#</span><span class="w"> </span><span class="n">Génération</span><span class="w"> </span><span class="n">du</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">HMAC</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">    </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hmac</span><span class="p">.</span><span class="k">new</span><span class="p">(</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="w">        </span><span class="n">secret_key</span><span class="p">.</span><span class="n">encode</span><span class="p">(),</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">        </span><span class="p">(</span><span class="n">type_donnee</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">valeur</span><span class="p">).</span><span class="n">encode</span><span class="p">(),</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">        </span><span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">    </span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()[:</span><span class="mi">16</span><span class="p">]</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot;TKN_{type_donnee}_{token}&quot;</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="err">$$</span><span class="p">;</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a><span class="c1">-- Exemple d&#39;utilisation : Vue tokenisée pour l&#39;analytique</span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">analytique</span><span class="p">.</span><span class="n">v_transactions_tokenisees</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a><span class="k">SELECT</span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a><span class="w">    </span><span class="n">transaction_id</span><span class="p">,</span>
<a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a><span class="w">    </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">tokeniser</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CLIENT&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">client_token</span><span class="p">,</span>
<a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a><span class="w">    </span><span class="n">montant</span><span class="p">,</span>
<a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a><span class="w">    </span><span class="n">date_transaction</span><span class="p">,</span>
<a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a><span class="w">    </span><span class="n">categorie_produit</span><span class="p">,</span>
<a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a><span class="w">    </span><span class="n">region</span>
<a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">gold</span><span class="p">.</span><span class="n">transactions</span><span class="p">;</span>
</code></pre></div>
<p><strong>La généralisation</strong> réduit la précision des données pour protéger les individus tout en préservant les tendances statistiques.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="c1">-- Généralisation de l&#39;âge en tranches</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">generaliser_age</span><span class="p">(</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="n">date_naissance</span><span class="w"> </span><span class="nb">DATE</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="k">RETURN</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;demographie_detail&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">            </span><span class="k">CAST</span><span class="p">(</span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">STRING</span><span class="p">)</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">        </span><span class="k">ELSE</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="w">            </span><span class="k">CASE</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="w">                </span><span class="k">WHEN</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">18</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;Moins de 18&#39;</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="w">                </span><span class="k">WHEN</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;18-24&#39;</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="w">                </span><span class="k">WHEN</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">35</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;25-34&#39;</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="w">                </span><span class="k">WHEN</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;35-44&#39;</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="w">                </span><span class="k">WHEN</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">55</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;45-54&#39;</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="w">                </span><span class="k">WHEN</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">current_date</span><span class="p">())</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">date_naissance</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;55-64&#39;</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">                </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;65 et plus&#39;</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="w">            </span><span class="k">END</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="c1">-- Généralisation géographique</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">securite</span><span class="p">.</span><span class="n">generaliser_localisation</span><span class="p">(</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="w">    </span><span class="n">code_postal</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="p">)</span><span class="w"> </span><span class="k">RETURNS</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="k">RETURN</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="w">    </span><span class="k">CASE</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">is_account_group_member</span><span class="p">(</span><span class="s1">&#39;geo_detail&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="n">code_postal</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="w">        </span><span class="c1">-- Retourne seulement la région de tri d&#39;acheminement (RTA)</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="k">LEFT</span><span class="p">(</span><span class="n">code_postal</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="w">    </span><span class="k">END</span><span class="p">;</span>
</code></pre></div>
<blockquote>
<p><strong>Performance</strong><br />
Les contrôles d'accès granulaires (RLS, masquage) ajoutent une surcharge de traitement. Pour les tables très volumineuses, considérez les stratégies suivantes :
- Utiliser des filtres basés sur des colonnes de partition pour bénéficier du pruning
- Pré-calculer les tables de mapping des permissions pour éviter les sous-requêtes coûteuses
- Évaluer l'utilisation de vues matérialisées pour les cas d'usage récurrents
- Monitorer les temps de requête et ajuster les politiques si nécessaire</p>
</blockquote>
<h3 id="tableaux-de-bord-de-gouvernance">Tableaux de Bord de Gouvernance<a class="headerlink" href="#tableaux-de-bord-de-gouvernance" title="Permanent link">&para;</a></h3>
<p>La visibilité sur l'état de la gouvernance est essentielle pour maintenir une posture de sécurité adéquate. Un tableau de bord centralisé permet aux équipes de sécurité et de conformité de surveiller les métriques clés.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">-- Métriques de gouvernance calculées quotidiennement</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">v_metriques_quotidiennes</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="k">WITH</span><span class="w"> </span><span class="n">metriques_acces</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="k">SELECT</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">        </span><span class="n">date_partition</span><span class="p">,</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">principal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">utilisateurs_actifs</span><span class="p">,</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">total_requetes</span><span class="p">,</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">code_erreur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ACCESS_DENIED&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">END</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">acces_refuses</span><span class="p">,</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">ressource_table</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">tables_accedees</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">audit</span><span class="p">.</span><span class="n">evenements_unifies</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">date_partition</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">current_date</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">DAYS</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">date_partition</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="p">),</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="n">metriques_pii</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w">    </span><span class="k">SELECT</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">        </span><span class="n">date_partition</span><span class="p">,</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">acces_pii</span><span class="p">,</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">principal</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">utilisateurs_pii</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">audit</span><span class="p">.</span><span class="n">evenements_unifies</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">ressource_table</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">        </span><span class="k">SELECT</span><span class="w"> </span><span class="n">chemin_technique</span><span class="w"> </span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">        </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">catalogue_metier</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="w">        </span><span class="k">WHERE</span><span class="w"> </span><span class="n">contient_pii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">true</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">    </span><span class="p">)</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">date_partition</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">current_date</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">DAYS</span>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">date_partition</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a><span class="p">),</span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="n">metriques_conformite</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">    </span><span class="k">SELECT</span>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="w">        </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">demandes_effacement_en_cours</span><span class="p">,</span>
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="w">        </span><span class="k">SUM</span><span class="p">(</span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">statut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;COMPLETE&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">END</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">demandes_completees</span><span class="p">,</span>
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="w">        </span><span class="k">AVG</span><span class="p">(</span><span class="n">delai_traitement_jours</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">delai_moyen_jours</span>
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">conformite</span><span class="p">.</span><span class="n">demandes_effacement</span>
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">date_demande</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">current_date</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">DAYS</span>
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="p">)</span>
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a>
<a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a><span class="k">SELECT</span>
<a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">date_partition</span><span class="p">,</span>
<a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a><span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">utilisateurs_actifs</span><span class="p">,</span>
<a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a><span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">total_requetes</span><span class="p">,</span>
<a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a><span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">acces_refuses</span><span class="p">,</span>
<a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a><span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">acces_refuses</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">ma</span><span class="p">.</span><span class="n">total_requetes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">taux_refus_pct</span><span class="p">,</span>
<a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="w">    </span><span class="n">ma</span><span class="p">.</span><span class="n">tables_accedees</span><span class="p">,</span>
<a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a><span class="w">    </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">acces_pii</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">acces_pii</span><span class="p">,</span>
<a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="w">    </span><span class="k">COALESCE</span><span class="p">(</span><span class="n">mp</span><span class="p">.</span><span class="n">utilisateurs_pii</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">utilisateurs_pii</span><span class="p">,</span>
<a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a><span class="w">    </span><span class="n">mc</span><span class="p">.</span><span class="n">demandes_effacement_en_cours</span><span class="p">,</span>
<a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a><span class="w">    </span><span class="n">mc</span><span class="p">.</span><span class="n">demandes_completees</span><span class="p">,</span>
<a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a><span class="w">    </span><span class="n">mc</span><span class="p">.</span><span class="n">delai_moyen_jours</span>
<a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a><span class="k">FROM</span><span class="w"> </span><span class="n">metriques_acces</span><span class="w"> </span><span class="n">ma</span>
<a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">metriques_pii</span><span class="w"> </span><span class="n">mp</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">date_partition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mp</span><span class="p">.</span><span class="n">date_partition</span>
<a id="__codelineno-14-53" name="__codelineno-14-53" href="#__codelineno-14-53"></a><span class="k">CROSS</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">metriques_conformite</span><span class="w"> </span><span class="n">mc</span>
<a id="__codelineno-14-54" name="__codelineno-14-54" href="#__codelineno-14-54"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">ma</span><span class="p">.</span><span class="n">date_partition</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
<a id="__codelineno-14-55" name="__codelineno-14-55" href="#__codelineno-14-55"></a>
<a id="__codelineno-14-56" name="__codelineno-14-56" href="#__codelineno-14-56"></a><span class="c1">-- Vue des anomalies de sécurité détectées</span>
<a id="__codelineno-14-57" name="__codelineno-14-57" href="#__codelineno-14-57"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">VIEW</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">v_anomalies_securite</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-14-58" name="__codelineno-14-58" href="#__codelineno-14-58"></a><span class="k">SELECT</span>
<a id="__codelineno-14-59" name="__codelineno-14-59" href="#__codelineno-14-59"></a><span class="w">    </span><span class="k">timestamp</span><span class="p">,</span>
<a id="__codelineno-14-60" name="__codelineno-14-60" href="#__codelineno-14-60"></a><span class="w">    </span><span class="n">principal</span><span class="p">,</span>
<a id="__codelineno-14-61" name="__codelineno-14-61" href="#__codelineno-14-61"></a><span class="w">    </span><span class="n">type_anomalie</span><span class="p">,</span>
<a id="__codelineno-14-62" name="__codelineno-14-62" href="#__codelineno-14-62"></a><span class="w">    </span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-14-63" name="__codelineno-14-63" href="#__codelineno-14-63"></a><span class="w">    </span><span class="n">severite</span><span class="p">,</span>
<a id="__codelineno-14-64" name="__codelineno-14-64" href="#__codelineno-14-64"></a><span class="w">    </span><span class="n">statut_investigation</span>
<a id="__codelineno-14-65" name="__codelineno-14-65" href="#__codelineno-14-65"></a><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-14-66" name="__codelineno-14-66" href="#__codelineno-14-66"></a><span class="w">    </span><span class="c1">-- Accès en dehors des heures normales</span>
<a id="__codelineno-14-67" name="__codelineno-14-67" href="#__codelineno-14-67"></a><span class="w">    </span><span class="k">SELECT</span>
<a id="__codelineno-14-68" name="__codelineno-14-68" href="#__codelineno-14-68"></a><span class="w">        </span><span class="k">timestamp</span><span class="p">,</span>
<a id="__codelineno-14-69" name="__codelineno-14-69" href="#__codelineno-14-69"></a><span class="w">        </span><span class="n">principal</span><span class="p">,</span>
<a id="__codelineno-14-70" name="__codelineno-14-70" href="#__codelineno-14-70"></a><span class="w">        </span><span class="s1">&#39;ACCES_HORS_HEURES&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">type_anomalie</span><span class="p">,</span>
<a id="__codelineno-14-71" name="__codelineno-14-71" href="#__codelineno-14-71"></a><span class="w">        </span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;Accès à &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ressource_table</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; à &#39;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-14-72" name="__codelineno-14-72" href="#__codelineno-14-72"></a><span class="w">               </span><span class="n">DATE_FORMAT</span><span class="p">(</span><span class="k">timestamp</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HH:mm&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-14-73" name="__codelineno-14-73" href="#__codelineno-14-73"></a><span class="w">        </span><span class="s1">&#39;MOYEN&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">severite</span><span class="p">,</span>
<a id="__codelineno-14-74" name="__codelineno-14-74" href="#__codelineno-14-74"></a><span class="w">        </span><span class="s1">&#39;EN_ATTENTE&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">statut_investigation</span>
<a id="__codelineno-14-75" name="__codelineno-14-75" href="#__codelineno-14-75"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">audit</span><span class="p">.</span><span class="n">evenements_unifies</span>
<a id="__codelineno-14-76" name="__codelineno-14-76" href="#__codelineno-14-76"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">HOUR</span><span class="p">(</span><span class="k">timestamp</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="n">HOUR</span><span class="p">(</span><span class="k">timestamp</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">22</span>
<a id="__codelineno-14-77" name="__codelineno-14-77" href="#__codelineno-14-77"></a><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">principal</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="n">courriel</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">production</span><span class="p">.</span><span class="n">reference</span><span class="p">.</span><span class="n">comptes_service</span><span class="p">)</span>
<a id="__codelineno-14-78" name="__codelineno-14-78" href="#__codelineno-14-78"></a>
<a id="__codelineno-14-79" name="__codelineno-14-79" href="#__codelineno-14-79"></a><span class="w">    </span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span>
<a id="__codelineno-14-80" name="__codelineno-14-80" href="#__codelineno-14-80"></a>
<a id="__codelineno-14-81" name="__codelineno-14-81" href="#__codelineno-14-81"></a><span class="w">    </span><span class="c1">-- Volume de données anormalement élevé</span>
<a id="__codelineno-14-82" name="__codelineno-14-82" href="#__codelineno-14-82"></a><span class="w">    </span><span class="k">SELECT</span>
<a id="__codelineno-14-83" name="__codelineno-14-83" href="#__codelineno-14-83"></a><span class="w">        </span><span class="k">MAX</span><span class="p">(</span><span class="k">timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">timestamp</span><span class="p">,</span>
<a id="__codelineno-14-84" name="__codelineno-14-84" href="#__codelineno-14-84"></a><span class="w">        </span><span class="n">principal</span><span class="p">,</span>
<a id="__codelineno-14-85" name="__codelineno-14-85" href="#__codelineno-14-85"></a><span class="w">        </span><span class="s1">&#39;VOLUME_ANORMAL&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">type_anomalie</span><span class="p">,</span>
<a id="__codelineno-14-86" name="__codelineno-14-86" href="#__codelineno-14-86"></a><span class="w">        </span><span class="n">CONCAT</span><span class="p">(</span><span class="s1">&#39;Volume: &#39;</span><span class="p">,</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">lignes_affectees</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; lignes en 1 heure&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-14-87" name="__codelineno-14-87" href="#__codelineno-14-87"></a><span class="w">        </span><span class="k">CASE</span><span class="w"> </span>
<a id="__codelineno-14-88" name="__codelineno-14-88" href="#__codelineno-14-88"></a><span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">lignes_affectees</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;CRITIQUE&#39;</span>
<a id="__codelineno-14-89" name="__codelineno-14-89" href="#__codelineno-14-89"></a><span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">lignes_affectees</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000000</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ELEVE&#39;</span>
<a id="__codelineno-14-90" name="__codelineno-14-90" href="#__codelineno-14-90"></a><span class="w">            </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;MOYEN&#39;</span>
<a id="__codelineno-14-91" name="__codelineno-14-91" href="#__codelineno-14-91"></a><span class="w">        </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">severite</span><span class="p">,</span>
<a id="__codelineno-14-92" name="__codelineno-14-92" href="#__codelineno-14-92"></a><span class="w">        </span><span class="s1">&#39;EN_ATTENTE&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">statut_investigation</span>
<a id="__codelineno-14-93" name="__codelineno-14-93" href="#__codelineno-14-93"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">audit</span><span class="p">.</span><span class="n">evenements_unifies</span>
<a id="__codelineno-14-94" name="__codelineno-14-94" href="#__codelineno-14-94"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">current_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">HOUR</span>
<a id="__codelineno-14-95" name="__codelineno-14-95" href="#__codelineno-14-95"></a><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">principal</span>
<a id="__codelineno-14-96" name="__codelineno-14-96" href="#__codelineno-14-96"></a><span class="w">    </span><span class="k">HAVING</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">lignes_affectees</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100000</span>
<a id="__codelineno-14-97" name="__codelineno-14-97" href="#__codelineno-14-97"></a>
<a id="__codelineno-14-98" name="__codelineno-14-98" href="#__codelineno-14-98"></a><span class="w">    </span><span class="k">UNION</span><span class="w"> </span><span class="k">ALL</span>
<a id="__codelineno-14-99" name="__codelineno-14-99" href="#__codelineno-14-99"></a>
<a id="__codelineno-14-100" name="__codelineno-14-100" href="#__codelineno-14-100"></a><span class="w">    </span><span class="c1">-- Tentatives d&#39;accès répétées refusées</span>
<a id="__codelineno-14-101" name="__codelineno-14-101" href="#__codelineno-14-101"></a><span class="w">    </span><span class="k">SELECT</span>
<a id="__codelineno-14-102" name="__codelineno-14-102" href="#__codelineno-14-102"></a><span class="w">        </span><span class="k">MAX</span><span class="p">(</span><span class="k">timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">timestamp</span><span class="p">,</span>
<a id="__codelineno-14-103" name="__codelineno-14-103" href="#__codelineno-14-103"></a><span class="w">        </span><span class="n">principal</span><span class="p">,</span>
<a id="__codelineno-14-104" name="__codelineno-14-104" href="#__codelineno-14-104"></a><span class="w">        </span><span class="s1">&#39;TENTATIVES_REFUSEES&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">type_anomalie</span><span class="p">,</span>
<a id="__codelineno-14-105" name="__codelineno-14-105" href="#__codelineno-14-105"></a><span class="w">        </span><span class="n">CONCAT</span><span class="p">(</span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39; tentatives refusées en 10 minutes&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">description</span><span class="p">,</span>
<a id="__codelineno-14-106" name="__codelineno-14-106" href="#__codelineno-14-106"></a><span class="w">        </span><span class="k">CASE</span><span class="w"> </span>
<a id="__codelineno-14-107" name="__codelineno-14-107" href="#__codelineno-14-107"></a><span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;CRITIQUE&#39;</span>
<a id="__codelineno-14-108" name="__codelineno-14-108" href="#__codelineno-14-108"></a><span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ELEVE&#39;</span>
<a id="__codelineno-14-109" name="__codelineno-14-109" href="#__codelineno-14-109"></a><span class="w">            </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;MOYEN&#39;</span>
<a id="__codelineno-14-110" name="__codelineno-14-110" href="#__codelineno-14-110"></a><span class="w">        </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">severite</span><span class="p">,</span>
<a id="__codelineno-14-111" name="__codelineno-14-111" href="#__codelineno-14-111"></a><span class="w">        </span><span class="s1">&#39;EN_ATTENTE&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">statut_investigation</span>
<a id="__codelineno-14-112" name="__codelineno-14-112" href="#__codelineno-14-112"></a><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">audit</span><span class="p">.</span><span class="n">evenements_unifies</span>
<a id="__codelineno-14-113" name="__codelineno-14-113" href="#__codelineno-14-113"></a><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">code_erreur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ACCESS_DENIED&#39;</span>
<a id="__codelineno-14-114" name="__codelineno-14-114" href="#__codelineno-14-114"></a><span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">current_timestamp</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">MINUTES</span>
<a id="__codelineno-14-115" name="__codelineno-14-115" href="#__codelineno-14-115"></a><span class="w">    </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">principal</span>
<a id="__codelineno-14-116" name="__codelineno-14-116" href="#__codelineno-14-116"></a><span class="w">    </span><span class="k">HAVING</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10</span>
<a id="__codelineno-14-117" name="__codelineno-14-117" href="#__codelineno-14-117"></a><span class="p">)</span><span class="w"> </span><span class="n">anomalies</span>
<a id="__codelineno-14-118" name="__codelineno-14-118" href="#__codelineno-14-118"></a><span class="k">WHERE</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="k">current_date</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">INTERVAL</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="n">DAYS</span>
<a id="__codelineno-14-119" name="__codelineno-14-119" href="#__codelineno-14-119"></a><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span>
<a id="__codelineno-14-120" name="__codelineno-14-120" href="#__codelineno-14-120"></a><span class="w">    </span><span class="k">CASE</span><span class="w"> </span><span class="n">severite</span><span class="w"> </span>
<a id="__codelineno-14-121" name="__codelineno-14-121" href="#__codelineno-14-121"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;CRITIQUE&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>
<a id="__codelineno-14-122" name="__codelineno-14-122" href="#__codelineno-14-122"></a><span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;ELEVE&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span>
<a id="__codelineno-14-123" name="__codelineno-14-123" href="#__codelineno-14-123"></a><span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span>
<a id="__codelineno-14-124" name="__codelineno-14-124" href="#__codelineno-14-124"></a><span class="w">    </span><span class="k">END</span><span class="p">,</span>
<a id="__codelineno-14-125" name="__codelineno-14-125" href="#__codelineno-14-125"></a><span class="w">    </span><span class="k">timestamp</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
<a id="__codelineno-14-126" name="__codelineno-14-126" href="#__codelineno-14-126"></a>
<a id="__codelineno-14-127" name="__codelineno-14-127" href="#__codelineno-14-127"></a><span class="c1">---</span>
<a id="__codelineno-14-128" name="__codelineno-14-128" href="#__codelineno-14-128"></a>
<a id="__codelineno-14-129" name="__codelineno-14-129" href="#__codelineno-14-129"></a><span class="o">##</span><span class="w"> </span><span class="n">IV</span><span class="p">.</span><span class="mi">13</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="n">Gouvernance</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">Données</span>
<a id="__codelineno-14-130" name="__codelineno-14-130" href="#__codelineno-14-130"></a>
<a id="__codelineno-14-131" name="__codelineno-14-131" href="#__codelineno-14-131"></a><span class="o">###</span><span class="w"> </span><span class="n">Le</span><span class="w"> </span><span class="n">Lignage</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">Données</span><span class="w"> </span><span class="n">avec</span><span class="w"> </span><span class="n">OpenLineage</span>
<a id="__codelineno-14-132" name="__codelineno-14-132" href="#__codelineno-14-132"></a>
<a id="__codelineno-14-133" name="__codelineno-14-133" href="#__codelineno-14-133"></a><span class="n">Le</span><span class="w"> </span><span class="n">lignage</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">données</span><span class="w"> </span><span class="n">répond</span><span class="w"> </span><span class="err">à</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">questions</span><span class="w"> </span><span class="n">fondamentales</span><span class="w"> </span><span class="n">pour</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">gouvernance</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">D</span><span class="s1">&#39;où viennent ces données ? Comment ont-elles été transformées ? Qui y a accédé ? Ces informations sont essentielles pour l&#39;</span><span class="n">audit</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="s1">&#39;analyse d&#39;</span><span class="n">impact</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">le</span><span class="w"> </span><span class="n">débogage</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">problèmes</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">qualité</span><span class="p">.</span>
<a id="__codelineno-14-134" name="__codelineno-14-134" href="#__codelineno-14-134"></a>
<a id="__codelineno-14-135" name="__codelineno-14-135" href="#__codelineno-14-135"></a><span class="o">**</span><span class="n">OpenLineage</span><span class="o">**</span><span class="w"> </span><span class="err">é</span><span class="n">merge</span><span class="w"> </span><span class="n">comme</span><span class="w"> </span><span class="n">le</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">ouvert</span><span class="w"> </span><span class="n">pour</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">collecte</span><span class="w"> </span><span class="n">du</span><span class="w"> </span><span class="n">lignage</span><span class="p">.</span><span class="w"> </span><span class="n">Cette</span><span class="w"> </span><span class="n">spécification</span><span class="p">,</span><span class="w"> </span><span class="n">hébergée</span><span class="w"> </span><span class="n">par</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="n">Foundation</span><span class="w"> </span><span class="n">AI</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="k">Data</span><span class="p">,</span><span class="w"> </span><span class="n">définit</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="n">modèle</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">données</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="n">protocole</span><span class="w"> </span><span class="n">pour</span><span class="w"> </span><span class="n">capturer</span><span class="w"> </span><span class="n">les</span><span class="w"> </span><span class="err">é</span><span class="n">vénements</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">lignage</span><span class="w"> </span><span class="err">à</span><span class="w"> </span><span class="n">travers</span><span class="w"> </span><span class="n">différents</span><span class="w"> </span><span class="n">outils</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">plateformes</span><span class="p">.</span><span class="w"> </span><span class="n">Apache</span><span class="w"> </span><span class="n">Spark</span><span class="p">,</span><span class="w"> </span><span class="n">Apache</span><span class="w"> </span><span class="n">Flink</span><span class="p">,</span><span class="w"> </span><span class="n">Apache</span><span class="w"> </span><span class="n">Airflow</span><span class="p">,</span><span class="w"> </span><span class="n">dbt</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">nombreux</span><span class="w"> </span><span class="n">autres</span><span class="w"> </span><span class="n">outils</span><span class="w"> </span><span class="n">supportent</span><span class="w"> </span><span class="n">désormais</span><span class="w"> </span><span class="n">l</span><span class="s1">&#39;émission d&#39;</span><span class="err">é</span><span class="n">vénements</span><span class="w"> </span><span class="n">OpenLineage</span><span class="p">.</span>
<a id="__codelineno-14-136" name="__codelineno-14-136" href="#__codelineno-14-136"></a>
<a id="__codelineno-14-137" name="__codelineno-14-137" href="#__codelineno-14-137"></a><span class="n">Le</span><span class="w"> </span><span class="n">modèle</span><span class="w"> </span><span class="n">OpenLineage</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">trois</span><span class="w"> </span><span class="n">entités</span><span class="w"> </span><span class="n">principales</span><span class="p">.</span><span class="w"> </span><span class="n">Les</span><span class="w"> </span><span class="o">**</span><span class="n">Jobs</span><span class="o">**</span><span class="w"> </span><span class="n">représentent</span><span class="w"> </span><span class="n">les</span><span class="w"> </span><span class="n">processus</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">transformation</span><span class="w"> </span><span class="p">(</span><span class="n">un</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="n">Spark</span><span class="p">,</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="n">DAG</span><span class="w"> </span><span class="n">Airflow</span><span class="p">,</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="n">modèle</span><span class="w"> </span><span class="n">dbt</span><span class="p">).</span><span class="w"> </span><span class="n">Les</span><span class="w"> </span><span class="o">**</span><span class="n">Runs</span><span class="o">**</span><span class="w"> </span><span class="n">représentent</span><span class="w"> </span><span class="n">les</span><span class="w"> </span><span class="n">exécutions</span><span class="w"> </span><span class="n">individuelles</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">ces</span><span class="w"> </span><span class="n">jobs</span><span class="p">.</span><span class="w"> </span><span class="n">Les</span><span class="w"> </span><span class="o">**</span><span class="n">Datasets</span><span class="o">**</span><span class="w"> </span><span class="n">représentent</span><span class="w"> </span><span class="n">les</span><span class="w"> </span><span class="n">entrées</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">sorties</span><span class="w"> </span><span class="p">(</span><span class="n">tables</span><span class="w"> </span><span class="n">Iceberg</span><span class="p">,</span><span class="w"> </span><span class="n">fichiers</span><span class="p">,</span><span class="w"> </span><span class="n">topics</span><span class="w"> </span><span class="n">Kafka</span><span class="p">).</span>
<a id="__codelineno-14-138" name="__codelineno-14-138" href="#__codelineno-14-138"></a>
<a id="__codelineno-14-139" name="__codelineno-14-139" href="#__codelineno-14-139"></a><span class="o">```</span><span class="n">python</span>
<a id="__codelineno-14-140" name="__codelineno-14-140" href="#__codelineno-14-140"></a><span class="o">#</span><span class="w"> </span><span class="n">Configuration</span><span class="w"> </span><span class="n">OpenLineage</span><span class="w"> </span><span class="n">pour</span><span class="w"> </span><span class="n">Spark</span><span class="w"> </span><span class="n">avec</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">Iceberg</span>
<a id="__codelineno-14-141" name="__codelineno-14-141" href="#__codelineno-14-141"></a><span class="k">from</span><span class="w"> </span><span class="n">pyspark</span><span class="p">.</span><span class="k">sql</span><span class="w"> </span><span class="n">import</span><span class="w"> </span><span class="n">SparkSession</span>
<a id="__codelineno-14-142" name="__codelineno-14-142" href="#__codelineno-14-142"></a>
<a id="__codelineno-14-143" name="__codelineno-14-143" href="#__codelineno-14-143"></a><span class="n">spark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SparkSession</span><span class="p">.</span><span class="n">builder</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-144" name="__codelineno-14-144" href="#__codelineno-14-144"></a><span class="w">    </span><span class="p">.</span><span class="n">appName</span><span class="p">(</span><span class="ss">&quot;Pipeline-ETL-Clients&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-145" name="__codelineno-14-145" href="#__codelineno-14-145"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.jars.packages&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-14-146" name="__codelineno-14-146" href="#__codelineno-14-146"></a><span class="w">            </span><span class="ss">&quot;io.openlineage:openlineage-spark_2.12:1.23.0&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-147" name="__codelineno-14-147" href="#__codelineno-14-147"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.extraListeners&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-14-148" name="__codelineno-14-148" href="#__codelineno-14-148"></a><span class="w">            </span><span class="ss">&quot;io.openlineage.spark.agent.OpenLineageSparkListener&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-149" name="__codelineno-14-149" href="#__codelineno-14-149"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.openlineage.transport.type&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;http&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-150" name="__codelineno-14-150" href="#__codelineno-14-150"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.openlineage.transport.url&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-14-151" name="__codelineno-14-151" href="#__codelineno-14-151"></a><span class="w">            </span><span class="ss">&quot;http://marquez.entreprise.ca:5000&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-152" name="__codelineno-14-152" href="#__codelineno-14-152"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.openlineage.namespace&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;lakehouse-production&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-153" name="__codelineno-14-153" href="#__codelineno-14-153"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.openlineage.parentJobNamespace&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;orchestration&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-154" name="__codelineno-14-154" href="#__codelineno-14-154"></a><span class="w">    </span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="ss">&quot;spark.openlineage.parentJobName&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;pipeline-clients-quotidien&quot;</span><span class="p">)</span><span class="w"> </span><span class="err">\</span>
<a id="__codelineno-14-155" name="__codelineno-14-155" href="#__codelineno-14-155"></a><span class="w">    </span><span class="p">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<a id="__codelineno-14-156" name="__codelineno-14-156" href="#__codelineno-14-156"></a>
<a id="__codelineno-14-157" name="__codelineno-14-157" href="#__codelineno-14-157"></a><span class="o">#</span><span class="w"> </span><span class="n">Exécution</span><span class="w"> </span><span class="n">d</span><span class="s1">&#39;un pipeline ETL</span>
<a id="__codelineno-14-158" name="__codelineno-14-158" href="#__codelineno-14-158"></a><span class="s1"># OpenLineage capture automatiquement les entrées, sorties et transformations</span>
<a id="__codelineno-14-159" name="__codelineno-14-159" href="#__codelineno-14-159"></a>
<a id="__codelineno-14-160" name="__codelineno-14-160" href="#__codelineno-14-160"></a><span class="s1"># Lecture depuis les sources</span>
<a id="__codelineno-14-161" name="__codelineno-14-161" href="#__codelineno-14-161"></a><span class="s1">df_transactions = spark.read \</span>
<a id="__codelineno-14-162" name="__codelineno-14-162" href="#__codelineno-14-162"></a><span class="s1">    .format(&quot;iceberg&quot;) \</span>
<a id="__codelineno-14-163" name="__codelineno-14-163" href="#__codelineno-14-163"></a><span class="s1">    .load(&quot;lakehouse.bronze.transactions_brutes&quot;)</span>
<a id="__codelineno-14-164" name="__codelineno-14-164" href="#__codelineno-14-164"></a>
<a id="__codelineno-14-165" name="__codelineno-14-165" href="#__codelineno-14-165"></a><span class="s1">df_clients = spark.read \</span>
<a id="__codelineno-14-166" name="__codelineno-14-166" href="#__codelineno-14-166"></a><span class="s1">    .format(&quot;iceberg&quot;) \</span>
<a id="__codelineno-14-167" name="__codelineno-14-167" href="#__codelineno-14-167"></a><span class="s1">    .load(&quot;lakehouse.bronze.clients_bruts&quot;)</span>
<a id="__codelineno-14-168" name="__codelineno-14-168" href="#__codelineno-14-168"></a>
<a id="__codelineno-14-169" name="__codelineno-14-169" href="#__codelineno-14-169"></a><span class="s1"># Transformations</span>
<a id="__codelineno-14-170" name="__codelineno-14-170" href="#__codelineno-14-170"></a><span class="s1">df_enrichi = df_transactions \</span>
<a id="__codelineno-14-171" name="__codelineno-14-171" href="#__codelineno-14-171"></a><span class="s1">    .join(df_clients, &quot;client_id&quot;) \</span>
<a id="__codelineno-14-172" name="__codelineno-14-172" href="#__codelineno-14-172"></a><span class="s1">    .withColumn(&quot;montant_cad&quot;, </span>
<a id="__codelineno-14-173" name="__codelineno-14-173" href="#__codelineno-14-173"></a><span class="s1">                F.when(F.col(&quot;devise&quot;) == &quot;USD&quot;, </span>
<a id="__codelineno-14-174" name="__codelineno-14-174" href="#__codelineno-14-174"></a><span class="s1">                       F.col(&quot;montant&quot;) * 1.36)</span>
<a id="__codelineno-14-175" name="__codelineno-14-175" href="#__codelineno-14-175"></a><span class="s1">                 .otherwise(F.col(&quot;montant&quot;))) \</span>
<a id="__codelineno-14-176" name="__codelineno-14-176" href="#__codelineno-14-176"></a><span class="s1">    .withColumn(&quot;date_traitement&quot;, F.current_timestamp())</span>
<a id="__codelineno-14-177" name="__codelineno-14-177" href="#__codelineno-14-177"></a>
<a id="__codelineno-14-178" name="__codelineno-14-178" href="#__codelineno-14-178"></a><span class="s1"># Écriture vers la couche Silver</span>
<a id="__codelineno-14-179" name="__codelineno-14-179" href="#__codelineno-14-179"></a><span class="s1">df_enrichi.writeTo(&quot;lakehouse.silver.transactions_enrichies&quot;) \</span>
<a id="__codelineno-14-180" name="__codelineno-14-180" href="#__codelineno-14-180"></a><span class="s1">    .using(&quot;iceberg&quot;) \</span>
<a id="__codelineno-14-181" name="__codelineno-14-181" href="#__codelineno-14-181"></a><span class="s1">    .partitionedBy(F.years(&quot;date_transaction&quot;)) \</span>
<a id="__codelineno-14-182" name="__codelineno-14-182" href="#__codelineno-14-182"></a><span class="s1">    .createOrReplace()</span>
<a id="__codelineno-14-183" name="__codelineno-14-183" href="#__codelineno-14-183"></a>
<a id="__codelineno-14-184" name="__codelineno-14-184" href="#__codelineno-14-184"></a><span class="s1"># OpenLineage émet automatiquement un événement incluant :</span>
<a id="__codelineno-14-185" name="__codelineno-14-185" href="#__codelineno-14-185"></a><span class="s1"># - Input datasets : transactions_brutes, clients_bruts</span>
<a id="__codelineno-14-186" name="__codelineno-14-186" href="#__codelineno-14-186"></a><span class="s1"># - Output dataset : transactions_enrichies</span>
<a id="__codelineno-14-187" name="__codelineno-14-187" href="#__codelineno-14-187"></a><span class="s1"># - Schema de chaque dataset</span>
<a id="__codelineno-14-188" name="__codelineno-14-188" href="#__codelineno-14-188"></a><span class="s1"># - Statistiques d&#39;</span><span class="n">exécution</span><span class="w"> </span><span class="p">(</span><span class="n">lignes</span><span class="w"> </span><span class="n">lues</span><span class="o">/</span><span class="err">é</span><span class="n">crites</span><span class="p">,</span><span class="w"> </span><span class="n">durée</span><span class="p">)</span>
<a id="__codelineno-14-189" name="__codelineno-14-189" href="#__codelineno-14-189"></a><span class="o">#</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Lignage</span><span class="w"> </span><span class="n">au</span><span class="w"> </span><span class="n">niveau</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">colonnes</span><span class="w"> </span><span class="p">(</span><span class="k">column</span><span class="o">-</span><span class="k">level</span><span class="w"> </span><span class="n">lineage</span><span class="p">)</span>
</code></pre></div>
<p><strong>Marquez</strong> constitue l'implémentation de référence pour la collecte et la visualisation des événements OpenLineage. Il fournit une API REST pour l'ingestion, une base de données pour le stockage et une interface web pour l'exploration du graphe de lignage.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Configuration Docker Compose pour Marquez avec stockage PostgreSQL</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;3.8&#39;</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="nt">services</span><span class="p">:</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">  </span><span class="nt">marquez</span><span class="p">:</span>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marquezproject/marquez:latest</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5000:5000&quot;</span><span class="w">  </span><span class="c1"># API</span>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5001:5001&quot;</span><span class="w">  </span><span class="c1"># Admin</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">      </span><span class="nt">MARQUEZ_CONFIG</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/opt/marquez/config/marquez.yml</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./marquez-config.yml:/opt/marquez/config/marquez.yml</span>
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres-marquez</span>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="w">  </span><span class="nt">marquez-web</span><span class="p">:</span>
<a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marquezproject/marquez-web:latest</span>
<a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;3000:3000&quot;</span>
<a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a><span class="w">      </span><span class="nt">MARQUEZ_HOST</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marquez</span>
<a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a><span class="w">      </span><span class="nt">MARQUEZ_PORT</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>
<a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a><span class="w">  </span><span class="nt">postgres-marquez</span><span class="p">:</span>
<a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres:14</span>
<a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a><span class="w">      </span><span class="nt">POSTGRES_USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marquez</span>
<a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a><span class="w">      </span><span class="nt">POSTGRES_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${MARQUEZ_DB_PASSWORD}</span>
<a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a><span class="w">      </span><span class="nt">POSTGRES_DB</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marquez</span>
<a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">marquez-data:/var/lib/postgresql/data</span>
<a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a>
<a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a><span class="nt">volumes</span><span class="p">:</span>
<a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a><span class="w">  </span><span class="nt">marquez-data</span><span class="p">:</span>
</code></pre></div>
<p>Le lignage au niveau des colonnes (Column-Level Lineage) représente une avancée significative d'OpenLineage. Il permet de tracer exactement quelles colonnes source ont contribué à chaque colonne de sortie, incluant les transformations appliquées.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>┌─────────────────────────────────────────────────────────────────────────┐
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>│                    LIGNAGE AU NIVEAU DES COLONNES                        │
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>├─────────────────────────────────────────────────────────────────────────┤
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>│                                                                         │
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>│  transactions_brutes                 transactions_enrichies             │
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>│  ┌────────────────────┐             ┌────────────────────────┐         │
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>│  │ transaction_id     │─────────────▶│ transaction_id        │         │
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>│  │ client_id          │──┐           │ client_id             │         │
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>│  │ montant            │──┼───────────▶│ montant_cad          │         │
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>│  │ devise             │──┘           │ date_transaction      │         │
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>│  │ date_transaction   │─────────────▶│ nom_client           │         │
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>│  └────────────────────┘              │ region_client         │         │
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>│                                      │ date_traitement       │         │
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>│  clients_bruts                       └────────────────────────┘         │
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>│  ┌────────────────────┐                       ▲                        │
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>│  │ client_id          │───────────────────────┤                        │
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>│  │ nom                │───────────────────────┤                        │
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>│  │ region             │───────────────────────┘                        │
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>│  └────────────────────┘                                                │
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>│                                                                         │
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>│  Transformations capturées :                                            │
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>│  • montant_cad = CASE WHEN devise=&#39;USD&#39; THEN montant*1.36 ELSE montant │
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>│  • date_traitement = current_timestamp()                                │
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>│  • JOIN sur client_id                                                   │
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>│                                                                         │
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>└─────────────────────────────────────────────────────────────────────────┘
</code></pre></div>
<h3 id="qualite-des-donnees">Qualité des Données<a class="headerlink" href="#qualite-des-donnees" title="Permanent link">&para;</a></h3>
<p>La gouvernance du Lakehouse inclut nécessairement la qualité des données. Les tables Iceberg peuvent contenir des milliards d'enregistrements, et détecter les anomalies de qualité devient un défi à cette échelle.</p>
<p>Plusieurs frameworks permettent d'implémenter des contrôles de qualité automatisés. <strong>Great Expectations</strong> offre une approche déclarative pour définir et valider des « attentes » sur les données. <strong>Deequ</strong> (Amazon) s'intègre nativement à Spark pour des validations performantes à grande échelle. <strong>Soda Core</strong> propose une syntaxe simple et des intégrations avec les orchestrateurs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1"># Validation de qualité avec Great Expectations sur une table Iceberg</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">great_expectations</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gx</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">great_expectations.core.batch</span><span class="w"> </span><span class="kn">import</span> <span class="n">RuntimeBatchRequest</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="c1"># Configuration du contexte</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="n">context</span> <span class="o">=</span> <span class="n">gx</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="c1"># Définition de la suite de validations</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="n">context</span><span class="o">.</span><span class="n">add_expectation_suite</span><span class="p">(</span><span class="s2">&quot;transactions_silver_suite&quot;</span><span class="p">)</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="c1"># Création des attentes</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="n">validator</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_validator</span><span class="p">(</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>    <span class="n">batch_request</span><span class="o">=</span><span class="n">RuntimeBatchRequest</span><span class="p">(</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>        <span class="n">datasource_name</span><span class="o">=</span><span class="s2">&quot;spark_iceberg&quot;</span><span class="p">,</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>        <span class="n">data_connector_name</span><span class="o">=</span><span class="s2">&quot;default_runtime_data_connector&quot;</span><span class="p">,</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>        <span class="n">data_asset_name</span><span class="o">=</span><span class="s2">&quot;transactions_enrichies&quot;</span><span class="p">,</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>        <span class="n">runtime_parameters</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;lakehouse.silver.transactions_enrichies&quot;</span><span class="p">},</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>        <span class="n">batch_identifiers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;batch_id&quot;</span><span class="p">:</span> <span class="s2">&quot;daily_2025_01_16&quot;</span><span class="p">},</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>    <span class="p">),</span>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    <span class="n">expectation_suite_name</span><span class="o">=</span><span class="s2">&quot;transactions_silver_suite&quot;</span><span class="p">,</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="p">)</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a><span class="c1"># Attentes de complétude</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="s2">&quot;transaction_id&quot;</span><span class="p">)</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_not_be_null</span><span class="p">(</span><span class="s2">&quot;montant_cad&quot;</span><span class="p">)</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a><span class="c1"># Attentes de format</span>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_match_regex</span><span class="p">(</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>    <span class="s2">&quot;client_id&quot;</span><span class="p">,</span> 
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>    <span class="n">regex</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;^C[0-9]</span><span class="si">{6}</span><span class="s2">$&quot;</span><span class="p">,</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>    <span class="n">meta</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Format client_id : C suivi de 6 chiffres&quot;</span><span class="p">}</span>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a><span class="p">)</span>
<a id="__codelineno-17-34" name="__codelineno-17-34" href="#__codelineno-17-34"></a>
<a id="__codelineno-17-35" name="__codelineno-17-35" href="#__codelineno-17-35"></a><span class="c1"># Attentes de plage</span>
<a id="__codelineno-17-36" name="__codelineno-17-36" href="#__codelineno-17-36"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_between</span><span class="p">(</span>
<a id="__codelineno-17-37" name="__codelineno-17-37" href="#__codelineno-17-37"></a>    <span class="s2">&quot;montant_cad&quot;</span><span class="p">,</span>
<a id="__codelineno-17-38" name="__codelineno-17-38" href="#__codelineno-17-38"></a>    <span class="n">min_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<a id="__codelineno-17-39" name="__codelineno-17-39" href="#__codelineno-17-39"></a>    <span class="n">max_value</span><span class="o">=</span><span class="mf">1000000.00</span><span class="p">,</span>
<a id="__codelineno-17-40" name="__codelineno-17-40" href="#__codelineno-17-40"></a>    <span class="n">meta</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Montant entre 0.01 et 1M CAD&quot;</span><span class="p">}</span>
<a id="__codelineno-17-41" name="__codelineno-17-41" href="#__codelineno-17-41"></a><span class="p">)</span>
<a id="__codelineno-17-42" name="__codelineno-17-42" href="#__codelineno-17-42"></a>
<a id="__codelineno-17-43" name="__codelineno-17-43" href="#__codelineno-17-43"></a><span class="c1"># Attentes de référentiel</span>
<a id="__codelineno-17-44" name="__codelineno-17-44" href="#__codelineno-17-44"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_in_set</span><span class="p">(</span>
<a id="__codelineno-17-45" name="__codelineno-17-45" href="#__codelineno-17-45"></a>    <span class="s2">&quot;region_client&quot;</span><span class="p">,</span>
<a id="__codelineno-17-46" name="__codelineno-17-46" href="#__codelineno-17-46"></a>    <span class="p">[</span><span class="s2">&quot;QC&quot;</span><span class="p">,</span> <span class="s2">&quot;ON&quot;</span><span class="p">,</span> <span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;SK&quot;</span><span class="p">,</span> <span class="s2">&quot;NS&quot;</span><span class="p">,</span> <span class="s2">&quot;NB&quot;</span><span class="p">,</span> <span class="s2">&quot;PE&quot;</span><span class="p">,</span> <span class="s2">&quot;NL&quot;</span><span class="p">,</span> <span class="s2">&quot;NT&quot;</span><span class="p">,</span> <span class="s2">&quot;YT&quot;</span><span class="p">,</span> <span class="s2">&quot;NU&quot;</span><span class="p">]</span>
<a id="__codelineno-17-47" name="__codelineno-17-47" href="#__codelineno-17-47"></a><span class="p">)</span>
<a id="__codelineno-17-48" name="__codelineno-17-48" href="#__codelineno-17-48"></a>
<a id="__codelineno-17-49" name="__codelineno-17-49" href="#__codelineno-17-49"></a><span class="c1"># Attentes statistiques</span>
<a id="__codelineno-17-50" name="__codelineno-17-50" href="#__codelineno-17-50"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_mean_to_be_between</span><span class="p">(</span>
<a id="__codelineno-17-51" name="__codelineno-17-51" href="#__codelineno-17-51"></a>    <span class="s2">&quot;montant_cad&quot;</span><span class="p">,</span>
<a id="__codelineno-17-52" name="__codelineno-17-52" href="#__codelineno-17-52"></a>    <span class="n">min_value</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span>
<a id="__codelineno-17-53" name="__codelineno-17-53" href="#__codelineno-17-53"></a>    <span class="n">max_value</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span>
<a id="__codelineno-17-54" name="__codelineno-17-54" href="#__codelineno-17-54"></a>    <span class="n">meta</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Montant moyen attendu entre 50 et 500 CAD&quot;</span><span class="p">}</span>
<a id="__codelineno-17-55" name="__codelineno-17-55" href="#__codelineno-17-55"></a><span class="p">)</span>
<a id="__codelineno-17-56" name="__codelineno-17-56" href="#__codelineno-17-56"></a>
<a id="__codelineno-17-57" name="__codelineno-17-57" href="#__codelineno-17-57"></a><span class="c1"># Unicité</span>
<a id="__codelineno-17-58" name="__codelineno-17-58" href="#__codelineno-17-58"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_values_to_be_unique</span><span class="p">(</span><span class="s2">&quot;transaction_id&quot;</span><span class="p">)</span>
<a id="__codelineno-17-59" name="__codelineno-17-59" href="#__codelineno-17-59"></a>
<a id="__codelineno-17-60" name="__codelineno-17-60" href="#__codelineno-17-60"></a><span class="c1"># Fraîcheur des données</span>
<a id="__codelineno-17-61" name="__codelineno-17-61" href="#__codelineno-17-61"></a><span class="n">validator</span><span class="o">.</span><span class="n">expect_column_max_to_be_between</span><span class="p">(</span>
<a id="__codelineno-17-62" name="__codelineno-17-62" href="#__codelineno-17-62"></a>    <span class="s2">&quot;date_transaction&quot;</span><span class="p">,</span>
<a id="__codelineno-17-63" name="__codelineno-17-63" href="#__codelineno-17-63"></a>    <span class="n">min_value</span><span class="o">=</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-17-64" name="__codelineno-17-64" href="#__codelineno-17-64"></a>    <span class="n">max_value</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-17-65" name="__codelineno-17-65" href="#__codelineno-17-65"></a>    <span class="n">meta</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Données datant de moins de 24h&quot;</span><span class="p">}</span>
<a id="__codelineno-17-66" name="__codelineno-17-66" href="#__codelineno-17-66"></a><span class="p">)</span>
<a id="__codelineno-17-67" name="__codelineno-17-67" href="#__codelineno-17-67"></a>
<a id="__codelineno-17-68" name="__codelineno-17-68" href="#__codelineno-17-68"></a><span class="c1"># Exécution des validations</span>
<a id="__codelineno-17-69" name="__codelineno-17-69" href="#__codelineno-17-69"></a><span class="n">results</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<a id="__codelineno-17-70" name="__codelineno-17-70" href="#__codelineno-17-70"></a>
<a id="__codelineno-17-71" name="__codelineno-17-71" href="#__codelineno-17-71"></a><span class="c1"># Intégration avec le pipeline : échec si validations critiques échouent</span>
<a id="__codelineno-17-72" name="__codelineno-17-72" href="#__codelineno-17-72"></a><span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
<a id="__codelineno-17-73" name="__codelineno-17-73" href="#__codelineno-17-73"></a>    <span class="n">critical_failures</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-17-74" name="__codelineno-17-74" href="#__codelineno-17-74"></a>        <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">results</span> 
<a id="__codelineno-17-75" name="__codelineno-17-75" href="#__codelineno-17-75"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">r</span><span class="o">.</span><span class="n">success</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">expectation_config</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;severity&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;critical&quot;</span>
<a id="__codelineno-17-76" name="__codelineno-17-76" href="#__codelineno-17-76"></a>    <span class="p">]</span>
<a id="__codelineno-17-77" name="__codelineno-17-77" href="#__codelineno-17-77"></a>    <span class="k">if</span> <span class="n">critical_failures</span><span class="p">:</span>
<a id="__codelineno-17-78" name="__codelineno-17-78" href="#__codelineno-17-78"></a>        <span class="k">raise</span> <span class="n">DataQualityException</span><span class="p">(</span>
<a id="__codelineno-17-79" name="__codelineno-17-79" href="#__codelineno-17-79"></a>            <span class="sa">f</span><span class="s2">&quot;Échec des validations critiques : </span><span class="si">{</span><span class="n">critical_failures</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-17-80" name="__codelineno-17-80" href="#__codelineno-17-80"></a>        <span class="p">)</span>
</code></pre></div>
<h3 id="catalogage-et-decouverte-des-donnees">Catalogage et Découverte des Données<a class="headerlink" href="#catalogage-et-decouverte-des-donnees" title="Permanent link">&para;</a></h3>
<p>Un catalogue de données métier complète le catalogue technique (Polaris, Glue) en ajoutant une couche de contexte métier. Il permet aux utilisateurs de découvrir les données disponibles, comprendre leur signification et identifier les propriétaires.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1">-- Structure de métadonnées métier dans le Lakehouse</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="c1">-- Table de documentation des assets de données</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">catalogue_metier</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="n">asset_id</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">    </span><span class="n">asset_type</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TABLE, VIEW, MODEL, DASHBOARD</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">    </span><span class="n">chemin_technique</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- lakehouse.silver.transactions</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">    </span><span class="n">nom_metier</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">    </span><span class="n">description</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">    </span><span class="n">domaine_metier</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Finance, Marketing, Operations</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">    </span><span class="n">proprietaire_courriel</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">    </span><span class="n">intendant_donnees_courriel</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">    </span><span class="n">classification_donnees</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- PUBLIC, INTERNE, CONFIDENTIEL, RESTREINT</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">    </span><span class="n">contient_pii</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">    </span><span class="n">contient_donnees_financieres</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">    </span><span class="n">retention_jours</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">    </span><span class="n">reglementation_applicable</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;</span><span class="p">,</span><span class="w">  </span><span class="c1">-- [&#39;LOI25&#39;, &#39;LPRPDE&#39;, &#39;SOX&#39;]</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">    </span><span class="n">termes_glossaire</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;</span><span class="p">,</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">    </span><span class="n">tags</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;</span><span class="p">,</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">    </span><span class="n">date_creation</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a><span class="w">    </span><span class="n">date_derniere_modification</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="w">    </span><span class="n">frequence_mise_a_jour</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TEMPS_REEL, QUOTIDIEN, HEBDOMADAIRE</span>
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="w">    </span><span class="n">documentation_url</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a><span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">iceberg</span>
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a><span class="n">PARTITIONED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">(</span><span class="n">domaine_metier</span><span class="p">);</span>
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a><span class="c1">-- Exemple d&#39;entrée de catalogue</span>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">catalogue_metier</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a><span class="w">    </span><span class="s1">&#39;asset_001&#39;</span><span class="p">,</span>
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a><span class="w">    </span><span class="s1">&#39;TABLE&#39;</span><span class="p">,</span>
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a><span class="w">    </span><span class="s1">&#39;lakehouse.silver.transactions_enrichies&#39;</span><span class="p">,</span>
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a><span class="w">    </span><span class="s1">&#39;Transactions Clients Enrichies&#39;</span><span class="p">,</span>
<a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a><span class="w">    </span><span class="s1">&#39;Table consolidée des transactions clients avec enrichissement démographique et conversion de devise. Source de vérité pour les rapports financiers et analyses marketing.&#39;</span><span class="p">,</span>
<a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a><span class="w">    </span><span class="s1">&#39;Finance&#39;</span><span class="p">,</span>
<a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a><span class="w">    </span><span class="s1">&#39;marie.tremblay@entreprise.ca&#39;</span><span class="p">,</span>
<a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a><span class="w">    </span><span class="s1">&#39;jean.gagnon@entreprise.ca&#39;</span><span class="p">,</span>
<a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a><span class="w">    </span><span class="s1">&#39;CONFIDENTIEL&#39;</span><span class="p">,</span>
<a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span>
<a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span>
<a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a><span class="w">    </span><span class="mi">2555</span><span class="p">,</span><span class="w">  </span><span class="c1">-- 7 ans pour conformité SOX</span>
<a id="__codelineno-18-41" name="__codelineno-18-41" href="#__codelineno-18-41"></a><span class="w">    </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;LOI25&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LPRPDE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SOX&#39;</span><span class="p">),</span>
<a id="__codelineno-18-42" name="__codelineno-18-42" href="#__codelineno-18-42"></a><span class="w">    </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;transaction&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;montant&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;chiffre_affaires&#39;</span><span class="p">),</span>
<a id="__codelineno-18-43" name="__codelineno-18-43" href="#__codelineno-18-43"></a><span class="w">    </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;finance&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;analytique&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;certifie&#39;</span><span class="p">),</span>
<a id="__codelineno-18-44" name="__codelineno-18-44" href="#__codelineno-18-44"></a><span class="w">    </span><span class="k">current_timestamp</span><span class="p">(),</span>
<a id="__codelineno-18-45" name="__codelineno-18-45" href="#__codelineno-18-45"></a><span class="w">    </span><span class="k">current_timestamp</span><span class="p">(),</span>
<a id="__codelineno-18-46" name="__codelineno-18-46" href="#__codelineno-18-46"></a><span class="w">    </span><span class="s1">&#39;QUOTIDIEN&#39;</span><span class="p">,</span>
<a id="__codelineno-18-47" name="__codelineno-18-47" href="#__codelineno-18-47"></a><span class="w">    </span><span class="s1">&#39;https://wiki.entreprise.ca/donnees/transactions-enrichies&#39;</span>
<a id="__codelineno-18-48" name="__codelineno-18-48" href="#__codelineno-18-48"></a><span class="p">);</span>
</code></pre></div>
<hr />
<h2 id="iv134-conformite-reglementaire-au-canada">IV.13.4 Conformité Réglementaire au Canada<a class="headerlink" href="#iv134-conformite-reglementaire-au-canada" title="Permanent link">&para;</a></h2>
<h3 id="la-loi-25-du-quebec">La Loi 25 du Québec<a class="headerlink" href="#la-loi-25-du-quebec" title="Permanent link">&para;</a></h3>
<p>La Loi 25 (anciennement Projet de loi 64), pleinement en vigueur depuis septembre 2024, constitue le cadre de protection des renseignements personnels le plus strict au Canada. Elle s'aligne sur le RGPD européen et impose des obligations significatives aux organisations qui traitent des données de résidents québécois.</p>
<p>Les principales exigences de la Loi 25 avec impact sur l'architecture Lakehouse incluent :</p>
<p><strong>Le consentement explicite</strong> pour la collecte et l'utilisation des renseignements personnels. Le Lakehouse doit pouvoir démontrer que le consentement a été obtenu et enregistrer les préférences de chaque individu.</p>
<p><strong>Le droit à l'effacement</strong> (droit à l'oubli) permet aux individus de demander la suppression de leurs données. Cette exigence entre en tension directe avec l'immutabilité naturelle d'un Lakehouse, où le time travel conserve l'historique des données.</p>
<p><strong>Le droit à la portabilité</strong> oblige les organisations à fournir les données personnelles dans un format structuré et couramment utilisé. Le Lakehouse doit pouvoir extraire et formater les données d'un individu spécifique.</p>
<p><strong>L'évaluation des facteurs relatifs à la vie privée (EFVP)</strong> est obligatoire pour tout projet impliquant des renseignements personnels. L'architecture du Lakehouse elle-même doit faire l'objet d'une EFVP.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Implémentation du droit à l&#39;effacement conforme à la Loi 25</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="nd">@dataclass</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">DemandeEffacement</span><span class="p">:</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Représente une demande d&#39;effacement Loi 25.&quot;&quot;&quot;</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>    <span class="n">demande_id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>    <span class="n">identifiant_personne</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Courriel, NAS, ou autre identifiant</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>    <span class="n">type_identifiant</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>    <span class="n">date_demande</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    <span class="n">tables_a_traiter</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>    <span class="n">demandeur_courriel</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>    <span class="n">motif</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>    <span class="n">statut</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;EN_ATTENTE&quot;</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="k">class</span><span class="w"> </span><span class="nc">GestionnaireDroitEffacementLoi25</span><span class="p">:</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="sd">    Gestionnaire des demandes d&#39;effacement conformes à la Loi 25.</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="sd">    Responsabilités :</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="sd">    - Traiter les demandes d&#39;effacement dans le délai légal (30 jours)</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="sd">    - Supprimer les données des tables Iceberg</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="sd">    - Expirer les snapshots contenant les données supprimées</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a><span class="sd">    - Produire les tombstones Kafka pour la propagation</span>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a><span class="sd">    - Générer le certificat de suppression pour audit</span>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">,</span> <span class="n">kafka_producer</span><span class="p">,</span> 
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a>                 <span class="n">iceberg_catalog</span><span class="p">,</span> <span class="n">journal_audit</span><span class="p">):</span>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spark</span> <span class="o">=</span> <span class="n">spark_session</span>
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">producer</span> <span class="o">=</span> <span class="n">kafka_producer</span>
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">iceberg_catalog</span>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">audit</span> <span class="o">=</span> <span class="n">journal_audit</span>
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a>
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">traiter_demande</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">demande</span><span class="p">:</span> <span class="n">DemandeEffacement</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a><span class="sd">        Traite une demande d&#39;effacement de bout en bout.</span>
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a>
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a><span class="sd">        Étapes :</span>
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a><span class="sd">        1. Validation et journalisation de la demande</span>
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a><span class="sd">        2. Identification des données à supprimer</span>
<a id="__codelineno-19-46" name="__codelineno-19-46" href="#__codelineno-19-46"></a><span class="sd">        3. Suppression des tables Iceberg (DELETE)</span>
<a id="__codelineno-19-47" name="__codelineno-19-47" href="#__codelineno-19-47"></a><span class="sd">        4. Expiration des snapshots historiques</span>
<a id="__codelineno-19-48" name="__codelineno-19-48" href="#__codelineno-19-48"></a><span class="sd">        5. Production des tombstones Kafka</span>
<a id="__codelineno-19-49" name="__codelineno-19-49" href="#__codelineno-19-49"></a><span class="sd">        6. Génération du certificat de conformité</span>
<a id="__codelineno-19-50" name="__codelineno-19-50" href="#__codelineno-19-50"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-19-51" name="__codelineno-19-51" href="#__codelineno-19-51"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Traitement demande effacement: </span><span class="si">{</span><span class="n">demande</span><span class="o">.</span><span class="n">demande_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-52" name="__codelineno-19-52" href="#__codelineno-19-52"></a>
<a id="__codelineno-19-53" name="__codelineno-19-53" href="#__codelineno-19-53"></a>        <span class="c1"># 1. Journaliser la demande pour audit</span>
<a id="__codelineno-19-54" name="__codelineno-19-54" href="#__codelineno-19-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">audit</span><span class="o">.</span><span class="n">journaliser_demande_effacement</span><span class="p">(</span>
<a id="__codelineno-19-55" name="__codelineno-19-55" href="#__codelineno-19-55"></a>            <span class="n">demande_id</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">demande_id</span><span class="p">,</span>
<a id="__codelineno-19-56" name="__codelineno-19-56" href="#__codelineno-19-56"></a>            <span class="n">identifiant</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">identifiant_personne</span><span class="p">,</span>
<a id="__codelineno-19-57" name="__codelineno-19-57" href="#__codelineno-19-57"></a>            <span class="n">type_identifiant</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">type_identifiant</span><span class="p">,</span>
<a id="__codelineno-19-58" name="__codelineno-19-58" href="#__codelineno-19-58"></a>            <span class="n">date_demande</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">date_demande</span><span class="p">,</span>
<a id="__codelineno-19-59" name="__codelineno-19-59" href="#__codelineno-19-59"></a>            <span class="n">demandeur</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">demandeur_courriel</span>
<a id="__codelineno-19-60" name="__codelineno-19-60" href="#__codelineno-19-60"></a>        <span class="p">)</span>
<a id="__codelineno-19-61" name="__codelineno-19-61" href="#__codelineno-19-61"></a>
<a id="__codelineno-19-62" name="__codelineno-19-62" href="#__codelineno-19-62"></a>        <span class="n">resultats</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-19-63" name="__codelineno-19-63" href="#__codelineno-19-63"></a>
<a id="__codelineno-19-64" name="__codelineno-19-64" href="#__codelineno-19-64"></a>        <span class="c1"># 2-3. Pour chaque table, supprimer les données</span>
<a id="__codelineno-19-65" name="__codelineno-19-65" href="#__codelineno-19-65"></a>        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">demande</span><span class="o">.</span><span class="n">tables_a_traiter</span><span class="p">:</span>
<a id="__codelineno-19-66" name="__codelineno-19-66" href="#__codelineno-19-66"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-19-67" name="__codelineno-19-67" href="#__codelineno-19-67"></a>                <span class="c1"># Identifier la colonne correspondant à l&#39;identifiant</span>
<a id="__codelineno-19-68" name="__codelineno-19-68" href="#__codelineno-19-68"></a>                <span class="n">colonne_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obtenir_colonne_identifiant</span><span class="p">(</span>
<a id="__codelineno-19-69" name="__codelineno-19-69" href="#__codelineno-19-69"></a>                    <span class="n">table_name</span><span class="p">,</span> 
<a id="__codelineno-19-70" name="__codelineno-19-70" href="#__codelineno-19-70"></a>                    <span class="n">demande</span><span class="o">.</span><span class="n">type_identifiant</span>
<a id="__codelineno-19-71" name="__codelineno-19-71" href="#__codelineno-19-71"></a>                <span class="p">)</span>
<a id="__codelineno-19-72" name="__codelineno-19-72" href="#__codelineno-19-72"></a>
<a id="__codelineno-19-73" name="__codelineno-19-73" href="#__codelineno-19-73"></a>                <span class="c1"># Compter les lignes avant suppression (pour audit)</span>
<a id="__codelineno-19-74" name="__codelineno-19-74" href="#__codelineno-19-74"></a>                <span class="n">count_avant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compter_lignes</span><span class="p">(</span>
<a id="__codelineno-19-75" name="__codelineno-19-75" href="#__codelineno-19-75"></a>                    <span class="n">table_name</span><span class="p">,</span> <span class="n">colonne_id</span><span class="p">,</span> <span class="n">demande</span><span class="o">.</span><span class="n">identifiant_personne</span>
<a id="__codelineno-19-76" name="__codelineno-19-76" href="#__codelineno-19-76"></a>                <span class="p">)</span>
<a id="__codelineno-19-77" name="__codelineno-19-77" href="#__codelineno-19-77"></a>
<a id="__codelineno-19-78" name="__codelineno-19-78" href="#__codelineno-19-78"></a>                <span class="c1"># Exécuter la suppression via Spark SQL</span>
<a id="__codelineno-19-79" name="__codelineno-19-79" href="#__codelineno-19-79"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-19-80" name="__codelineno-19-80" href="#__codelineno-19-80"></a><span class="s2">                    DELETE FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span>
<a id="__codelineno-19-81" name="__codelineno-19-81" href="#__codelineno-19-81"></a><span class="s2">                    WHERE </span><span class="si">{</span><span class="n">colonne_id</span><span class="si">}</span><span class="s2"> = &#39;</span><span class="si">{</span><span class="n">demande</span><span class="o">.</span><span class="n">identifiant_personne</span><span class="si">}</span><span class="s2">&#39;</span>
<a id="__codelineno-19-82" name="__codelineno-19-82" href="#__codelineno-19-82"></a><span class="s2">                &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-19-83" name="__codelineno-19-83" href="#__codelineno-19-83"></a>
<a id="__codelineno-19-84" name="__codelineno-19-84" href="#__codelineno-19-84"></a>                <span class="c1"># Vérifier la suppression</span>
<a id="__codelineno-19-85" name="__codelineno-19-85" href="#__codelineno-19-85"></a>                <span class="n">count_apres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compter_lignes</span><span class="p">(</span>
<a id="__codelineno-19-86" name="__codelineno-19-86" href="#__codelineno-19-86"></a>                    <span class="n">table_name</span><span class="p">,</span> <span class="n">colonne_id</span><span class="p">,</span> <span class="n">demande</span><span class="o">.</span><span class="n">identifiant_personne</span>
<a id="__codelineno-19-87" name="__codelineno-19-87" href="#__codelineno-19-87"></a>                <span class="p">)</span>
<a id="__codelineno-19-88" name="__codelineno-19-88" href="#__codelineno-19-88"></a>
<a id="__codelineno-19-89" name="__codelineno-19-89" href="#__codelineno-19-89"></a>                <span class="n">resultats</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-19-90" name="__codelineno-19-90" href="#__codelineno-19-90"></a>                    <span class="s1">&#39;lignes_supprimees&#39;</span><span class="p">:</span> <span class="n">count_avant</span> <span class="o">-</span> <span class="n">count_apres</span><span class="p">,</span>
<a id="__codelineno-19-91" name="__codelineno-19-91" href="#__codelineno-19-91"></a>                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-19-92" name="__codelineno-19-92" href="#__codelineno-19-92"></a>                    <span class="s1">&#39;statut&#39;</span><span class="p">:</span> <span class="s1">&#39;SUCCES&#39;</span> <span class="k">if</span> <span class="n">count_apres</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;PARTIEL&#39;</span>
<a id="__codelineno-19-93" name="__codelineno-19-93" href="#__codelineno-19-93"></a>                <span class="p">}</span>
<a id="__codelineno-19-94" name="__codelineno-19-94" href="#__codelineno-19-94"></a>
<a id="__codelineno-19-95" name="__codelineno-19-95" href="#__codelineno-19-95"></a>                <span class="c1"># Journaliser pour audit</span>
<a id="__codelineno-19-96" name="__codelineno-19-96" href="#__codelineno-19-96"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">audit</span><span class="o">.</span><span class="n">journaliser_suppression_table</span><span class="p">(</span>
<a id="__codelineno-19-97" name="__codelineno-19-97" href="#__codelineno-19-97"></a>                    <span class="n">demande_id</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">demande_id</span><span class="p">,</span>
<a id="__codelineno-19-98" name="__codelineno-19-98" href="#__codelineno-19-98"></a>                    <span class="n">table</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
<a id="__codelineno-19-99" name="__codelineno-19-99" href="#__codelineno-19-99"></a>                    <span class="n">lignes_supprimees</span><span class="o">=</span><span class="n">count_avant</span> <span class="o">-</span> <span class="n">count_apres</span>
<a id="__codelineno-19-100" name="__codelineno-19-100" href="#__codelineno-19-100"></a>                <span class="p">)</span>
<a id="__codelineno-19-101" name="__codelineno-19-101" href="#__codelineno-19-101"></a>
<a id="__codelineno-19-102" name="__codelineno-19-102" href="#__codelineno-19-102"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-19-103" name="__codelineno-19-103" href="#__codelineno-19-103"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Erreur suppression </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-19-104" name="__codelineno-19-104" href="#__codelineno-19-104"></a>                <span class="n">resultats</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-19-105" name="__codelineno-19-105" href="#__codelineno-19-105"></a>                    <span class="s1">&#39;erreur&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
<a id="__codelineno-19-106" name="__codelineno-19-106" href="#__codelineno-19-106"></a>                    <span class="s1">&#39;statut&#39;</span><span class="p">:</span> <span class="s1">&#39;ECHEC&#39;</span>
<a id="__codelineno-19-107" name="__codelineno-19-107" href="#__codelineno-19-107"></a>                <span class="p">}</span>
<a id="__codelineno-19-108" name="__codelineno-19-108" href="#__codelineno-19-108"></a>
<a id="__codelineno-19-109" name="__codelineno-19-109" href="#__codelineno-19-109"></a>        <span class="c1"># 4. Expirer les snapshots historiques contenant les données</span>
<a id="__codelineno-19-110" name="__codelineno-19-110" href="#__codelineno-19-110"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_expirer_snapshots_historiques</span><span class="p">(</span><span class="n">demande</span><span class="o">.</span><span class="n">tables_a_traiter</span><span class="p">)</span>
<a id="__codelineno-19-111" name="__codelineno-19-111" href="#__codelineno-19-111"></a>
<a id="__codelineno-19-112" name="__codelineno-19-112" href="#__codelineno-19-112"></a>        <span class="c1"># 5. Produire les tombstones Kafka pour propagation</span>
<a id="__codelineno-19-113" name="__codelineno-19-113" href="#__codelineno-19-113"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_produire_tombstones</span><span class="p">(</span>
<a id="__codelineno-19-114" name="__codelineno-19-114" href="#__codelineno-19-114"></a>            <span class="n">identifiant</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">identifiant_personne</span><span class="p">,</span>
<a id="__codelineno-19-115" name="__codelineno-19-115" href="#__codelineno-19-115"></a>            <span class="n">type_identifiant</span><span class="o">=</span><span class="n">demande</span><span class="o">.</span><span class="n">type_identifiant</span>
<a id="__codelineno-19-116" name="__codelineno-19-116" href="#__codelineno-19-116"></a>        <span class="p">)</span>
<a id="__codelineno-19-117" name="__codelineno-19-117" href="#__codelineno-19-117"></a>
<a id="__codelineno-19-118" name="__codelineno-19-118" href="#__codelineno-19-118"></a>        <span class="c1"># 6. Générer le certificat de suppression</span>
<a id="__codelineno-19-119" name="__codelineno-19-119" href="#__codelineno-19-119"></a>        <span class="n">certificat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generer_certificat</span><span class="p">(</span><span class="n">demande</span><span class="p">,</span> <span class="n">resultats</span><span class="p">)</span>
<a id="__codelineno-19-120" name="__codelineno-19-120" href="#__codelineno-19-120"></a>
<a id="__codelineno-19-121" name="__codelineno-19-121" href="#__codelineno-19-121"></a>        <span class="k">return</span> <span class="n">certificat</span>
<a id="__codelineno-19-122" name="__codelineno-19-122" href="#__codelineno-19-122"></a>
<a id="__codelineno-19-123" name="__codelineno-19-123" href="#__codelineno-19-123"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_expirer_snapshots_historiques</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-19-124" name="__codelineno-19-124" href="#__codelineno-19-124"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-125" name="__codelineno-19-125" href="#__codelineno-19-125"></a><span class="sd">        Expire les snapshots Iceberg pour garantir que les données</span>
<a id="__codelineno-19-126" name="__codelineno-19-126" href="#__codelineno-19-126"></a><span class="sd">        supprimées ne sont plus accessibles via time travel.</span>
<a id="__codelineno-19-127" name="__codelineno-19-127" href="#__codelineno-19-127"></a>
<a id="__codelineno-19-128" name="__codelineno-19-128" href="#__codelineno-19-128"></a><span class="sd">        Note : Cette opération doit être planifiée avec soin car</span>
<a id="__codelineno-19-129" name="__codelineno-19-129" href="#__codelineno-19-129"></a><span class="sd">        elle est irréversible et affecte la capacité de rollback.</span>
<a id="__codelineno-19-130" name="__codelineno-19-130" href="#__codelineno-19-130"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-19-131" name="__codelineno-19-131" href="#__codelineno-19-131"></a>        <span class="k">for</span> <span class="n">table_name</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
<a id="__codelineno-19-132" name="__codelineno-19-132" href="#__codelineno-19-132"></a>            <span class="c1"># Expirer tous les snapshots antérieurs à maintenant</span>
<a id="__codelineno-19-133" name="__codelineno-19-133" href="#__codelineno-19-133"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-19-134" name="__codelineno-19-134" href="#__codelineno-19-134"></a><span class="s2">                CALL system.expire_snapshots(</span>
<a id="__codelineno-19-135" name="__codelineno-19-135" href="#__codelineno-19-135"></a><span class="s2">                    table =&gt; &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;,</span>
<a id="__codelineno-19-136" name="__codelineno-19-136" href="#__codelineno-19-136"></a><span class="s2">                    older_than =&gt; TIMESTAMP &#39;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;,</span>
<a id="__codelineno-19-137" name="__codelineno-19-137" href="#__codelineno-19-137"></a><span class="s2">                    retain_last =&gt; 1</span>
<a id="__codelineno-19-138" name="__codelineno-19-138" href="#__codelineno-19-138"></a><span class="s2">                )</span>
<a id="__codelineno-19-139" name="__codelineno-19-139" href="#__codelineno-19-139"></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-19-140" name="__codelineno-19-140" href="#__codelineno-19-140"></a>
<a id="__codelineno-19-141" name="__codelineno-19-141" href="#__codelineno-19-141"></a>            <span class="c1"># Nettoyer les fichiers orphelins</span>
<a id="__codelineno-19-142" name="__codelineno-19-142" href="#__codelineno-19-142"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-19-143" name="__codelineno-19-143" href="#__codelineno-19-143"></a><span class="s2">                CALL system.remove_orphan_files(</span>
<a id="__codelineno-19-144" name="__codelineno-19-144" href="#__codelineno-19-144"></a><span class="s2">                    table =&gt; &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;</span>
<a id="__codelineno-19-145" name="__codelineno-19-145" href="#__codelineno-19-145"></a><span class="s2">                )</span>
<a id="__codelineno-19-146" name="__codelineno-19-146" href="#__codelineno-19-146"></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-19-147" name="__codelineno-19-147" href="#__codelineno-19-147"></a>
<a id="__codelineno-19-148" name="__codelineno-19-148" href="#__codelineno-19-148"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_produire_tombstones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifiant</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
<a id="__codelineno-19-149" name="__codelineno-19-149" href="#__codelineno-19-149"></a>                             <span class="n">type_identifiant</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-19-150" name="__codelineno-19-150" href="#__codelineno-19-150"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-151" name="__codelineno-19-151" href="#__codelineno-19-151"></a><span class="sd">        Produit des tombstones Kafka pour les topics contenant</span>
<a id="__codelineno-19-152" name="__codelineno-19-152" href="#__codelineno-19-152"></a><span class="sd">        potentiellement les données de la personne concernée.</span>
<a id="__codelineno-19-153" name="__codelineno-19-153" href="#__codelineno-19-153"></a>
<a id="__codelineno-19-154" name="__codelineno-19-154" href="#__codelineno-19-154"></a><span class="sd">        Un tombstone (message avec valeur null) permet la compaction</span>
<a id="__codelineno-19-155" name="__codelineno-19-155" href="#__codelineno-19-155"></a><span class="sd">        du log Kafka pour supprimer les données historiques.</span>
<a id="__codelineno-19-156" name="__codelineno-19-156" href="#__codelineno-19-156"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-19-157" name="__codelineno-19-157" href="#__codelineno-19-157"></a>        <span class="n">topics_affectes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identifier_topics_affectes</span><span class="p">(</span><span class="n">type_identifiant</span><span class="p">)</span>
<a id="__codelineno-19-158" name="__codelineno-19-158" href="#__codelineno-19-158"></a>
<a id="__codelineno-19-159" name="__codelineno-19-159" href="#__codelineno-19-159"></a>        <span class="k">for</span> <span class="n">topic</span> <span class="ow">in</span> <span class="n">topics_affectes</span><span class="p">:</span>
<a id="__codelineno-19-160" name="__codelineno-19-160" href="#__codelineno-19-160"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">send</span><span class="p">(</span>
<a id="__codelineno-19-161" name="__codelineno-19-161" href="#__codelineno-19-161"></a>                <span class="n">topic</span><span class="o">=</span><span class="n">topic</span><span class="p">,</span>
<a id="__codelineno-19-162" name="__codelineno-19-162" href="#__codelineno-19-162"></a>                <span class="n">key</span><span class="o">=</span><span class="n">identifiant</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span>
<a id="__codelineno-19-163" name="__codelineno-19-163" href="#__codelineno-19-163"></a>                <span class="n">value</span><span class="o">=</span><span class="kc">None</span>  <span class="c1"># Tombstone</span>
<a id="__codelineno-19-164" name="__codelineno-19-164" href="#__codelineno-19-164"></a>            <span class="p">)</span>
<a id="__codelineno-19-165" name="__codelineno-19-165" href="#__codelineno-19-165"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">producer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<a id="__codelineno-19-166" name="__codelineno-19-166" href="#__codelineno-19-166"></a>
<a id="__codelineno-19-167" name="__codelineno-19-167" href="#__codelineno-19-167"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_generer_certificat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">demande</span><span class="p">:</span> <span class="n">DemandeEffacement</span><span class="p">,</span>
<a id="__codelineno-19-168" name="__codelineno-19-168" href="#__codelineno-19-168"></a>                            <span class="n">resultats</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<a id="__codelineno-19-169" name="__codelineno-19-169" href="#__codelineno-19-169"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-170" name="__codelineno-19-170" href="#__codelineno-19-170"></a><span class="sd">        Génère un certificat de suppression attestant de l&#39;exécution</span>
<a id="__codelineno-19-171" name="__codelineno-19-171" href="#__codelineno-19-171"></a><span class="sd">        de la demande d&#39;effacement, requis pour audit Loi 25.</span>
<a id="__codelineno-19-172" name="__codelineno-19-172" href="#__codelineno-19-172"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-19-173" name="__codelineno-19-173" href="#__codelineno-19-173"></a>        <span class="n">certificat</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-19-174" name="__codelineno-19-174" href="#__codelineno-19-174"></a>            <span class="s1">&#39;certificat_id&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;CERT-</span><span class="si">{</span><span class="n">demande</span><span class="o">.</span><span class="n">demande_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-19-175" name="__codelineno-19-175" href="#__codelineno-19-175"></a>            <span class="s1">&#39;demande_id&#39;</span><span class="p">:</span> <span class="n">demande</span><span class="o">.</span><span class="n">demande_id</span><span class="p">,</span>
<a id="__codelineno-19-176" name="__codelineno-19-176" href="#__codelineno-19-176"></a>            <span class="s1">&#39;date_traitement&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-19-177" name="__codelineno-19-177" href="#__codelineno-19-177"></a>            <span class="s1">&#39;identifiant_personne_hash&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hasher_identifiant</span><span class="p">(</span>
<a id="__codelineno-19-178" name="__codelineno-19-178" href="#__codelineno-19-178"></a>                <span class="n">demande</span><span class="o">.</span><span class="n">identifiant_personne</span>
<a id="__codelineno-19-179" name="__codelineno-19-179" href="#__codelineno-19-179"></a>            <span class="p">),</span>
<a id="__codelineno-19-180" name="__codelineno-19-180" href="#__codelineno-19-180"></a>            <span class="s1">&#39;resultats_par_table&#39;</span><span class="p">:</span> <span class="n">resultats</span><span class="p">,</span>
<a id="__codelineno-19-181" name="__codelineno-19-181" href="#__codelineno-19-181"></a>            <span class="s1">&#39;snapshots_expires&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-19-182" name="__codelineno-19-182" href="#__codelineno-19-182"></a>            <span class="s1">&#39;tombstones_produits&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-19-183" name="__codelineno-19-183" href="#__codelineno-19-183"></a>            <span class="s1">&#39;conformite_loi25&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-19-184" name="__codelineno-19-184" href="#__codelineno-19-184"></a>            <span class="s1">&#39;delai_traitement_jours&#39;</span><span class="p">:</span> <span class="p">(</span>
<a id="__codelineno-19-185" name="__codelineno-19-185" href="#__codelineno-19-185"></a>                <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">-</span> <span class="n">demande</span><span class="o">.</span><span class="n">date_demande</span>
<a id="__codelineno-19-186" name="__codelineno-19-186" href="#__codelineno-19-186"></a>            <span class="p">)</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-19-187" name="__codelineno-19-187" href="#__codelineno-19-187"></a>        <span class="p">}</span>
<a id="__codelineno-19-188" name="__codelineno-19-188" href="#__codelineno-19-188"></a>
<a id="__codelineno-19-189" name="__codelineno-19-189" href="#__codelineno-19-189"></a>        <span class="c1"># Vérification du délai légal (30 jours)</span>
<a id="__codelineno-19-190" name="__codelineno-19-190" href="#__codelineno-19-190"></a>        <span class="k">if</span> <span class="n">certificat</span><span class="p">[</span><span class="s1">&#39;delai_traitement_jours&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>
<a id="__codelineno-19-191" name="__codelineno-19-191" href="#__codelineno-19-191"></a>            <span class="n">certificat</span><span class="p">[</span><span class="s1">&#39;alerte_delai&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DEPASSEMENT_DELAI_LEGAL&quot;</span>
<a id="__codelineno-19-192" name="__codelineno-19-192" href="#__codelineno-19-192"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
<a id="__codelineno-19-193" name="__codelineno-19-193" href="#__codelineno-19-193"></a>                <span class="sa">f</span><span class="s2">&quot;Demande </span><span class="si">{</span><span class="n">demande</span><span class="o">.</span><span class="n">demande_id</span><span class="si">}</span><span class="s2"> traitée hors délai légal&quot;</span>
<a id="__codelineno-19-194" name="__codelineno-19-194" href="#__codelineno-19-194"></a>            <span class="p">)</span>
<a id="__codelineno-19-195" name="__codelineno-19-195" href="#__codelineno-19-195"></a>
<a id="__codelineno-19-196" name="__codelineno-19-196" href="#__codelineno-19-196"></a>        <span class="c1"># Stocker le certificat pour audit</span>
<a id="__codelineno-19-197" name="__codelineno-19-197" href="#__codelineno-19-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">audit</span><span class="o">.</span><span class="n">stocker_certificat</span><span class="p">(</span><span class="n">certificat</span><span class="p">)</span>
<a id="__codelineno-19-198" name="__codelineno-19-198" href="#__codelineno-19-198"></a>
<a id="__codelineno-19-199" name="__codelineno-19-199" href="#__codelineno-19-199"></a>        <span class="k">return</span> <span class="n">certificat</span>
</code></pre></div>
<h3 id="la-lprpde-federale">La LPRPDE Fédérale<a class="headerlink" href="#la-lprpde-federale" title="Permanent link">&para;</a></h3>
<p>La Loi sur la protection des renseignements personnels et les documents électroniques (LPRPDE) s'applique aux organisations du secteur privé dans tout le Canada pour les activités commerciales. Bien que moins stricte que la Loi 25, elle établit des principes fondamentaux que le Lakehouse doit respecter.</p>
<p>Les dix principes de la LPRPDE se traduisent en exigences architecturales :</p>
<table>
<thead>
<tr>
<th>Principe LPRPDE</th>
<th>Implication pour le Lakehouse</th>
</tr>
</thead>
<tbody>
<tr>
<td>Responsabilité</td>
<td>Désignation d'un responsable, documentation des politiques</td>
</tr>
<tr>
<td>Détermination des fins</td>
<td>Métadonnées documentant la finalité de chaque dataset</td>
</tr>
<tr>
<td>Consentement</td>
<td>Enregistrement des consentements, respect des préférences</td>
</tr>
<tr>
<td>Limitation de la collecte</td>
<td>Contrôles limitant les données collectées au nécessaire</td>
</tr>
<tr>
<td>Limitation de l'utilisation</td>
<td>Contrôles d'accès basés sur la finalité déclarée</td>
</tr>
<tr>
<td>Exactitude</td>
<td>Processus de validation et correction des données</td>
</tr>
<tr>
<td>Mesures de sécurité</td>
<td>Chiffrement, contrôles d'accès, surveillance</td>
</tr>
<tr>
<td>Transparence</td>
<td>Catalogue accessible documentant les données détenues</td>
</tr>
<tr>
<td>Accès individuel</td>
<td>Mécanismes d'extraction des données personnelles</td>
</tr>
<tr>
<td>Possibilité de porter plainte</td>
<td>Processus de gestion des demandes et plaintes</td>
</tr>
</tbody>
</table>
<h3 id="conformite-sectorielle-bsif-sox">Conformité Sectorielle (BSIF, SOX)<a class="headerlink" href="#conformite-sectorielle-bsif-sox" title="Permanent link">&para;</a></h3>
<p>Les organisations dans des secteurs réglementés font face à des exigences supplémentaires. Le Bureau du surintendant des institutions financières (BSIF) impose aux banques et assureurs canadiens des directives strictes en matière de gestion des risques technologiques et de résilience opérationnelle.</p>
<p><strong>La directive B-13 (Gestion du risque lié aux technologies et du cyberrisque)</strong> exige notamment l'inventaire complet des actifs de données, la classification selon leur criticité, et des contrôles d'accès proportionnés aux risques.</p>
<p><strong>La ligne directrice E-21 (Gestion du risque lié aux tiers)</strong> s'applique lorsque le Lakehouse utilise des services infonuagiques de tiers (AWS, Azure, GCP, Confluent). Elle exige une diligence raisonnable, des clauses contractuelles appropriées et une surveillance continue.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1">-- Structure de classification des données pour conformité BSIF</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">classification_bsif</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="n">table_id</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span><span class="n">chemin_table</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="n">classification_criticite</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- CRITIQUE, IMPORTANT, STANDARD</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span><span class="n">classification_sensibilite</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- TRES_ELEVE, ELEVE, MOYEN, FAIBLE</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">    </span><span class="n">proprietaire_metier</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">    </span><span class="n">gardien_technique</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">    </span><span class="c1">-- Exigences de protection basées sur classification</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">    </span><span class="n">chiffrement_requis</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">    </span><span class="n">masquage_requis</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">    </span><span class="n">retention_minimale_jours</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="n">retention_maximale_jours</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">    </span><span class="c1">-- Contrôles d&#39;accès</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">    </span><span class="n">acces_restreint_equipes</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;</span><span class="p">,</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">    </span><span class="n">approbation_requise</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">    </span><span class="n">niveau_approbation</span><span class="w"> </span><span class="n">STRING</span><span class="p">,</span><span class="w">  </span><span class="c1">-- GESTIONNAIRE, DIRECTEUR, VP</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">    </span><span class="c1">-- Résilience</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">    </span><span class="n">rpo_heures</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Recovery Point Objective</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">    </span><span class="n">rto_heures</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Recovery Time Objective</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="w">    </span><span class="n">sauvegarde_requise</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="w">    </span><span class="n">replication_geo_requise</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="w">    </span><span class="c1">-- Audit</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="w">    </span><span class="n">audit_acces_requis</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a><span class="w">    </span><span class="n">retention_audit_jours</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="w">    </span><span class="c1">-- Tiers</span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="w">    </span><span class="n">partage_tiers_autorise</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="p">,</span>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a><span class="w">    </span><span class="n">tiers_autorises</span><span class="w"> </span><span class="nb">ARRAY</span><span class="o">&lt;</span><span class="n">STRING</span><span class="o">&gt;</span><span class="p">,</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a><span class="w">    </span><span class="n">date_derniere_revue</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a><span class="w">    </span><span class="n">prochaine_revue</span><span class="w"> </span><span class="nb">DATE</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="p">)</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">iceberg</span><span class="p">;</span>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a><span class="c1">-- Exemple de classification pour une table critique</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">lakehouse</span><span class="p">.</span><span class="n">gouvernance</span><span class="p">.</span><span class="n">classification_bsif</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a><span class="w">    </span><span class="s1">&#39;tbl_001&#39;</span><span class="p">,</span>
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a><span class="w">    </span><span class="s1">&#39;lakehouse.gold.positions_portefeuille&#39;</span><span class="p">,</span>
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a><span class="w">    </span><span class="s1">&#39;CRITIQUE&#39;</span><span class="p">,</span>
<a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a><span class="w">    </span><span class="s1">&#39;TRES_ELEVE&#39;</span><span class="p">,</span>
<a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a><span class="w">    </span><span class="s1">&#39;vp.gestion.actifs@banque.ca&#39;</span><span class="p">,</span>
<a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a><span class="w">    </span><span class="s1">&#39;architecte.donnees@banque.ca&#39;</span><span class="p">,</span>
<a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span><span class="w">   </span><span class="c1">-- chiffrement</span>
<a id="__codelineno-20-48" name="__codelineno-20-48" href="#__codelineno-20-48"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span><span class="w">   </span><span class="c1">-- masquage</span>
<a id="__codelineno-20-49" name="__codelineno-20-49" href="#__codelineno-20-49"></a><span class="w">    </span><span class="mi">2555</span><span class="p">,</span><span class="w">   </span><span class="c1">-- retention min 7 ans</span>
<a id="__codelineno-20-50" name="__codelineno-20-50" href="#__codelineno-20-50"></a><span class="w">    </span><span class="mi">3650</span><span class="p">,</span><span class="w">   </span><span class="c1">-- retention max 10 ans</span>
<a id="__codelineno-20-51" name="__codelineno-20-51" href="#__codelineno-20-51"></a><span class="w">    </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;equipe_gestion_actifs&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;equipe_risques&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;equipe_conformite&#39;</span><span class="p">),</span>
<a id="__codelineno-20-52" name="__codelineno-20-52" href="#__codelineno-20-52"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span><span class="w">   </span><span class="c1">-- approbation requise</span>
<a id="__codelineno-20-53" name="__codelineno-20-53" href="#__codelineno-20-53"></a><span class="w">    </span><span class="s1">&#39;VP&#39;</span><span class="p">,</span>
<a id="__codelineno-20-54" name="__codelineno-20-54" href="#__codelineno-20-54"></a><span class="w">    </span><span class="mi">4</span><span class="p">,</span><span class="w">      </span><span class="c1">-- RPO 4 heures</span>
<a id="__codelineno-20-55" name="__codelineno-20-55" href="#__codelineno-20-55"></a><span class="w">    </span><span class="mi">24</span><span class="p">,</span><span class="w">     </span><span class="c1">-- RTO 24 heures</span>
<a id="__codelineno-20-56" name="__codelineno-20-56" href="#__codelineno-20-56"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span><span class="w">   </span><span class="c1">-- sauvegarde</span>
<a id="__codelineno-20-57" name="__codelineno-20-57" href="#__codelineno-20-57"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span><span class="w">   </span><span class="c1">-- réplication géo</span>
<a id="__codelineno-20-58" name="__codelineno-20-58" href="#__codelineno-20-58"></a><span class="w">    </span><span class="k">true</span><span class="p">,</span><span class="w">   </span><span class="c1">-- audit accès</span>
<a id="__codelineno-20-59" name="__codelineno-20-59" href="#__codelineno-20-59"></a><span class="w">    </span><span class="mi">2555</span><span class="p">,</span><span class="w">   </span><span class="c1">-- retention audit 7 ans</span>
<a id="__codelineno-20-60" name="__codelineno-20-60" href="#__codelineno-20-60"></a><span class="w">    </span><span class="k">false</span><span class="p">,</span><span class="w">  </span><span class="c1">-- pas de partage tiers</span>
<a id="__codelineno-20-61" name="__codelineno-20-61" href="#__codelineno-20-61"></a><span class="w">    </span><span class="nb">array</span><span class="p">(),</span>
<a id="__codelineno-20-62" name="__codelineno-20-62" href="#__codelineno-20-62"></a><span class="w">    </span><span class="k">current_date</span><span class="p">(),</span>
<a id="__codelineno-20-63" name="__codelineno-20-63" href="#__codelineno-20-63"></a><span class="w">    </span><span class="n">date_add</span><span class="p">(</span><span class="k">current_date</span><span class="p">(),</span><span class="w"> </span><span class="mi">365</span><span class="p">)</span>
<a id="__codelineno-20-64" name="__codelineno-20-64" href="#__codelineno-20-64"></a><span class="p">);</span>
</code></pre></div>
<hr />
<h2 id="iv135-audit-et-surveillance">IV.13.5 Audit et Surveillance<a class="headerlink" href="#iv135-audit-et-surveillance" title="Permanent link">&para;</a></h2>
<h3 id="journalisation-des-acces">Journalisation des Accès<a class="headerlink" href="#journalisation-des-acces" title="Permanent link">&para;</a></h3>
<p>Une stratégie d'audit complète capture les accès à plusieurs niveaux : le stockage objet, le catalogue et les moteurs de calcul. La corrélation de ces journaux permet de reconstituer l'activité complète d'un utilisateur.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1"># Pipeline d&#39;agrégation des journaux d&#39;audit multi-sources</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparkSession</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pyspark.sql</span><span class="w"> </span><span class="kn">import</span> <span class="n">functions</span> <span class="k">as</span> <span class="n">F</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span> \
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>    <span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s2">&quot;Audit-Aggregation&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    <span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="c1"># Source 1 : AWS CloudTrail (accès S3)</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="n">df_cloudtrail</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span> \
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;s3://audit-logs/cloudtrail/&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>    <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;eventSource&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;s3.amazonaws.com&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>    <span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;eventTime&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">),</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>        <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;userIdentity.arn&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;principal&quot;</span><span class="p">),</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;eventName&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">),</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;requestParameters.bucketName&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_bucket&quot;</span><span class="p">),</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;requestParameters.key&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_cle&quot;</span><span class="p">),</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sourceIPAddress&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ip_source&quot;</span><span class="p">),</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;errorCode&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;code_erreur&quot;</span><span class="p">)</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>    <span class="p">)</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a><span class="c1"># Source 2 : Polaris Audit Logs (accès catalogue)</span>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a><span class="n">df_polaris</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span> \
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;s3://audit-logs/polaris/&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a>    <span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">),</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a>        <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;POLARIS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;principal&quot;</span><span class="p">),</span>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">),</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;catalog&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_catalogue&quot;</span><span class="p">),</span>
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;namespace&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_namespace&quot;</span><span class="p">),</span>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_table&quot;</span><span class="p">),</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;sourceIp&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ip_source&quot;</span><span class="p">),</span>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;errorCode&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;code_erreur&quot;</span><span class="p">)</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a>    <span class="p">)</span>
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a>
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a><span class="c1"># Source 3 : Spark Query Logs (requêtes exécutées)</span>
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a><span class="n">df_spark_audit</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span> \
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a>    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a>    <span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;s3://audit-logs/spark/&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a>    <span class="o">.</span><span class="n">select</span><span class="p">(</span>
<a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">),</span>
<a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>        <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="s2">&quot;SPARK&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">),</span>
<a id="__codelineno-21-48" name="__codelineno-21-48" href="#__codelineno-21-48"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;principal&quot;</span><span class="p">),</span>
<a id="__codelineno-21-49" name="__codelineno-21-49" href="#__codelineno-21-49"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;operation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;action&quot;</span><span class="p">),</span>
<a id="__codelineno-21-50" name="__codelineno-21-50" href="#__codelineno-21-50"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;database&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_database&quot;</span><span class="p">),</span>
<a id="__codelineno-21-51" name="__codelineno-21-51" href="#__codelineno-21-51"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;ressource_table&quot;</span><span class="p">),</span>
<a id="__codelineno-21-52" name="__codelineno-21-52" href="#__codelineno-21-52"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;query&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;requete_sql&quot;</span><span class="p">),</span>
<a id="__codelineno-21-53" name="__codelineno-21-53" href="#__codelineno-21-53"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;duration_ms&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;duree_ms&quot;</span><span class="p">),</span>
<a id="__codelineno-21-54" name="__codelineno-21-54" href="#__codelineno-21-54"></a>        <span class="n">F</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s2">&quot;rows_affected&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;lignes_affectees&quot;</span><span class="p">)</span>
<a id="__codelineno-21-55" name="__codelineno-21-55" href="#__codelineno-21-55"></a>    <span class="p">)</span>
<a id="__codelineno-21-56" name="__codelineno-21-56" href="#__codelineno-21-56"></a>
<a id="__codelineno-21-57" name="__codelineno-21-57" href="#__codelineno-21-57"></a><span class="c1"># Agrégation et enrichissement</span>
<a id="__codelineno-21-58" name="__codelineno-21-58" href="#__codelineno-21-58"></a><span class="n">df_audit_unifie</span> <span class="o">=</span> <span class="n">df_cloudtrail</span> \
<a id="__codelineno-21-59" name="__codelineno-21-59" href="#__codelineno-21-59"></a>    <span class="o">.</span><span class="n">unionByName</span><span class="p">(</span><span class="n">df_polaris</span><span class="p">,</span> <span class="n">allowMissingColumns</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
<a id="__codelineno-21-60" name="__codelineno-21-60" href="#__codelineno-21-60"></a>    <span class="o">.</span><span class="n">unionByName</span><span class="p">(</span><span class="n">df_spark_audit</span><span class="p">,</span> <span class="n">allowMissingColumns</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> \
<a id="__codelineno-21-61" name="__codelineno-21-61" href="#__codelineno-21-61"></a>    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;date_partition&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">to_date</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">))</span> \
<a id="__codelineno-21-62" name="__codelineno-21-62" href="#__codelineno-21-62"></a>    <span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s2">&quot;heure&quot;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">hour</span><span class="p">(</span><span class="s2">&quot;timestamp&quot;</span><span class="p">))</span>
<a id="__codelineno-21-63" name="__codelineno-21-63" href="#__codelineno-21-63"></a>
<a id="__codelineno-21-64" name="__codelineno-21-64" href="#__codelineno-21-64"></a><span class="c1"># Écriture vers la table d&#39;audit unifiée</span>
<a id="__codelineno-21-65" name="__codelineno-21-65" href="#__codelineno-21-65"></a><span class="n">df_audit_unifie</span><span class="o">.</span><span class="n">writeTo</span><span class="p">(</span><span class="s2">&quot;lakehouse.audit.evenements_unifies&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-66" name="__codelineno-21-66" href="#__codelineno-21-66"></a>    <span class="o">.</span><span class="n">using</span><span class="p">(</span><span class="s2">&quot;iceberg&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-67" name="__codelineno-21-67" href="#__codelineno-21-67"></a>    <span class="o">.</span><span class="n">partitionedBy</span><span class="p">(</span><span class="s2">&quot;date_partition&quot;</span><span class="p">)</span> \
<a id="__codelineno-21-68" name="__codelineno-21-68" href="#__codelineno-21-68"></a>    <span class="o">.</span><span class="n">append</span><span class="p">()</span>
<a id="__codelineno-21-69" name="__codelineno-21-69" href="#__codelineno-21-69"></a>
<a id="__codelineno-21-70" name="__codelineno-21-70" href="#__codelineno-21-70"></a><span class="c1"># Création de vues analytiques pour les investigations</span>
<a id="__codelineno-21-71" name="__codelineno-21-71" href="#__codelineno-21-71"></a><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-21-72" name="__codelineno-21-72" href="#__codelineno-21-72"></a><span class="s2">    CREATE OR REPLACE VIEW lakehouse.audit.v_acces_pii AS</span>
<a id="__codelineno-21-73" name="__codelineno-21-73" href="#__codelineno-21-73"></a><span class="s2">    SELECT </span>
<a id="__codelineno-21-74" name="__codelineno-21-74" href="#__codelineno-21-74"></a><span class="s2">        timestamp,</span>
<a id="__codelineno-21-75" name="__codelineno-21-75" href="#__codelineno-21-75"></a><span class="s2">        source,</span>
<a id="__codelineno-21-76" name="__codelineno-21-76" href="#__codelineno-21-76"></a><span class="s2">        principal,</span>
<a id="__codelineno-21-77" name="__codelineno-21-77" href="#__codelineno-21-77"></a><span class="s2">        action,</span>
<a id="__codelineno-21-78" name="__codelineno-21-78" href="#__codelineno-21-78"></a><span class="s2">        COALESCE(ressource_table, ressource_cle) as ressource,</span>
<a id="__codelineno-21-79" name="__codelineno-21-79" href="#__codelineno-21-79"></a><span class="s2">        ip_source,</span>
<a id="__codelineno-21-80" name="__codelineno-21-80" href="#__codelineno-21-80"></a><span class="s2">        requete_sql</span>
<a id="__codelineno-21-81" name="__codelineno-21-81" href="#__codelineno-21-81"></a><span class="s2">    FROM lakehouse.audit.evenements_unifies</span>
<a id="__codelineno-21-82" name="__codelineno-21-82" href="#__codelineno-21-82"></a><span class="s2">    WHERE </span>
<a id="__codelineno-21-83" name="__codelineno-21-83" href="#__codelineno-21-83"></a><span class="s2">        ressource_table IN (</span>
<a id="__codelineno-21-84" name="__codelineno-21-84" href="#__codelineno-21-84"></a><span class="s2">            SELECT chemin_technique </span>
<a id="__codelineno-21-85" name="__codelineno-21-85" href="#__codelineno-21-85"></a><span class="s2">            FROM lakehouse.gouvernance.catalogue_metier</span>
<a id="__codelineno-21-86" name="__codelineno-21-86" href="#__codelineno-21-86"></a><span class="s2">            WHERE contient_pii = true</span>
<a id="__codelineno-21-87" name="__codelineno-21-87" href="#__codelineno-21-87"></a><span class="s2">        )</span>
<a id="__codelineno-21-88" name="__codelineno-21-88" href="#__codelineno-21-88"></a><span class="s2">        OR ressource_cle LIKE &#39;</span><span class="si">%d</span><span class="s2">onnees_personnelles%&#39;</span>
<a id="__codelineno-21-89" name="__codelineno-21-89" href="#__codelineno-21-89"></a><span class="s2">    ORDER BY timestamp DESC</span>
<a id="__codelineno-21-90" name="__codelineno-21-90" href="#__codelineno-21-90"></a><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="alertes-de-securite">Alertes de Sécurité<a class="headerlink" href="#alertes-de-securite" title="Permanent link">&para;</a></h3>
<p>La détection proactive des comportements anormaux constitue une couche de défense essentielle. Les patterns suivants méritent une surveillance particulière :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># Configuration des alertes de sécurité pour le Lakehouse</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c1"># alertmanager-rules.yml</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="nt">groups</span><span class="p">:</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lakehouse_security_alerts</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">    </span><span class="nt">rules</span><span class="p">:</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">      </span><span class="c1"># Tentatives d&#39;accès non autorisées</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AccesNonAutoriseDetecte</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">          </span><span class="no">sum(rate(polaris_access_denied_total[5m])) by (principal) &gt; 10</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">warning</span>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">          </span><span class="nt">equipe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">securite</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Tentatives</span><span class="nv"> </span><span class="s">d&#39;accès</span><span class="nv"> </span><span class="s">refusées</span><span class="nv"> </span><span class="s">répétées&quot;</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Le</span><span class="nv"> </span><span class="s">principal</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$labels.principal</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">eu</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$value</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">tentatives</span><span class="nv"> </span><span class="s">refusées</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">5</span><span class="nv"> </span><span class="s">minutes&quot;</span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="w">      </span><span class="c1"># Accès inhabituel aux données PII</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AccesPIIAnormal</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="w">          </span><span class="no">sum(rate(spark_query_pii_tables_total[1h])) by (user) </span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="w">          </span><span class="no">&gt; 3 * avg_over_time(spark_query_pii_tables_total[7d])</span>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15m</span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="w">          </span><span class="nt">equipe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">securite</span>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Volume</span><span class="nv"> </span><span class="s">d&#39;accès</span><span class="nv"> </span><span class="s">PII</span><span class="nv"> </span><span class="s">anormalement</span><span class="nv"> </span><span class="s">élevé&quot;</span>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;L&#39;utilisateur</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$labels.user</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">accède</span><span class="nv"> </span><span class="s">aux</span><span class="nv"> </span><span class="s">tables</span><span class="nv"> </span><span class="s">PII</span><span class="nv"> </span><span class="s">à</span><span class="nv"> </span><span class="s">un</span><span class="nv"> </span><span class="s">rythme</span><span class="nv"> </span><span class="s">3x</span><span class="nv"> </span><span class="s">supérieur</span><span class="nv"> </span><span class="s">à</span><span class="nv"> </span><span class="s">la</span><span class="nv"> </span><span class="s">normale&quot;</span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a><span class="w">      </span><span class="c1"># Export massif de données</span>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExportMassifDetecte</span>
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a><span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a><span class="w">          </span><span class="no">sum(rate(iceberg_rows_read_total[10m])) by (user, table) &gt; 10000000</span>
<a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a><span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a><span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a><span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">critical</span>
<a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a><span class="w">          </span><span class="nt">equipe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">securite</span>
<a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a><span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a><span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Export</span><span class="nv"> </span><span class="s">massif</span><span class="nv"> </span><span class="s">de</span><span class="nv"> </span><span class="s">données</span><span class="nv"> </span><span class="s">détecté&quot;</span>
<a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">$labels.user</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">lit</span><span class="nv"> </span><span class="s">&gt;10M</span><span class="nv"> </span><span class="s">lignes</span><span class="nv"> </span><span class="s">de</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$labels.table</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">10</span><span class="nv"> </span><span class="s">minutes&quot;</span>
<a id="__codelineno-22-43" name="__codelineno-22-43" href="#__codelineno-22-43"></a>
<a id="__codelineno-22-44" name="__codelineno-22-44" href="#__codelineno-22-44"></a><span class="w">      </span><span class="c1"># Accès depuis IP inhabituelle</span>
<a id="__codelineno-22-45" name="__codelineno-22-45" href="#__codelineno-22-45"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AccesIPInhabituelle</span>
<a id="__codelineno-22-46" name="__codelineno-22-46" href="#__codelineno-22-46"></a><span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-22-47" name="__codelineno-22-47" href="#__codelineno-22-47"></a><span class="w">          </span><span class="no">count(polaris_access_total{ip_source!~&quot;10\\..*|172\\.16\\..*|192\\.168\\..*&quot;}) by (principal, ip_source) &gt; 0</span>
<a id="__codelineno-22-48" name="__codelineno-22-48" href="#__codelineno-22-48"></a><span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1m</span>
<a id="__codelineno-22-49" name="__codelineno-22-49" href="#__codelineno-22-49"></a><span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-22-50" name="__codelineno-22-50" href="#__codelineno-22-50"></a><span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">high</span>
<a id="__codelineno-22-51" name="__codelineno-22-51" href="#__codelineno-22-51"></a><span class="w">          </span><span class="nt">equipe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">securite</span>
<a id="__codelineno-22-52" name="__codelineno-22-52" href="#__codelineno-22-52"></a><span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-22-53" name="__codelineno-22-53" href="#__codelineno-22-53"></a><span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Accès</span><span class="nv"> </span><span class="s">depuis</span><span class="nv"> </span><span class="s">IP</span><span class="nv"> </span><span class="s">externe&quot;</span>
<a id="__codelineno-22-54" name="__codelineno-22-54" href="#__codelineno-22-54"></a><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">$labels.principal</span><span class="nv"> </span><span class="s">}}</span><span class="nv"> </span><span class="s">accède</span><span class="nv"> </span><span class="s">depuis</span><span class="nv"> </span><span class="s">l&#39;IP</span><span class="nv"> </span><span class="s">{{</span><span class="nv"> </span><span class="s">$labels.ip_source</span><span class="nv"> </span><span class="s">}}&quot;</span>
<a id="__codelineno-22-55" name="__codelineno-22-55" href="#__codelineno-22-55"></a>
<a id="__codelineno-22-56" name="__codelineno-22-56" href="#__codelineno-22-56"></a><span class="w">      </span><span class="c1"># Modification de permissions</span>
<a id="__codelineno-22-57" name="__codelineno-22-57" href="#__codelineno-22-57"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ModificationPermissions</span>
<a id="__codelineno-22-58" name="__codelineno-22-58" href="#__codelineno-22-58"></a><span class="w">        </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-22-59" name="__codelineno-22-59" href="#__codelineno-22-59"></a><span class="w">          </span><span class="no">increase(polaris_grant_revoke_total[5m]) &gt; 0</span>
<a id="__codelineno-22-60" name="__codelineno-22-60" href="#__codelineno-22-60"></a><span class="w">        </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0m</span>
<a id="__codelineno-22-61" name="__codelineno-22-61" href="#__codelineno-22-61"></a><span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-22-62" name="__codelineno-22-62" href="#__codelineno-22-62"></a><span class="w">          </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">info</span>
<a id="__codelineno-22-63" name="__codelineno-22-63" href="#__codelineno-22-63"></a><span class="w">          </span><span class="nt">equipe</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gouvernance</span>
<a id="__codelineno-22-64" name="__codelineno-22-64" href="#__codelineno-22-64"></a><span class="w">        </span><span class="nt">annotations</span><span class="p">:</span>
<a id="__codelineno-22-65" name="__codelineno-22-65" href="#__codelineno-22-65"></a><span class="w">          </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Modification</span><span class="nv"> </span><span class="s">des</span><span class="nv"> </span><span class="s">permissions</span><span class="nv"> </span><span class="s">détectée&quot;</span>
<a id="__codelineno-22-66" name="__codelineno-22-66" href="#__codelineno-22-66"></a><span class="w">          </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Des</span><span class="nv"> </span><span class="s">permissions</span><span class="nv"> </span><span class="s">ont</span><span class="nv"> </span><span class="s">été</span><span class="nv"> </span><span class="s">modifiées</span><span class="nv"> </span><span class="s">dans</span><span class="nv"> </span><span class="s">le</span><span class="nv"> </span><span class="s">catalogue&quot;</span>
</code></pre></div>
<h3 id="reponse-aux-incidents-de-securite">Réponse aux Incidents de Sécurité<a class="headerlink" href="#reponse-aux-incidents-de-securite" title="Permanent link">&para;</a></h3>
<p>Un plan de réponse aux incidents documenté et testé est essentiel pour minimiser l'impact d'une violation de données. Le Lakehouse, grâce à ses capacités de time travel et son audit détaillé, offre des outils puissants pour l'investigation et la remédiation.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Framework de réponse aux incidents pour le Lakehouse</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">SeveriteIncident</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>    <span class="n">CRITIQUE</span> <span class="o">=</span> <span class="s2">&quot;CRITIQUE&quot;</span>  <span class="c1"># Données sensibles exposées, action immédiate</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>    <span class="n">ELEVE</span> <span class="o">=</span> <span class="s2">&quot;ELEVE&quot;</span>        <span class="c1"># Accès non autorisé détecté</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>    <span class="n">MOYEN</span> <span class="o">=</span> <span class="s2">&quot;MOYEN&quot;</span>        <span class="c1"># Anomalie nécessitant investigation</span>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>    <span class="n">FAIBLE</span> <span class="o">=</span> <span class="s2">&quot;FAIBLE&quot;</span>      <span class="c1"># Événement suspect à surveiller</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="nd">@dataclass</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="k">class</span><span class="w"> </span><span class="nc">IncidentSecurite</span><span class="p">:</span>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Représente un incident de sécurité dans le Lakehouse.&quot;&quot;&quot;</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>    <span class="n">incident_id</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>    <span class="n">timestamp_detection</span><span class="p">:</span> <span class="n">datetime</span>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a>    <span class="n">severite</span><span class="p">:</span> <span class="n">SeveriteIncident</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a>    <span class="n">type_incident</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># ACCES_NON_AUTORISE, EXFILTRATION, MODIFICATION</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>    <span class="n">tables_affectees</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>    <span class="n">utilisateur_suspect</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>    <span class="n">ip_source</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>    <span class="n">statut</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;OUVERT&quot;</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="k">class</span><span class="w"> </span><span class="nc">GestionnaireIncidents</span><span class="p">:</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="sd">    Gère le cycle de vie des incidents de sécurité du Lakehouse.</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="sd">    Phases de réponse :</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a><span class="sd">    1. Détection et qualification</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="sd">    2. Confinement immédiat</span>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="sd">    3. Investigation approfondie</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="sd">    4. Remédiation</span>
<a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="sd">    5. Récupération</span>
<a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a><span class="sd">    6. Leçons apprises</span>
<a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a>
<a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spark_session</span><span class="p">,</span> <span class="n">polaris_client</span><span class="p">,</span> 
<a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a>                 <span class="n">notification_service</span><span class="p">):</span>
<a id="__codelineno-23-42" name="__codelineno-23-42" href="#__codelineno-23-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">spark</span> <span class="o">=</span> <span class="n">spark_session</span>
<a id="__codelineno-23-43" name="__codelineno-23-43" href="#__codelineno-23-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polaris</span> <span class="o">=</span> <span class="n">polaris_client</span>
<a id="__codelineno-23-44" name="__codelineno-23-44" href="#__codelineno-23-44"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span> <span class="o">=</span> <span class="n">notification_service</span>
<a id="__codelineno-23-45" name="__codelineno-23-45" href="#__codelineno-23-45"></a>
<a id="__codelineno-23-46" name="__codelineno-23-46" href="#__codelineno-23-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase_1_detection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">IncidentSecurite</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-23-47" name="__codelineno-23-47" href="#__codelineno-23-47"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-48" name="__codelineno-23-48" href="#__codelineno-23-48"></a><span class="sd">        Phase 1 : Détection et qualification initiale.</span>
<a id="__codelineno-23-49" name="__codelineno-23-49" href="#__codelineno-23-49"></a>
<a id="__codelineno-23-50" name="__codelineno-23-50" href="#__codelineno-23-50"></a><span class="sd">        Actions :</span>
<a id="__codelineno-23-51" name="__codelineno-23-51" href="#__codelineno-23-51"></a><span class="sd">        - Confirmer l&#39;incident</span>
<a id="__codelineno-23-52" name="__codelineno-23-52" href="#__codelineno-23-52"></a><span class="sd">        - Évaluer la sévérité</span>
<a id="__codelineno-23-53" name="__codelineno-23-53" href="#__codelineno-23-53"></a><span class="sd">        - Notifier les parties prenantes appropriées</span>
<a id="__codelineno-23-54" name="__codelineno-23-54" href="#__codelineno-23-54"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-55" name="__codelineno-23-55" href="#__codelineno-23-55"></a>        <span class="c1"># Journaliser l&#39;incident</span>
<a id="__codelineno-23-56" name="__codelineno-23-56" href="#__codelineno-23-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_journaliser_incident</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
<a id="__codelineno-23-57" name="__codelineno-23-57" href="#__codelineno-23-57"></a>
<a id="__codelineno-23-58" name="__codelineno-23-58" href="#__codelineno-23-58"></a>        <span class="c1"># Notification selon la sévérité</span>
<a id="__codelineno-23-59" name="__codelineno-23-59" href="#__codelineno-23-59"></a>        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">severite</span> <span class="o">==</span> <span class="n">SeveriteIncident</span><span class="o">.</span><span class="n">CRITIQUE</span><span class="p">:</span>
<a id="__codelineno-23-60" name="__codelineno-23-60" href="#__codelineno-23-60"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">alerte_urgente</span><span class="p">(</span>
<a id="__codelineno-23-61" name="__codelineno-23-61" href="#__codelineno-23-61"></a>                <span class="n">destinataires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;securite@entreprise.ca&quot;</span><span class="p">,</span> 
<a id="__codelineno-23-62" name="__codelineno-23-62" href="#__codelineno-23-62"></a>                              <span class="s2">&quot;ciso@entreprise.ca&quot;</span><span class="p">,</span>
<a id="__codelineno-23-63" name="__codelineno-23-63" href="#__codelineno-23-63"></a>                              <span class="s2">&quot;juridique@entreprise.ca&quot;</span><span class="p">],</span>
<a id="__codelineno-23-64" name="__codelineno-23-64" href="#__codelineno-23-64"></a>                <span class="n">sujet</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[CRITIQUE] Incident sécurité Lakehouse: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-23-65" name="__codelineno-23-65" href="#__codelineno-23-65"></a>                <span class="n">corps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_formater_alerte</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
<a id="__codelineno-23-66" name="__codelineno-23-66" href="#__codelineno-23-66"></a>            <span class="p">)</span>
<a id="__codelineno-23-67" name="__codelineno-23-67" href="#__codelineno-23-67"></a>        <span class="k">elif</span> <span class="n">incident</span><span class="o">.</span><span class="n">severite</span> <span class="o">==</span> <span class="n">SeveriteIncident</span><span class="o">.</span><span class="n">ELEVE</span><span class="p">:</span>
<a id="__codelineno-23-68" name="__codelineno-23-68" href="#__codelineno-23-68"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">alerte_urgente</span><span class="p">(</span>
<a id="__codelineno-23-69" name="__codelineno-23-69" href="#__codelineno-23-69"></a>                <span class="n">destinataires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;securite@entreprise.ca&quot;</span><span class="p">],</span>
<a id="__codelineno-23-70" name="__codelineno-23-70" href="#__codelineno-23-70"></a>                <span class="n">sujet</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;[ÉLEVÉ] Incident sécurité Lakehouse: </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-23-71" name="__codelineno-23-71" href="#__codelineno-23-71"></a>                <span class="n">corps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_formater_alerte</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
<a id="__codelineno-23-72" name="__codelineno-23-72" href="#__codelineno-23-72"></a>            <span class="p">)</span>
<a id="__codelineno-23-73" name="__codelineno-23-73" href="#__codelineno-23-73"></a>
<a id="__codelineno-23-74" name="__codelineno-23-74" href="#__codelineno-23-74"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;DETECTION&quot;</span><span class="p">,</span> <span class="s2">&quot;statut&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">}</span>
<a id="__codelineno-23-75" name="__codelineno-23-75" href="#__codelineno-23-75"></a>
<a id="__codelineno-23-76" name="__codelineno-23-76" href="#__codelineno-23-76"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase_2_confinement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">IncidentSecurite</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-23-77" name="__codelineno-23-77" href="#__codelineno-23-77"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-78" name="__codelineno-23-78" href="#__codelineno-23-78"></a><span class="sd">        Phase 2 : Confinement pour limiter l&#39;impact.</span>
<a id="__codelineno-23-79" name="__codelineno-23-79" href="#__codelineno-23-79"></a>
<a id="__codelineno-23-80" name="__codelineno-23-80" href="#__codelineno-23-80"></a><span class="sd">        Actions :</span>
<a id="__codelineno-23-81" name="__codelineno-23-81" href="#__codelineno-23-81"></a><span class="sd">        - Révoquer les accès suspects</span>
<a id="__codelineno-23-82" name="__codelineno-23-82" href="#__codelineno-23-82"></a><span class="sd">        - Isoler les ressources compromises</span>
<a id="__codelineno-23-83" name="__codelineno-23-83" href="#__codelineno-23-83"></a><span class="sd">        - Préserver les preuves</span>
<a id="__codelineno-23-84" name="__codelineno-23-84" href="#__codelineno-23-84"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-85" name="__codelineno-23-85" href="#__codelineno-23-85"></a>        <span class="n">actions_prises</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-23-86" name="__codelineno-23-86" href="#__codelineno-23-86"></a>
<a id="__codelineno-23-87" name="__codelineno-23-87" href="#__codelineno-23-87"></a>        <span class="c1"># Révoquer immédiatement les accès de l&#39;utilisateur suspect</span>
<a id="__codelineno-23-88" name="__codelineno-23-88" href="#__codelineno-23-88"></a>        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">utilisateur_suspect</span><span class="p">:</span>
<a id="__codelineno-23-89" name="__codelineno-23-89" href="#__codelineno-23-89"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">polaris</span><span class="o">.</span><span class="n">revoquer_tous_acces</span><span class="p">(</span>
<a id="__codelineno-23-90" name="__codelineno-23-90" href="#__codelineno-23-90"></a>                <span class="n">principal</span><span class="o">=</span><span class="n">incident</span><span class="o">.</span><span class="n">utilisateur_suspect</span>
<a id="__codelineno-23-91" name="__codelineno-23-91" href="#__codelineno-23-91"></a>            <span class="p">)</span>
<a id="__codelineno-23-92" name="__codelineno-23-92" href="#__codelineno-23-92"></a>            <span class="n">actions_prises</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-93" name="__codelineno-23-93" href="#__codelineno-23-93"></a>                <span class="sa">f</span><span class="s2">&quot;Accès révoqués pour </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">utilisateur_suspect</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-94" name="__codelineno-23-94" href="#__codelineno-23-94"></a>            <span class="p">)</span>
<a id="__codelineno-23-95" name="__codelineno-23-95" href="#__codelineno-23-95"></a>
<a id="__codelineno-23-96" name="__codelineno-23-96" href="#__codelineno-23-96"></a>        <span class="c1"># Bloquer l&#39;IP source si identifiée</span>
<a id="__codelineno-23-97" name="__codelineno-23-97" href="#__codelineno-23-97"></a>        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">ip_source</span><span class="p">:</span>
<a id="__codelineno-23-98" name="__codelineno-23-98" href="#__codelineno-23-98"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_ajouter_ip_liste_noire</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">ip_source</span><span class="p">)</span>
<a id="__codelineno-23-99" name="__codelineno-23-99" href="#__codelineno-23-99"></a>            <span class="n">actions_prises</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-100" name="__codelineno-23-100" href="#__codelineno-23-100"></a>                <span class="sa">f</span><span class="s2">&quot;IP </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">ip_source</span><span class="si">}</span><span class="s2"> ajoutée à la liste noire&quot;</span>
<a id="__codelineno-23-101" name="__codelineno-23-101" href="#__codelineno-23-101"></a>            <span class="p">)</span>
<a id="__codelineno-23-102" name="__codelineno-23-102" href="#__codelineno-23-102"></a>
<a id="__codelineno-23-103" name="__codelineno-23-103" href="#__codelineno-23-103"></a>        <span class="c1"># Créer un tag Iceberg pour marquer l&#39;état des tables au moment de l&#39;incident</span>
<a id="__codelineno-23-104" name="__codelineno-23-104" href="#__codelineno-23-104"></a>        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-105" name="__codelineno-23-105" href="#__codelineno-23-105"></a>            <span class="n">tag_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;incident_</span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-106" name="__codelineno-23-106" href="#__codelineno-23-106"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-107" name="__codelineno-23-107" href="#__codelineno-23-107"></a><span class="s2">                ALTER TABLE </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> </span>
<a id="__codelineno-23-108" name="__codelineno-23-108" href="#__codelineno-23-108"></a><span class="s2">                CREATE TAG `</span><span class="si">{</span><span class="n">tag_name</span><span class="si">}</span><span class="s2">`</span>
<a id="__codelineno-23-109" name="__codelineno-23-109" href="#__codelineno-23-109"></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-23-110" name="__codelineno-23-110" href="#__codelineno-23-110"></a>            <span class="n">actions_prises</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-111" name="__codelineno-23-111" href="#__codelineno-23-111"></a>                <span class="sa">f</span><span class="s2">&quot;Tag de préservation créé pour </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">tag_name</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-112" name="__codelineno-23-112" href="#__codelineno-23-112"></a>            <span class="p">)</span>
<a id="__codelineno-23-113" name="__codelineno-23-113" href="#__codelineno-23-113"></a>
<a id="__codelineno-23-114" name="__codelineno-23-114" href="#__codelineno-23-114"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-23-115" name="__codelineno-23-115" href="#__codelineno-23-115"></a>            <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;CONFINEMENT&quot;</span><span class="p">,</span> 
<a id="__codelineno-23-116" name="__codelineno-23-116" href="#__codelineno-23-116"></a>            <span class="s2">&quot;statut&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span>
<a id="__codelineno-23-117" name="__codelineno-23-117" href="#__codelineno-23-117"></a>            <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="n">actions_prises</span>
<a id="__codelineno-23-118" name="__codelineno-23-118" href="#__codelineno-23-118"></a>        <span class="p">}</span>
<a id="__codelineno-23-119" name="__codelineno-23-119" href="#__codelineno-23-119"></a>
<a id="__codelineno-23-120" name="__codelineno-23-120" href="#__codelineno-23-120"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase_3_investigation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">IncidentSecurite</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-23-121" name="__codelineno-23-121" href="#__codelineno-23-121"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-122" name="__codelineno-23-122" href="#__codelineno-23-122"></a><span class="sd">        Phase 3 : Investigation approfondie.</span>
<a id="__codelineno-23-123" name="__codelineno-23-123" href="#__codelineno-23-123"></a>
<a id="__codelineno-23-124" name="__codelineno-23-124" href="#__codelineno-23-124"></a><span class="sd">        Utilise les capacités du Lakehouse :</span>
<a id="__codelineno-23-125" name="__codelineno-23-125" href="#__codelineno-23-125"></a><span class="sd">        - Time travel pour examiner l&#39;état avant/après</span>
<a id="__codelineno-23-126" name="__codelineno-23-126" href="#__codelineno-23-126"></a><span class="sd">        - Audit logs pour retracer les actions</span>
<a id="__codelineno-23-127" name="__codelineno-23-127" href="#__codelineno-23-127"></a><span class="sd">        - Lignage pour identifier l&#39;impact en aval</span>
<a id="__codelineno-23-128" name="__codelineno-23-128" href="#__codelineno-23-128"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-129" name="__codelineno-23-129" href="#__codelineno-23-129"></a>        <span class="n">rapport_investigation</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-23-130" name="__codelineno-23-130" href="#__codelineno-23-130"></a>            <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="p">,</span>
<a id="__codelineno-23-131" name="__codelineno-23-131" href="#__codelineno-23-131"></a>            <span class="s2">&quot;timestamp_debut_investigation&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-23-132" name="__codelineno-23-132" href="#__codelineno-23-132"></a>        <span class="p">}</span>
<a id="__codelineno-23-133" name="__codelineno-23-133" href="#__codelineno-23-133"></a>
<a id="__codelineno-23-134" name="__codelineno-23-134" href="#__codelineno-23-134"></a>        <span class="c1"># Analyser les accès de l&#39;utilisateur suspect</span>
<a id="__codelineno-23-135" name="__codelineno-23-135" href="#__codelineno-23-135"></a>        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">utilisateur_suspect</span><span class="p">:</span>
<a id="__codelineno-23-136" name="__codelineno-23-136" href="#__codelineno-23-136"></a>            <span class="n">df_acces</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-137" name="__codelineno-23-137" href="#__codelineno-23-137"></a><span class="s2">                SELECT </span>
<a id="__codelineno-23-138" name="__codelineno-23-138" href="#__codelineno-23-138"></a><span class="s2">                    timestamp,</span>
<a id="__codelineno-23-139" name="__codelineno-23-139" href="#__codelineno-23-139"></a><span class="s2">                    action,</span>
<a id="__codelineno-23-140" name="__codelineno-23-140" href="#__codelineno-23-140"></a><span class="s2">                    ressource_table,</span>
<a id="__codelineno-23-141" name="__codelineno-23-141" href="#__codelineno-23-141"></a><span class="s2">                    requete_sql,</span>
<a id="__codelineno-23-142" name="__codelineno-23-142" href="#__codelineno-23-142"></a><span class="s2">                    lignes_affectees,</span>
<a id="__codelineno-23-143" name="__codelineno-23-143" href="#__codelineno-23-143"></a><span class="s2">                    ip_source</span>
<a id="__codelineno-23-144" name="__codelineno-23-144" href="#__codelineno-23-144"></a><span class="s2">                FROM lakehouse.audit.evenements_unifies</span>
<a id="__codelineno-23-145" name="__codelineno-23-145" href="#__codelineno-23-145"></a><span class="s2">                WHERE principal = &#39;</span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">utilisateur_suspect</span><span class="si">}</span><span class="s2">&#39;</span>
<a id="__codelineno-23-146" name="__codelineno-23-146" href="#__codelineno-23-146"></a><span class="s2">                AND timestamp &gt;= &#39;</span><span class="si">{</span><span class="p">(</span><span class="n">incident</span><span class="o">.</span><span class="n">timestamp_detection</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&#39;</span>
<a id="__codelineno-23-147" name="__codelineno-23-147" href="#__codelineno-23-147"></a><span class="s2">                ORDER BY timestamp DESC</span>
<a id="__codelineno-23-148" name="__codelineno-23-148" href="#__codelineno-23-148"></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-23-149" name="__codelineno-23-149" href="#__codelineno-23-149"></a>
<a id="__codelineno-23-150" name="__codelineno-23-150" href="#__codelineno-23-150"></a>            <span class="n">rapport_investigation</span><span class="p">[</span><span class="s2">&quot;historique_acces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_acces</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<a id="__codelineno-23-151" name="__codelineno-23-151" href="#__codelineno-23-151"></a>
<a id="__codelineno-23-152" name="__codelineno-23-152" href="#__codelineno-23-152"></a>        <span class="c1"># Examiner les modifications sur les tables affectées</span>
<a id="__codelineno-23-153" name="__codelineno-23-153" href="#__codelineno-23-153"></a>        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-154" name="__codelineno-23-154" href="#__codelineno-23-154"></a>            <span class="c1"># Obtenir l&#39;historique des snapshots</span>
<a id="__codelineno-23-155" name="__codelineno-23-155" href="#__codelineno-23-155"></a>            <span class="n">df_snapshots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-156" name="__codelineno-23-156" href="#__codelineno-23-156"></a><span class="s2">                SELECT * FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">.history</span>
<a id="__codelineno-23-157" name="__codelineno-23-157" href="#__codelineno-23-157"></a><span class="s2">                ORDER BY made_current_at DESC</span>
<a id="__codelineno-23-158" name="__codelineno-23-158" href="#__codelineno-23-158"></a><span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-23-159" name="__codelineno-23-159" href="#__codelineno-23-159"></a>
<a id="__codelineno-23-160" name="__codelineno-23-160" href="#__codelineno-23-160"></a>            <span class="n">rapport_investigation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;snapshots_</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_snapshots</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<a id="__codelineno-23-161" name="__codelineno-23-161" href="#__codelineno-23-161"></a>
<a id="__codelineno-23-162" name="__codelineno-23-162" href="#__codelineno-23-162"></a>            <span class="c1"># Comparer les données avant/après l&#39;incident (si applicable)</span>
<a id="__codelineno-23-163" name="__codelineno-23-163" href="#__codelineno-23-163"></a>            <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">type_incident</span> <span class="o">==</span> <span class="s2">&quot;MODIFICATION&quot;</span><span class="p">:</span>
<a id="__codelineno-23-164" name="__codelineno-23-164" href="#__codelineno-23-164"></a>                <span class="n">snapshot_avant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trouver_snapshot_avant</span><span class="p">(</span>
<a id="__codelineno-23-165" name="__codelineno-23-165" href="#__codelineno-23-165"></a>                    <span class="n">table</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">timestamp_detection</span>
<a id="__codelineno-23-166" name="__codelineno-23-166" href="#__codelineno-23-166"></a>                <span class="p">)</span>
<a id="__codelineno-23-167" name="__codelineno-23-167" href="#__codelineno-23-167"></a>                <span class="k">if</span> <span class="n">snapshot_avant</span><span class="p">:</span>
<a id="__codelineno-23-168" name="__codelineno-23-168" href="#__codelineno-23-168"></a>                    <span class="n">df_diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-169" name="__codelineno-23-169" href="#__codelineno-23-169"></a><span class="s2">                        SELECT &#39;SUPPRIME&#39; as change_type, * </span>
<a id="__codelineno-23-170" name="__codelineno-23-170" href="#__codelineno-23-170"></a><span class="s2">                        FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> VERSION AS OF </span><span class="si">{</span><span class="n">snapshot_avant</span><span class="si">}</span>
<a id="__codelineno-23-171" name="__codelineno-23-171" href="#__codelineno-23-171"></a><span class="s2">                        EXCEPT</span>
<a id="__codelineno-23-172" name="__codelineno-23-172" href="#__codelineno-23-172"></a><span class="s2">                        SELECT &#39;SUPPRIME&#39; as change_type, * </span>
<a id="__codelineno-23-173" name="__codelineno-23-173" href="#__codelineno-23-173"></a><span class="s2">                        FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span>
<a id="__codelineno-23-174" name="__codelineno-23-174" href="#__codelineno-23-174"></a>
<a id="__codelineno-23-175" name="__codelineno-23-175" href="#__codelineno-23-175"></a><span class="s2">                        UNION ALL</span>
<a id="__codelineno-23-176" name="__codelineno-23-176" href="#__codelineno-23-176"></a>
<a id="__codelineno-23-177" name="__codelineno-23-177" href="#__codelineno-23-177"></a><span class="s2">                        SELECT &#39;AJOUTE&#39; as change_type, * </span>
<a id="__codelineno-23-178" name="__codelineno-23-178" href="#__codelineno-23-178"></a><span class="s2">                        FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span>
<a id="__codelineno-23-179" name="__codelineno-23-179" href="#__codelineno-23-179"></a><span class="s2">                        EXCEPT</span>
<a id="__codelineno-23-180" name="__codelineno-23-180" href="#__codelineno-23-180"></a><span class="s2">                        SELECT &#39;AJOUTE&#39; as change_type, * </span>
<a id="__codelineno-23-181" name="__codelineno-23-181" href="#__codelineno-23-181"></a><span class="s2">                        FROM </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> VERSION AS OF </span><span class="si">{</span><span class="n">snapshot_avant</span><span class="si">}</span>
<a id="__codelineno-23-182" name="__codelineno-23-182" href="#__codelineno-23-182"></a><span class="s2">                    &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-23-183" name="__codelineno-23-183" href="#__codelineno-23-183"></a>                    <span class="n">rapport_investigation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;modifications_</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_diff</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<a id="__codelineno-23-184" name="__codelineno-23-184" href="#__codelineno-23-184"></a>
<a id="__codelineno-23-185" name="__codelineno-23-185" href="#__codelineno-23-185"></a>        <span class="c1"># Identifier l&#39;impact en aval via le lignage</span>
<a id="__codelineno-23-186" name="__codelineno-23-186" href="#__codelineno-23-186"></a>        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-187" name="__codelineno-23-187" href="#__codelineno-23-187"></a>            <span class="n">tables_dependantes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obtenir_dependances_aval</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<a id="__codelineno-23-188" name="__codelineno-23-188" href="#__codelineno-23-188"></a>            <span class="n">rapport_investigation</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;impact_aval_</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tables_dependantes</span>
<a id="__codelineno-23-189" name="__codelineno-23-189" href="#__codelineno-23-189"></a>
<a id="__codelineno-23-190" name="__codelineno-23-190" href="#__codelineno-23-190"></a>        <span class="k">return</span> <span class="n">rapport_investigation</span>
<a id="__codelineno-23-191" name="__codelineno-23-191" href="#__codelineno-23-191"></a>
<a id="__codelineno-23-192" name="__codelineno-23-192" href="#__codelineno-23-192"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase_4_remediation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">IncidentSecurite</span><span class="p">,</span>
<a id="__codelineno-23-193" name="__codelineno-23-193" href="#__codelineno-23-193"></a>                            <span class="n">rapport_investigation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-23-194" name="__codelineno-23-194" href="#__codelineno-23-194"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-195" name="__codelineno-23-195" href="#__codelineno-23-195"></a><span class="sd">        Phase 4 : Remédiation des dommages.</span>
<a id="__codelineno-23-196" name="__codelineno-23-196" href="#__codelineno-23-196"></a>
<a id="__codelineno-23-197" name="__codelineno-23-197" href="#__codelineno-23-197"></a><span class="sd">        Actions possibles :</span>
<a id="__codelineno-23-198" name="__codelineno-23-198" href="#__codelineno-23-198"></a><span class="sd">        - Restauration depuis un snapshot antérieur</span>
<a id="__codelineno-23-199" name="__codelineno-23-199" href="#__codelineno-23-199"></a><span class="sd">        - Correction des données modifiées</span>
<a id="__codelineno-23-200" name="__codelineno-23-200" href="#__codelineno-23-200"></a><span class="sd">        - Renforcement des contrôles</span>
<a id="__codelineno-23-201" name="__codelineno-23-201" href="#__codelineno-23-201"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-202" name="__codelineno-23-202" href="#__codelineno-23-202"></a>        <span class="n">actions_remediation</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-23-203" name="__codelineno-23-203" href="#__codelineno-23-203"></a>
<a id="__codelineno-23-204" name="__codelineno-23-204" href="#__codelineno-23-204"></a>        <span class="c1"># Si des données ont été modifiées, proposer une restauration</span>
<a id="__codelineno-23-205" name="__codelineno-23-205" href="#__codelineno-23-205"></a>        <span class="k">if</span> <span class="n">incident</span><span class="o">.</span><span class="n">type_incident</span> <span class="o">==</span> <span class="s2">&quot;MODIFICATION&quot;</span><span class="p">:</span>
<a id="__codelineno-23-206" name="__codelineno-23-206" href="#__codelineno-23-206"></a>            <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-207" name="__codelineno-23-207" href="#__codelineno-23-207"></a>                <span class="n">snapshot_propre</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trouver_dernier_snapshot_propre</span><span class="p">(</span>
<a id="__codelineno-23-208" name="__codelineno-23-208" href="#__codelineno-23-208"></a>                    <span class="n">table</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">timestamp_detection</span>
<a id="__codelineno-23-209" name="__codelineno-23-209" href="#__codelineno-23-209"></a>                <span class="p">)</span>
<a id="__codelineno-23-210" name="__codelineno-23-210" href="#__codelineno-23-210"></a>
<a id="__codelineno-23-211" name="__codelineno-23-211" href="#__codelineno-23-211"></a>                <span class="k">if</span> <span class="n">snapshot_propre</span><span class="p">:</span>
<a id="__codelineno-23-212" name="__codelineno-23-212" href="#__codelineno-23-212"></a>                    <span class="c1"># Restauration (nécessite approbation)</span>
<a id="__codelineno-23-213" name="__codelineno-23-213" href="#__codelineno-23-213"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">demander_approbation</span><span class="p">(</span>
<a id="__codelineno-23-214" name="__codelineno-23-214" href="#__codelineno-23-214"></a>                        <span class="n">destinataires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;proprietaire_donnees@entreprise.ca&quot;</span><span class="p">],</span>
<a id="__codelineno-23-215" name="__codelineno-23-215" href="#__codelineno-23-215"></a>                        <span class="n">sujet</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Approbation restauration </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-23-216" name="__codelineno-23-216" href="#__codelineno-23-216"></a>                        <span class="n">corps</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-217" name="__codelineno-23-217" href="#__codelineno-23-217"></a><span class="s2">                        L&#39;incident </span><span class="si">{</span><span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="si">}</span><span class="s2"> a causé des modifications </span>
<a id="__codelineno-23-218" name="__codelineno-23-218" href="#__codelineno-23-218"></a><span class="s2">                        non autorisées sur </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">.</span>
<a id="__codelineno-23-219" name="__codelineno-23-219" href="#__codelineno-23-219"></a>
<a id="__codelineno-23-220" name="__codelineno-23-220" href="#__codelineno-23-220"></a><span class="s2">                        Snapshot de restauration proposé: </span><span class="si">{</span><span class="n">snapshot_propre</span><span class="si">}</span>
<a id="__codelineno-23-221" name="__codelineno-23-221" href="#__codelineno-23-221"></a>
<a id="__codelineno-23-222" name="__codelineno-23-222" href="#__codelineno-23-222"></a><span class="s2">                        Veuillez approuver ou rejeter la restauration.</span>
<a id="__codelineno-23-223" name="__codelineno-23-223" href="#__codelineno-23-223"></a><span class="s2">                        &quot;&quot;&quot;</span>
<a id="__codelineno-23-224" name="__codelineno-23-224" href="#__codelineno-23-224"></a>                    <span class="p">)</span>
<a id="__codelineno-23-225" name="__codelineno-23-225" href="#__codelineno-23-225"></a>                    <span class="n">actions_remediation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-226" name="__codelineno-23-226" href="#__codelineno-23-226"></a>                        <span class="sa">f</span><span class="s2">&quot;Demande de restauration envoyée pour </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-227" name="__codelineno-23-227" href="#__codelineno-23-227"></a>                    <span class="p">)</span>
<a id="__codelineno-23-228" name="__codelineno-23-228" href="#__codelineno-23-228"></a>
<a id="__codelineno-23-229" name="__codelineno-23-229" href="#__codelineno-23-229"></a>        <span class="c1"># Renforcer les contrôles d&#39;accès</span>
<a id="__codelineno-23-230" name="__codelineno-23-230" href="#__codelineno-23-230"></a>        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-231" name="__codelineno-23-231" href="#__codelineno-23-231"></a>            <span class="c1"># Activer l&#39;audit détaillé si pas déjà actif</span>
<a id="__codelineno-23-232" name="__codelineno-23-232" href="#__codelineno-23-232"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_activer_audit_detaille</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<a id="__codelineno-23-233" name="__codelineno-23-233" href="#__codelineno-23-233"></a>            <span class="n">actions_remediation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-234" name="__codelineno-23-234" href="#__codelineno-23-234"></a>                <span class="sa">f</span><span class="s2">&quot;Audit détaillé activé pour </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-235" name="__codelineno-23-235" href="#__codelineno-23-235"></a>            <span class="p">)</span>
<a id="__codelineno-23-236" name="__codelineno-23-236" href="#__codelineno-23-236"></a>
<a id="__codelineno-23-237" name="__codelineno-23-237" href="#__codelineno-23-237"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-23-238" name="__codelineno-23-238" href="#__codelineno-23-238"></a>            <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;REMEDIATION&quot;</span><span class="p">,</span>
<a id="__codelineno-23-239" name="__codelineno-23-239" href="#__codelineno-23-239"></a>            <span class="s2">&quot;statut&quot;</span><span class="p">:</span> <span class="s2">&quot;EN_COURS&quot;</span><span class="p">,</span>
<a id="__codelineno-23-240" name="__codelineno-23-240" href="#__codelineno-23-240"></a>            <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="n">actions_remediation</span>
<a id="__codelineno-23-241" name="__codelineno-23-241" href="#__codelineno-23-241"></a>        <span class="p">}</span>
<a id="__codelineno-23-242" name="__codelineno-23-242" href="#__codelineno-23-242"></a>
<a id="__codelineno-23-243" name="__codelineno-23-243" href="#__codelineno-23-243"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase_5_recuperation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">IncidentSecurite</span><span class="p">,</span>
<a id="__codelineno-23-244" name="__codelineno-23-244" href="#__codelineno-23-244"></a>                             <span class="n">approbation_restauration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-23-245" name="__codelineno-23-245" href="#__codelineno-23-245"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-246" name="__codelineno-23-246" href="#__codelineno-23-246"></a><span class="sd">        Phase 5 : Récupération et retour à la normale.</span>
<a id="__codelineno-23-247" name="__codelineno-23-247" href="#__codelineno-23-247"></a>
<a id="__codelineno-23-248" name="__codelineno-23-248" href="#__codelineno-23-248"></a><span class="sd">        Actions :</span>
<a id="__codelineno-23-249" name="__codelineno-23-249" href="#__codelineno-23-249"></a><span class="sd">        - Exécuter les restaurations approuvées</span>
<a id="__codelineno-23-250" name="__codelineno-23-250" href="#__codelineno-23-250"></a><span class="sd">        - Rétablir les accès légitimes</span>
<a id="__codelineno-23-251" name="__codelineno-23-251" href="#__codelineno-23-251"></a><span class="sd">        - Valider l&#39;intégrité des données</span>
<a id="__codelineno-23-252" name="__codelineno-23-252" href="#__codelineno-23-252"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-253" name="__codelineno-23-253" href="#__codelineno-23-253"></a>        <span class="n">actions_recuperation</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-23-254" name="__codelineno-23-254" href="#__codelineno-23-254"></a>
<a id="__codelineno-23-255" name="__codelineno-23-255" href="#__codelineno-23-255"></a>        <span class="c1"># Exécuter les restaurations si approuvées</span>
<a id="__codelineno-23-256" name="__codelineno-23-256" href="#__codelineno-23-256"></a>        <span class="k">if</span> <span class="n">approbation_restauration</span><span class="p">:</span>
<a id="__codelineno-23-257" name="__codelineno-23-257" href="#__codelineno-23-257"></a>            <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-258" name="__codelineno-23-258" href="#__codelineno-23-258"></a>                <span class="n">snapshot_propre</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trouver_dernier_snapshot_propre</span><span class="p">(</span>
<a id="__codelineno-23-259" name="__codelineno-23-259" href="#__codelineno-23-259"></a>                    <span class="n">table</span><span class="p">,</span> <span class="n">incident</span><span class="o">.</span><span class="n">timestamp_detection</span>
<a id="__codelineno-23-260" name="__codelineno-23-260" href="#__codelineno-23-260"></a>                <span class="p">)</span>
<a id="__codelineno-23-261" name="__codelineno-23-261" href="#__codelineno-23-261"></a>
<a id="__codelineno-23-262" name="__codelineno-23-262" href="#__codelineno-23-262"></a>                <span class="k">if</span> <span class="n">snapshot_propre</span><span class="p">:</span>
<a id="__codelineno-23-263" name="__codelineno-23-263" href="#__codelineno-23-263"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">spark</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-23-264" name="__codelineno-23-264" href="#__codelineno-23-264"></a><span class="s2">                        CALL system.rollback_to_snapshot(</span>
<a id="__codelineno-23-265" name="__codelineno-23-265" href="#__codelineno-23-265"></a><span class="s2">                            table =&gt; &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;,</span>
<a id="__codelineno-23-266" name="__codelineno-23-266" href="#__codelineno-23-266"></a><span class="s2">                            snapshot_id =&gt; </span><span class="si">{</span><span class="n">snapshot_propre</span><span class="si">}</span>
<a id="__codelineno-23-267" name="__codelineno-23-267" href="#__codelineno-23-267"></a><span class="s2">                        )</span>
<a id="__codelineno-23-268" name="__codelineno-23-268" href="#__codelineno-23-268"></a><span class="s2">                    &quot;&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-23-269" name="__codelineno-23-269" href="#__codelineno-23-269"></a>                    <span class="n">actions_recuperation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-270" name="__codelineno-23-270" href="#__codelineno-23-270"></a>                        <span class="sa">f</span><span class="s2">&quot;Restauration exécutée pour </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-271" name="__codelineno-23-271" href="#__codelineno-23-271"></a>                    <span class="p">)</span>
<a id="__codelineno-23-272" name="__codelineno-23-272" href="#__codelineno-23-272"></a>
<a id="__codelineno-23-273" name="__codelineno-23-273" href="#__codelineno-23-273"></a>        <span class="c1"># Valider l&#39;intégrité des données restaurées</span>
<a id="__codelineno-23-274" name="__codelineno-23-274" href="#__codelineno-23-274"></a>        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">incident</span><span class="o">.</span><span class="n">tables_affectees</span><span class="p">:</span>
<a id="__codelineno-23-275" name="__codelineno-23-275" href="#__codelineno-23-275"></a>            <span class="n">validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_valider_integrite</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<a id="__codelineno-23-276" name="__codelineno-23-276" href="#__codelineno-23-276"></a>            <span class="n">actions_recuperation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-23-277" name="__codelineno-23-277" href="#__codelineno-23-277"></a>                <span class="sa">f</span><span class="s2">&quot;Validation intégrité </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">validation</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-23-278" name="__codelineno-23-278" href="#__codelineno-23-278"></a>            <span class="p">)</span>
<a id="__codelineno-23-279" name="__codelineno-23-279" href="#__codelineno-23-279"></a>
<a id="__codelineno-23-280" name="__codelineno-23-280" href="#__codelineno-23-280"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-23-281" name="__codelineno-23-281" href="#__codelineno-23-281"></a>            <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="s2">&quot;RECUPERATION&quot;</span><span class="p">,</span>
<a id="__codelineno-23-282" name="__codelineno-23-282" href="#__codelineno-23-282"></a>            <span class="s2">&quot;statut&quot;</span><span class="p">:</span> <span class="s2">&quot;COMPLETE&quot;</span><span class="p">,</span>
<a id="__codelineno-23-283" name="__codelineno-23-283" href="#__codelineno-23-283"></a>            <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="n">actions_recuperation</span>
<a id="__codelineno-23-284" name="__codelineno-23-284" href="#__codelineno-23-284"></a>        <span class="p">}</span>
<a id="__codelineno-23-285" name="__codelineno-23-285" href="#__codelineno-23-285"></a>
<a id="__codelineno-23-286" name="__codelineno-23-286" href="#__codelineno-23-286"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">phase_6_lecons_apprises</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">:</span> <span class="n">IncidentSecurite</span><span class="p">,</span>
<a id="__codelineno-23-287" name="__codelineno-23-287" href="#__codelineno-23-287"></a>                                 <span class="n">rapport_complet</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-23-288" name="__codelineno-23-288" href="#__codelineno-23-288"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-23-289" name="__codelineno-23-289" href="#__codelineno-23-289"></a><span class="sd">        Phase 6 : Documentation et amélioration continue.</span>
<a id="__codelineno-23-290" name="__codelineno-23-290" href="#__codelineno-23-290"></a>
<a id="__codelineno-23-291" name="__codelineno-23-291" href="#__codelineno-23-291"></a><span class="sd">        Produit un rapport final incluant :</span>
<a id="__codelineno-23-292" name="__codelineno-23-292" href="#__codelineno-23-292"></a><span class="sd">        - Chronologie complète</span>
<a id="__codelineno-23-293" name="__codelineno-23-293" href="#__codelineno-23-293"></a><span class="sd">        - Cause racine</span>
<a id="__codelineno-23-294" name="__codelineno-23-294" href="#__codelineno-23-294"></a><span class="sd">        - Actions correctives</span>
<a id="__codelineno-23-295" name="__codelineno-23-295" href="#__codelineno-23-295"></a><span class="sd">        - Recommandations</span>
<a id="__codelineno-23-296" name="__codelineno-23-296" href="#__codelineno-23-296"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-23-297" name="__codelineno-23-297" href="#__codelineno-23-297"></a>        <span class="n">rapport_final</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-23-298" name="__codelineno-23-298" href="#__codelineno-23-298"></a>            <span class="s2">&quot;incident_id&quot;</span><span class="p">:</span> <span class="n">incident</span><span class="o">.</span><span class="n">incident_id</span><span class="p">,</span>
<a id="__codelineno-23-299" name="__codelineno-23-299" href="#__codelineno-23-299"></a>            <span class="s2">&quot;date_cloture&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
<a id="__codelineno-23-300" name="__codelineno-23-300" href="#__codelineno-23-300"></a>            <span class="s2">&quot;chronologie&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construire_chronologie</span><span class="p">(</span><span class="n">incident</span><span class="p">),</span>
<a id="__codelineno-23-301" name="__codelineno-23-301" href="#__codelineno-23-301"></a>            <span class="s2">&quot;cause_racine&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="c1"># À compléter par l&#39;analyste</span>
<a id="__codelineno-23-302" name="__codelineno-23-302" href="#__codelineno-23-302"></a>            <span class="s2">&quot;donnees_exposees&quot;</span><span class="p">:</span> <span class="p">[],</span>  <span class="c1"># À évaluer</span>
<a id="__codelineno-23-303" name="__codelineno-23-303" href="#__codelineno-23-303"></a>            <span class="s2">&quot;actions_correctives_implementees&quot;</span><span class="p">:</span> <span class="p">[],</span>
<a id="__codelineno-23-304" name="__codelineno-23-304" href="#__codelineno-23-304"></a>            <span class="s2">&quot;recommandations&quot;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-23-305" name="__codelineno-23-305" href="#__codelineno-23-305"></a>                <span class="s2">&quot;Renforcer la formation des utilisateurs&quot;</span><span class="p">,</span>
<a id="__codelineno-23-306" name="__codelineno-23-306" href="#__codelineno-23-306"></a>                <span class="s2">&quot;Réviser les politiques d&#39;accès&quot;</span><span class="p">,</span>
<a id="__codelineno-23-307" name="__codelineno-23-307" href="#__codelineno-23-307"></a>                <span class="s2">&quot;Augmenter la fréquence des audits&quot;</span>
<a id="__codelineno-23-308" name="__codelineno-23-308" href="#__codelineno-23-308"></a>            <span class="p">],</span>
<a id="__codelineno-23-309" name="__codelineno-23-309" href="#__codelineno-23-309"></a>            <span class="s2">&quot;indicateurs_surveillance&quot;</span><span class="p">:</span> <span class="p">[]</span>
<a id="__codelineno-23-310" name="__codelineno-23-310" href="#__codelineno-23-310"></a>        <span class="p">}</span>
<a id="__codelineno-23-311" name="__codelineno-23-311" href="#__codelineno-23-311"></a>
<a id="__codelineno-23-312" name="__codelineno-23-312" href="#__codelineno-23-312"></a>        <span class="c1"># Stocker le rapport pour référence future</span>
<a id="__codelineno-23-313" name="__codelineno-23-313" href="#__codelineno-23-313"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_archiver_rapport</span><span class="p">(</span><span class="n">rapport_final</span><span class="p">)</span>
<a id="__codelineno-23-314" name="__codelineno-23-314" href="#__codelineno-23-314"></a>
<a id="__codelineno-23-315" name="__codelineno-23-315" href="#__codelineno-23-315"></a>        <span class="c1"># Notifier les parties prenantes de la clôture</span>
<a id="__codelineno-23-316" name="__codelineno-23-316" href="#__codelineno-23-316"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">notifier</span><span class="o">.</span><span class="n">notification_cloture</span><span class="p">(</span>
<a id="__codelineno-23-317" name="__codelineno-23-317" href="#__codelineno-23-317"></a>            <span class="n">destinataires</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;securite@entreprise.ca&quot;</span><span class="p">,</span> 
<a id="__codelineno-23-318" name="__codelineno-23-318" href="#__codelineno-23-318"></a>                          <span class="s2">&quot;gouvernance@entreprise.ca&quot;</span><span class="p">],</span>
<a id="__codelineno-23-319" name="__codelineno-23-319" href="#__codelineno-23-319"></a>            <span class="n">rapport</span><span class="o">=</span><span class="n">rapport_final</span>
<a id="__codelineno-23-320" name="__codelineno-23-320" href="#__codelineno-23-320"></a>        <span class="p">)</span>
<a id="__codelineno-23-321" name="__codelineno-23-321" href="#__codelineno-23-321"></a>
<a id="__codelineno-23-322" name="__codelineno-23-322" href="#__codelineno-23-322"></a>        <span class="k">return</span> <span class="n">rapport_final</span>
</code></pre></div>
<p>Ce framework de réponse aux incidents exploite les capacités uniques du Lakehouse Iceberg. Le time travel permet d'examiner l'état exact des données à tout moment dans le passé. Les tags préservent des points de référence pour l'investigation. L'audit unifié retrace chaque action effectuée. Le lignage identifie l'impact potentiel en cascade sur les systèmes consommateurs.</p>
<hr />
<h2 id="iv136-etudes-de-cas-canadiennes">IV.13.6 Études de Cas Canadiennes<a class="headerlink" href="#iv136-etudes-de-cas-canadiennes" title="Permanent link">&para;</a></h2>
<blockquote>
<p><strong>Étude de cas : Banque Nationale du Canada</strong><br />
<em>Secteur</em> : Services financiers<br />
<em>Défi</em> : Moderniser l'architecture de données pour supporter l'analytique avancée et l'IA tout en maintenant la conformité BSIF, Loi 25 et SOX. L'infrastructure legacy Hadoop/Hive ne supportait pas les exigences de gouvernance granulaire.<br />
<em>Solution</em> : Migration vers un Lakehouse Iceberg sur AWS avec :<br />
- Apache Polaris comme catalogue centralisé avec RBAC et credential vending<br />
- Unity Catalog (Databricks) pour les contrôles fins (RLS, column masking)<br />
- OpenLineage/Marquez pour le lignage de bout en bout<br />
- Pipeline automatisé de conformité Loi 25 (effacement, portabilité)<br />
<em>Architecture</em> :<br />
- 3 environnements isolés (dev, staging, prod) avec politiques RBAC distinctes<br />
- Classification automatique des données via ML (détection PII)<br />
- Chiffrement SSE-KMS avec rotation des clés<br />
- Audit unifié CloudTrail + Polaris + Spark dans une table Iceberg dédiée<br />
<em>Résultats</em> :<br />
- Temps de réponse aux demandes d'accès BSIF réduit de 2 semaines à 4 heures<br />
- 100 % des demandes Loi 25 traitées dans le délai légal de 30 jours<br />
- Réduction de 60 % des coûts de conformité grâce à l'automatisation<br />
- Zero incident de sécurité des données depuis la mise en production</p>
<p><strong>Étude de cas : Hydro-Québec</strong><br />
<em>Secteur</em> : Énergie (société d'État)<br />
<em>Défi</em> : Centraliser les données de 4,3 millions de clients et des réseaux de distribution tout en respectant les exigences de souveraineté des données et la Loi 25. Les données incluent des informations sensibles sur la consommation énergétique des résidences.<br />
<em>Solution</em> : Lakehouse souverain déployé exclusivement dans les régions canadiennes :<br />
- Stockage S3 dans ca-central-1 (Montréal) avec réplication vers ca-west-1 (Calgary)<br />
- Nessie comme catalogue open source avec contrôles d'accès basés sur les branches<br />
- Masquage dynamique des adresses et données de consommation pour les analystes<br />
- Intégration avec le système de gestion des consentements pour la Loi 25<br />
<em>Architecture</em> :<br />
- Séparation physique des données clients (zone restreinte) et données opérationnelles (zone standard)<br />
- Anonymisation automatique des données pour l'analytique générale<br />
- Vues sécurisées pour chaque équipe avec périmètre géographique<br />
- Audit complet avec rétention 10 ans pour conformité Loi sur les archives<br />
<em>Résultats</em> :<br />
- Conformité Loi 25 certifiée par audit externe<br />
- Temps d'extraction pour demandes d'accès réduit de 5 jours à 2 heures<br />
- Démocratisation des données : 200+ analystes avec accès sécurisé (vs 15 auparavant)<br />
- Économies de 2,1 M$ CAD/an en licences et infrastructure</p>
<p><strong>Étude de cas : Shopify</strong><br />
<em>Secteur</em> : Commerce électronique (technologie)<br />
<em>Défi</em> : Gérer les données de millions de marchands et leurs clients à travers le monde, avec conformité multi-juridictionnelle (RGPD, CCPA, Loi 25, LPRPDE). Volume de données massif nécessitant des contrôles d'accès performants.<br />
<em>Solution</em> : Lakehouse global avec gouvernance fédérée :<br />
- Tables Iceberg partitionnées par région géographique pour isolation réglementaire<br />
- Attribute-Based Access Control (ABAC) basé sur les tags de classification<br />
- Pipeline automatisé de « Right to Be Forgotten » traitant 50 000+ demandes/mois<br />
- Système de consentement intégré au pipeline d'ingestion<br />
<em>Architecture</em> :<br />
- Multi-région avec résidence des données (Canada pour marchands canadiens)<br />
- Tags automatiques : PII, FINANCIAL, MERCHANT_CONFIDENTIAL<br />
- Politiques ABAC appliquées à la découverte des tags<br />
- Effacement distribué avec certificats de conformité générés automatiquement<br />
<em>Résultats</em> :<br />
- SLA de 72h pour les demandes d'effacement (vs 30 jours légaux)<br />
- Traitement de 50 000+ demandes de droits/mois entièrement automatisé<br />
- Audit de conformité RGPD/Loi 25 passé sans recommandation majeure<br />
- Réduction de 80 % de l'équipe dédiée à la conformité manuelle</p>
</blockquote>
<hr />
<h2 id="iv137-resume">IV.13.7 Résumé<a class="headerlink" href="#iv137-resume" title="Permanent link">&para;</a></h2>
<p>Ce chapitre a présenté une approche holistique de la sécurité, de la gouvernance et de la conformité du Data Lakehouse. Les points essentiels à retenir sont structurés ci-dessous.</p>
<h3 id="architecture-de-securite-multicouche">Architecture de Sécurité Multicouche<a class="headerlink" href="#architecture-de-securite-multicouche" title="Permanent link">&para;</a></h3>
<p>La sécurité du Lakehouse repose sur quatre couches complémentaires. Le <strong>stockage objet</strong> assure le chiffrement au repos et en transit, l'isolation réseau et les politiques d'accès de base. Le <strong>format de table Iceberg</strong> permet le chiffrement natif des fichiers Parquet avec contrôle par colonne. Le <strong>catalogue</strong> (Polaris, Unity Catalog, Nessie) centralise le RBAC et le credential vending pour une gouvernance cohérente. Les <strong>moteurs de calcul</strong> implémentent les contrôles fins (RLS, masquage) qui nécessitent l'accès aux données.</p>
<p>La séparation des responsabilités entre ces couches permet une défense en profondeur. Une compromission à un niveau est contenue par les contrôles des autres niveaux.</p>
<h3 id="controles-dacces-granulaires">Contrôles d'Accès Granulaires<a class="headerlink" href="#controles-dacces-granulaires" title="Permanent link">&para;</a></h3>
<p>Le RBAC au niveau du catalogue constitue le fondement, contrôlant l'accès aux objets (tables, namespaces). Apache Polaris et Unity Catalog offrent des implémentations matures avec credential vending, éliminant le besoin de distribuer des identifiants permanents.</p>
<p>Le Row-Level Security filtre automatiquement les données visibles selon l'identité de l'utilisateur. Cette approche permet de partager une même table entre équipes avec des périmètres de données différents.</p>
<p>Le Column Masking protège les colonnes sensibles en affichant des valeurs masquées aux utilisateurs non autorisés. Plusieurs patterns de masquage (préservation de format, tokenisation, généralisation) permettent de préserver l'utilité analytique tout en protégeant la confidentialité.</p>
<p>L'ABAC à grande échelle permet de définir des politiques basées sur des tags plutôt que sur des objets individuels. Cette approche simplifie considérablement la gestion pour les organisations avec des milliers de tables.</p>
<h3 id="gouvernance-des-donnees">Gouvernance des Données<a class="headerlink" href="#gouvernance-des-donnees" title="Permanent link">&para;</a></h3>
<p>OpenLineage s'impose comme le standard pour la collecte du lignage à travers les outils et plateformes. L'intégration avec Spark, Flink et Airflow permet de capturer automatiquement les transformations et leurs dépendances.</p>
<p>La qualité des données doit être validée automatiquement à chaque étape du pipeline. Les frameworks comme Great Expectations permettent de définir des « attentes » déclaratives qui sont vérifiées à chaque exécution.</p>
<p>Le catalogage métier complète le catalogue technique en documentant le contexte, la propriété et la classification des données. Cette documentation est essentielle pour la transparence requise par les réglementations.</p>
<h3 id="conformite-canadienne">Conformité Canadienne<a class="headerlink" href="#conformite-canadienne" title="Permanent link">&para;</a></h3>
<p>La Loi 25 du Québec impose des exigences strictes de consentement explicite, droit à l'effacement et portabilité. Ces exigences nécessitent des pipelines automatisés et une gestion rigoureuse des snapshots Iceberg. L'expiration des snapshots après suppression garantit l'effectivité du droit à l'effacement.</p>
<p>La LPRPDE fédérale établit les dix principes fondamentaux que l'architecture doit supporter. Bien que moins stricte que la Loi 25, elle s'applique à toutes les organisations canadiennes dans le secteur privé.</p>
<p>Les directives BSIF (B-13, E-21) ajoutent des exigences de résilience et de gestion des tiers pour les institutions financières. La classification des données selon leur criticité et leur sensibilité guide les contrôles à appliquer.</p>
<h3 id="audit-et-reponse-aux-incidents">Audit et Réponse aux Incidents<a class="headerlink" href="#audit-et-reponse-aux-incidents" title="Permanent link">&para;</a></h3>
<p>La journalisation des accès à plusieurs niveaux (stockage, catalogue, calcul) permet de reconstituer l'activité complète lors d'investigations. L'unification de ces journaux dans une table Iceberg dédiée simplifie l'analyse.</p>
<p>Les alertes proactives détectent les comportements anormaux avant qu'ils ne causent des dommages significatifs. Les patterns à surveiller incluent les accès hors heures normales, les volumes anormaux et les tentatives répétées refusées.</p>
<p>Le framework de réponse aux incidents exploite les capacités uniques du Lakehouse. Le time travel permet d'examiner l'état des données à tout moment. Les tags préservent des points de référence pour l'investigation. La restauration depuis un snapshot antérieur permet de remédier aux modifications non autorisées.</p>
<h3 id="recommandations-strategiques">Recommandations Stratégiques<a class="headerlink" href="#recommandations-strategiques" title="Permanent link">&para;</a></h3>
<p>Pour les organisations qui construisent ou modernisent leur Lakehouse, les recommandations suivantes guident l'approche :</p>
<ol>
<li>
<p><strong>Adopter le credential vending</strong> via un catalogue moderne (Polaris, Unity Catalog) pour éliminer les identifiants permanents distribués aux moteurs de calcul</p>
</li>
<li>
<p><strong>Implémenter la classification automatique</strong> des données dès l'ingestion pour appliquer les contrôles appropriés sans intervention manuelle</p>
</li>
<li>
<p><strong>Automatiser les processus de conformité</strong> (effacement, portabilité, audit) pour respecter les délais légaux et réduire les coûts opérationnels</p>
</li>
<li>
<p><strong>Unifier les journaux d'audit</strong> des différentes couches (stockage, catalogue, calcul) dans une table Iceberg dédiée pour les investigations</p>
</li>
<li>
<p><strong>Documenter les métadonnées métier</strong> dans un catalogue accessible pour permettre la découverte et démontrer la transparence requise par les réglementations</p>
</li>
<li>
<p><strong>Expirer proactivement les snapshots</strong> contenant des données supprimées pour garantir l'effectivité du droit à l'effacement</p>
</li>
<li>
<p><strong>Déployer dans les régions canadiennes</strong> (ca-central-1, ca-west-1 pour AWS; Canada Central, Canada East pour Azure) pour assurer la souveraineté des données et simplifier la conformité</p>
</li>
<li>
<p><strong>Établir un plan de réponse aux incidents</strong> documenté et testé, exploitant les capacités de time travel et d'audit du Lakehouse</p>
</li>
<li>
<p><strong>Former les équipes</strong> aux bonnes pratiques de sécurité et aux exigences réglementaires spécifiques à leur rôle</p>
</li>
<li>
<p><strong>Réviser périodiquement</strong> les politiques d'accès et les classifications de données pour s'assurer qu'elles restent alignées avec les besoins métier et les exigences réglementaires</p>
</li>
</ol>
<p>La sécurité et la gouvernance ne sont pas des projets ponctuels mais des pratiques continues. L'évolution constante des réglementations (modernisation de la LPRPDE, nouvelles directives BSIF) et des menaces de sécurité exige une architecture adaptable et une surveillance vigilante. Le Lakehouse, par sa nature ouverte et sa traçabilité inhérente via les snapshots Iceberg, offre une fondation solide pour cette gouvernance évolutive.</p>
<hr />
<h2 id="references">Références<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Apache Polaris (2025). <em>Documentation officielle</em>. polaris.apache.org</p>
</li>
<li>
<p>Atlan (2025). <em>Apache Iceberg Tables Governance: A Practical Guide</em>. Documentation technique.</p>
</li>
<li>
<p>Dremio (2025). <em>Securing Your Apache Iceberg Data Lakehouse</em>. Blog technique.</p>
</li>
<li>
<p>Dremio (2025). <em>Credential Vending with Iceberg REST Catalogs</em>. Blog technique.</p>
</li>
<li>
<p>OpenLineage (2025). <em>An Open Standard for Data Lineage</em>. Documentation officielle.</p>
</li>
<li>
<p>Databricks (2025). <em>Row Filters and Column Masks in Unity Catalog</em>. Documentation technique.</p>
</li>
<li>
<p>AWS (2025). <em>Governance and Access Control for Apache Iceberg on AWS</em>. Prescriptive Guidance.</p>
</li>
<li>
<p>Commission d'accès à l'information du Québec (2024). <em>Loi 25 - Guide de mise en œuvre</em>. Publication officielle.</p>
</li>
<li>
<p>Bureau du surintendant des institutions financières (2024). <em>Ligne directrice B-13 : Gestion du risque lié aux technologies</em>. Directive réglementaire.</p>
</li>
<li>
<p>Office of the Privacy Commissioner of Canada (2024). <em>PIPEDA in Brief</em>. Guide de conformité.</p>
</li>
</ol>
<hr />
<h3 id="references-croisees">Références croisées<a class="headerlink" href="#references-croisees" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Fondements de la securite informatique</strong> : voir aussi <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.37_Fondements_Securite/">Chapitre 1.37 -- Fondements de la Securite Informatique</a></li>
<li><strong>Conformite reglementaire et confidentialite</strong> : voir aussi <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.15_Conformite_Reglementaire_Gestion_Confidentialite/">Chapitre II.15 -- Conformite Reglementaire et Gestion de la Confidentialite</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Retour en haut de la page
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/agbruneau/CorpusInformatique" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "toc.integrate", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>