
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Corpus encyclopédique francophone — science informatique, interopérabilité et entreprise agentique">
      
      
        <meta name="author" content="André-Guy Bruneau">
      
      
        <link rel="canonical" href="https://agbruneau.github.io/CorpusInformatique/III%20-%20Entreprise%20Agentique/Volume_III_Apache_Kafka_Guide_Architecte/Chapitre_III.8_Conception_Application_Streaming/">
      
      
        <link rel="prev" href="../Chapitre_III.7_Patrons_Interaction_Kafka/">
      
      
        <link rel="next" href="../Chapitre_III.9_Gestion_Kafka_Entreprise/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>III.8 — Conception d'application streaming - Corpus Informatique</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapitre-iii8-conception-dapplication-de-traitement-de-flux-en-continu" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../.." title="Corpus Informatique" class="md-header__button md-logo" aria-label="Corpus Informatique" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Corpus Informatique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              III.8 — Conception d'application streaming
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/agbruneau/CorpusInformatique" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agbruneau/CorpusInformatique
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.1_Fondements_Logiques_Raisonnement/" class="md-tabs__link">
          
  
  
    
  
  I — Science et Génie Informatique

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.1_Introduction_Problematique/" class="md-tabs__link">
          
  
  
    
  
  II — Interopérabilité

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.1_Crise_Integration_Systemique/" class="md-tabs__link">
          
  
  
    
  
  III — Entreprise Agentique

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Corpus Informatique" class="md-nav__button md-logo" aria-label="Corpus Informatique" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Corpus Informatique
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/agbruneau/CorpusInformatique" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    agbruneau/CorpusInformatique
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    I — Science et Génie Informatique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    I — Science et Génie Informatique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume I — Fondements Mathématiques et Théorie de l'Informatique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume I — Fondements Mathématiques et Théorie de l'Informatique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.1_Fondements_Logiques_Raisonnement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.1 — Fondements logiques et raisonnement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.2_Structures_Discretes_Combinatoire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.2 — Structures discrètes et combinatoire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.3_Theorie_Graphes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.3 — Théorie des graphes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.4_Langages_Formels_Automates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.4 — Langages formels et automates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.5_Calculabilite_Decidabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.5 — Calculabilité et décidabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_I_Fondements_Mathematiques_Theorie/Chapitre_I.6_Theorie_Complexite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.6 — Théorie de la complexité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume II — Architecture des Ordinateurs et Systèmes Numériques
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume II — Architecture des Ordinateurs et Systèmes Numériques
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.7_Systemes_Numeriques_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.7 — Systèmes numériques et données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.8_Circuits_Combinatoires/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.8 — Circuits combinatoires
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.9_Circuits_Sequentiels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.9 — Circuits séquentiels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.10_Conception_Systeme_HDL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.10 — Conception système HDL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.11_Architecture_ISA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.11 — Architecture ISA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.12_Conception_CPU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.12 — Conception CPU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.13_Parallelisme_ILP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.13 — Parallélisme ILP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.14_Hierarchie_Memoire_Stockage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.14 — Hiérarchie mémoire et stockage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_II_Architecture_Ordinateurs_Systemes_Numeriques/Chapitre_I.15_Systemes_IO_Accelere/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.15 — Systèmes I/O accélérés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume III — Systèmes d'Exploitation, Langages et Environnements
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume III — Systèmes d'Exploitation, Langages et Environnements
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.16_Systemes_Exploitation_OS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.16 — Systèmes d'exploitation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.17_Gestion_Concurrence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.17 — Gestion de la concurrence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.18_Gestion_Memoire_Fichiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.18 — Gestion mémoire et fichiers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.19_Conception_Langages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.19 — Conception des langages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.20_Compilation_Interpretation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.20 — Compilation et interprétation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_III_Systemes_Exploitation_Langages_Environnements/Chapitre_I.21_Environnements_Virtualisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.21 — Environnements et virtualisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume IV — Structures de Données, Algorithmique et Génie Logiciel
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume IV — Structures de Données, Algorithmique et Génie Logiciel
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.22_Structures_Donnees_Fondamentales/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.22 — Structures de données fondamentales
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.23_Structures_Donnees_Avancees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.23 — Structures de données avancées
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.24_Conception_Analyse_Algorithmes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.24 — Conception et analyse d'algorithmes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.25_Algorithmes_Graphes_Avances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.25 — Algorithmes de graphes avancés
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.26_Processus_Developpement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.26 — Processus de développement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.27_Architecture_Logicielle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.27 — Architecture logicielle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.28_Qualite_Test_Maintenance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.28 — Qualité, test et maintenance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IV_Structures_Donnees_Algorithmique_Genie_Logiciel/Chapitre_I.29_DevOps_SRE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.29 — DevOps et SRE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume V — Données, Réseaux, Cloud et Sécurité
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume V — Données, Réseaux, Cloud et Sécurité
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.30_SGBD_Fondements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.30 — SGBD fondements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.31_SGBD_Implementation_Transactions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.31 — SGBD implémentation et transactions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.32_Donnees_Modernes_BigData/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.32 — Données modernes et Big Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.33_Fondements_Reseaux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.33 — Fondements des réseaux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.34_Protocoles_Internetworking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.34 — Protocoles et internetworking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.35_Systemes_Distribues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.35 — Systèmes distribués
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.36_Cloud_Infrastructures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.36 — Cloud et infrastructures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.37_Fondements_Securite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.37 — Fondements de la sécurité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.38_Cryptographie_Appliquee/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.38 — Cryptographie appliquée
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.39_Securite_Reseaux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.39 — Sécurité des réseaux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_V_Donnees_Reseaux_Cloud_Securite/Chapitre_I.40_Securite_Systemes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.40 — Sécurité des systèmes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume VI — Intelligence Artificielle et Systèmes Interactifs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume VI — Intelligence Artificielle et Systèmes Interactifs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.41_Fondements_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.41 — Fondements de l'IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.42_Connaissance_Raisonnement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.42 — Connaissance et raisonnement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.43_ML_Fondements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.43 — ML fondements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.44_DeepLearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.44 — Deep Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.45_Reinforcement_Learning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.45 — Reinforcement Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.46_TALN_NLP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.46 — TALN / NLP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.47_Vision_Ordinateur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.47 — Vision par ordinateur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.48_Infographie_Visualisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.48 — Infographie et visualisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.49_IHM_HCI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.49 — IHM / HCI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VI_Intelligence_Artificielle_Systemes_Interactifs/Chapitre_I.50_Robotique_IoT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.50 — Robotique et IoT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume VII — Technologies Émergentes et Frontières
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume VII — Technologies Émergentes et Frontières
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.51_Informatique_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.51 — Informatique quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.52_Algorithmes_Cryptographie_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.52 — Algorithmes et cryptographie quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.53_HPC_Exascale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.53 — HPC et exascale
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.54_Architectures_Post_Moore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.54 — Architectures post-Moore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.55_Modeles_Fondateurs_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.55 — Modèles fondateurs IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.56_AGI_Alignement_Securite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.56 — AGI, alignement et sécurité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.57_Sciences_Computationnelles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.57 — Sciences computationnelles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.58_CyberPhysiques_Jumeaux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.58 — Systèmes cyber-physiques et jumeaux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.59_Web3_Decentralise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.59 — Web3 et décentralisé
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VII_Technologies_Emergentes_Frontieres/Chapitre_I.60_Synthese_Frontieres/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.60 — Synthèse et frontières
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_8" >
        
          
          <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume VIII — Convergence AGI–Quantique : Fondements et Algorithmes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume VIII — Convergence AGI–Quantique : Fondements et Algorithmes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.61_Introduction_Informatique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.61 — Introduction à l'informatique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.62_Convergence_AGI_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.62 — Convergence AGI-quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.63_Evolution_IA_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.63 — Évolution IA-quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.64_Reseaux_Neuronaux_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.64 — Réseaux neuronaux quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.65_Algorithmes_Evolutionnaires_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.65 — Algorithmes évolutionnaires quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.66_Renforcement_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.66 — Renforcement quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.67_Architectures_Hybrides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.67 — Architectures hybrides
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.68_SVM_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.68 — SVM quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.69_Codage_Donnees_Quantiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.69 — Codage de données quantiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_VIII_Convergence_AGI_Quantique_Fondements/Chapitre_I.70_Scalabilite_Correction_Erreurs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.70 — Scalabilité et correction d'erreurs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_9" >
        
          
          <label class="md-nav__link" for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume IX — Convergence AGI–Quantique : Applications et Perspectives
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume IX — Convergence AGI–Quantique : Applications et Perspectives
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.71_TALN_Quantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.71 — TALN quantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.72_Securite_Confidentialite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.72 — Sécurité et confidentialité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.73_Ethique_Reglementaire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.73 — Éthique et réglementaire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.74_Implementation_Materielle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.74 — Implémentation matérielle
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.75_Middleware_Software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.75 — Middleware et software
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.76_Etudes_Cas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.76 — Études de cas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.77_Durabilite_Energie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.77 — Durabilité et énergie
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.78_Metriques_Bancs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.78 — Métriques et bancs d'essai
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.79_Perspectives_Avenir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.79 — Perspectives d'avenir
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../I%20-%20Science%20et%20G%C3%A9nie%20Informatique/Volume_IX_Convergence_AGI_Quantique_Applications/Chapitre_I.80_Infrastructure_Centres_Donnees_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.80 — Infrastructure et centres de données IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    II — Interopérabilité
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    II — Interopérabilité
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.1_Introduction_Problematique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.1 — Introduction et problématique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.2_Fondements_Theoriques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.2 — Fondements théoriques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.3_Integration_Applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.3 — Intégration des applications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.4_Integration_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.4 — Intégration des données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.5_Integration_Evenements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.5 — Intégration des événements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.6_Standards_Contrats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.6 — Standards et contrats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.7_Resilience_Observabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.7 — Résilience et observabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.8_Collaboration_Automatisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.8 — Collaboration et automatisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.9_Architecture_Reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.9 — Architecture de référence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.10_Order_to_Cash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.10 — Order-to-Cash
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.11_Entreprise_Agentique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.11 — Entreprise agentique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.12_Securite_Identite_Conformite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.12 — Sécurité, identité et conformité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../II%20-%20Interop%C3%A9rabilit%C3%A9/Chapitre_II.A_Annexes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annexes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    III — Entreprise Agentique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    III — Entreprise Agentique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume I — Fondations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume I — Fondations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.1_Crise_Integration_Systemique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.1 — Crise d'intégration systémique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.2_Fondements_Dimensions_Interoperabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.2 — Fondements et dimensions de l'interopérabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.3_Cadres_Reference_Standards_Maturite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.3 — Cadres de référence, standards et maturité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.4_Principes_Architecture_Reactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.4 — Principes d'architecture réactive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.5_Ecosysteme_API/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.5 — Écosystème API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.6_Architecture_Evenements_EDA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.6 — Architecture événements (EDA)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.7_Contrats_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.7 — Contrats de données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.8_Conception_Implementation_Observabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.8 — Conception et implémentation de l'observabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.9_Etudes_Cas_Architecturales/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.9 — Études de cas architecturales
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.10_Limites_Interoperabilite_Semantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.10 — Limites de l'interopérabilité sémantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.11_IA_Moteur_Interoperabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.11 — IA moteur d'interopérabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.12_Definition_Interoperabilite_Cognitivo_Adaptative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.12 — Définition de l'interopérabilité cognitivo-adaptative
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.13_Ere_IA_Agentique_Modele_Travailleur_Numerique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.13 — Ère IA agentique et modèle du travailleur numérique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.14_Maillage_Agentique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.14 — Maillage agentique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.15_Ingenierie_Systemes_Cognitifs_Protocoles_Interaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.15 — Ingénierie des systèmes cognitifs et protocoles d'interaction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.16_Modele_Operationnel_Symbiose_Humain_Agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.16 — Modèle opérationnel de symbiose humain-agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.17_Gouvernance_Constitutionnelle_Alignement_IA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.17 — Gouvernance constitutionnelle et alignement IA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.18_AgentOps_Industrialisation_Securisation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.18 — AgentOps : industrialisation et sécurisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.19_Architecte_Intentions_Role_Sociotechnique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.19 — Architecte des intentions : rôle sociotechnique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.20_Cockpit_Berger_Intention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.20 — Cockpit du berger d'intention
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.21_Feuille_Route_Transformation_Agentique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.21 — Feuille de route de la transformation agentique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.22_Gestion_Strategique_Portefeuille_Applicatif_APM_Cognitif/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.22 — Gestion stratégique du portefeuille applicatif (APM cognitif)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.23_Patrons_Modernisation_Agentification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.23 — Patrons de modernisation et agentification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.24_Industrialisation_Ingenierie_Plateforme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.24 — Industrialisation et ingénierie de plateforme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.25_Economie_Cognitive_Diplomatie_Algorithmique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.25 — Économie cognitive et diplomatie algorithmique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.26_Gestion_Risques_Systemiques_Superalignement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.26 — Gestion des risques systémiques et superalignement
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.27_Prospective_Agent_Auto_Architecturant_AGI_Entreprise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.27 — Prospective : agent auto-architecturant et AGI d'entreprise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_I_Fondations_Entreprise_Agentique/Chapitre_I.28_Conclusion_Architecture_Intentionnelle_Sagesse_Collective/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    I.28 — Conclusion : architecture intentionnelle et sagesse collective
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume II — Infrastructure Agentique
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume II — Infrastructure Agentique
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.1_Ingenierie_Plateforme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.1 — Ingénierie de plateforme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.2_Fondamentaux_Apache_Kafka_Confluent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.2 — Fondamentaux Apache Kafka et Confluent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.3_Conception_Modelisation_Flux_Evenements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.3 — Conception et modélisation des flux d'événements
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.4_Contrats_Donnees_Gouvernance_Semantique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.4 — Contrats de données et gouvernance sémantique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.5_Flux_Temps_Reel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.5 — Flux temps réel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.6_Google_Cloud_Vertex_AI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.6 — Google Cloud et Vertex AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.7_Ingenierie_Contexte_RAG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.7 — Ingénierie de contexte et RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.8_Integration_Backbone_Evenementiel_Couche_Cognitive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.8 — Intégration backbone événementiel et couche cognitive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.9_Patrons_Architecturaux_Avances_AEM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.9 — Patrons architecturaux avancés (AEM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.10_Pipelines_CI_CD_Deploiement_Agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.10 — Pipelines CI/CD et déploiement d'agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.11_Observabilite_Comportementale_Monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.11 — Observabilité comportementale et monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.12_Tests_Evaluation_Simulation_Systemes_Multi_Agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.12 — Tests, évaluation et simulation de systèmes multi-agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.13_Paysage_Menaces_Securite_Systemes_Agentiques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.13 — Paysage des menaces et sécurité des systèmes agentiques
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.14_Securisation_Infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.14 — Sécurisation de l'infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_II_Infrastructure_Agentique/Chapitre_II.15_Conformite_Reglementaire_Gestion_Confidentialite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    II.15 — Conformité réglementaire et gestion de la confidentialité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume III — Apache Kafka : Guide de l'Architecte
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume III — Apache Kafka : Guide de l'Architecte
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.1_Decouvrir_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.1 — Découvrir Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.2_Architecture_Cluster_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.2 — Architecture du cluster Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.3_Clients_Kafka_Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.3 — Clients Kafka en production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.4_Applications_Consommatrices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.4 — Applications consommatrices
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.5_Cas_Utilisation_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.5 — Cas d'utilisation Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.6_Contrats_Donnees/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.6 — Contrats de données
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.7_Patrons_Interaction_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.7 — Patrons d'interaction Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    III.8 — Conception d'application streaming
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    III.8 — Conception d'application streaming
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii81-lere-du-temps-reel-du-batch-au-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.1 L'Ère du Temps Réel : Du Batch au Streaming
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.1 L&#39;Ère du Temps Réel : Du Batch au Streaming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#la-transformation-du-paradigme-de-traitement" class="md-nav__link">
    <span class="md-ellipsis">
      
        La Transformation du Paradigme de Traitement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-limites-intrinseques-du-batch-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Les Limites Intrinsèques du Batch Processing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lemergence-du-paradigme-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        L'Émergence du Paradigme Streaming
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#la-convergence-batch-et-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        La Convergence Batch et Streaming
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-cas-dusage-transformateurs-du-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        Les Cas d'Usage Transformateurs du Streaming
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii82-introduction-a-kafka-streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.2 Introduction à Kafka Streams
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.2 Introduction à Kafka Streams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#philosophie-et-positionnement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Philosophie et Positionnement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#caracteristiques-fondamentales" class="md-nav__link">
    <span class="md-ellipsis">
      
        Caractéristiques Fondamentales
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-de-haut-niveau" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture de Haut Niveau
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modele-de-programmation-dual" class="md-nav__link">
    <span class="md-ellipsis">
      
        Modèle de Programmation Dual
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evolutions-recentes-de-kafka-streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        Évolutions Récentes de Kafka Streams
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii83-architecture-et-concepts-cles" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.3 Architecture et Concepts Clés
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.3 Architecture et Concepts Clés">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#topologie-de-traitement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Topologie de Traitement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Topologie de Traitement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anatomie-dune-topologie" class="md-nav__link">
    <span class="md-ellipsis">
      
        Anatomie d'une Topologie
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimisation-de-la-topologie" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimisation de la Topologie
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flux-et-tables-la-dualite-fondamentale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flux et Tables : La Dualité Fondamentale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions-et-parallelisme" class="md-nav__link">
    <span class="md-ellipsis">
      
        Partitions et Parallélisme
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magasins-detat-state-stores" class="md-nav__link">
    <span class="md-ellipsis">
      
        Magasins d'État (State Stores)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Magasins d&#39;État (State Stores)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-de-magasins-detat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Types de Magasins d'État
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimisation-rocksdb" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimisation RocksDB
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#semantique-temporelle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sémantique Temporelle
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii84-developpement-dapplications" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.4 Développement d'Applications
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.4 Développement d&#39;Applications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure-dune-application-kafka-streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        Structure d'une Application Kafka Streams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformations-stateless" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transformations Stateless
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transformations-stateful" class="md-nav__link">
    <span class="md-ellipsis">
      
        Transformations Stateful
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jointures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jointures
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Jointures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#globalktable-pour-les-donnees-de-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        GlobalKTable pour les Données de Référence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#considerations-sur-le-co-partitionnement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Considérations sur le Co-partitionnement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serdes-personnalises" class="md-nav__link">
    <span class="md-ellipsis">
      
        SerDes Personnalisés
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-avec-schema-registry" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intégration avec Schema Registry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bonnes-pratiques-de-serialisation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bonnes Pratiques de Sérialisation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii85-gestion-de-letat-coherence-et-tolerance-aux-pannes" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.5 Gestion de l'État, Cohérence et Tolérance aux Pannes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.5 Gestion de l&#39;État, Cohérence et Tolérance aux Pannes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mecanismes-de-persistance-de-letat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mécanismes de Persistance de l'État
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garanties-de-traitement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Garanties de Traitement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restauration-et-recuperation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Restauration et Récupération
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coherence-et-ordering" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cohérence et Ordering
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cohérence et Ordering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gestion-des-evenements-tardifs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestion des Événements Tardifs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idempotence-et-deduplication" class="md-nav__link">
    <span class="md-ellipsis">
      
        Idempotence et Déduplication
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii86-positionnement-dans-lecosysteme" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.6 Positionnement dans l'Écosystème
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.6 Positionnement dans l&#39;Écosystème">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comparaison-avec-apache-flink" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparaison avec Apache Flink
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparaison-avec-ksqldb" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparaison avec ksqlDB
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-avec-lecosysteme-kafka" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intégration avec l'Écosystème Kafka
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-avec-schema-registry_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intégration avec Schema Registry
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patterns-darchitecture-avec-kafka-streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        Patterns d'Architecture avec Kafka Streams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-avec-lintelligence-artificielle-et-le-machine-learning" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intégration avec l'Intelligence Artificielle et le Machine Learning
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intégration avec l&#39;Intelligence Artificielle et le Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feature-engineering-en-temps-reel" class="md-nav__link">
    <span class="md-ellipsis">
      
        Feature Engineering en Temps Réel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inference-de-modeles-en-streaming" class="md-nav__link">
    <span class="md-ellipsis">
      
        Inférence de Modèles en Streaming
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-a-jour-des-modeles-en-production" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mise à Jour des Modèles en Production
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii87-considerations-operationnelles" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.7 Considérations Opérationnelles
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.7 Considérations Opérationnelles">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dimensionnement-et-capacite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dimensionnement et Capacité
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#surveillance-et-metriques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Surveillance et Métriques
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-et-mise-a-lechelle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Déploiement et Mise à l'Échelle
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement et Mise à l&#39;Échelle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pieges-courants-a-eviter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pièges Courants à Éviter
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploiement-sur-kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Déploiement sur Kubernetes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Déploiement sur Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-kubernetes-de-base" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration Kubernetes de Base
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-de-letat-avec-des-volumes-persistants" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestion de l'État avec des Volumes Persistants
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-scaling-horizontal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auto-scaling Horizontal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-des-erreurs-et-resilience" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestion des Erreurs et Résilience
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tests-des-applications-kafka-streams" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tests des Applications Kafka Streams
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debogage-et-analyse-post-mortem" class="md-nav__link">
    <span class="md-ellipsis">
      
        Débogage et Analyse Post-Mortem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enrichissement-avec-calcul-de-risque" class="md-nav__link">
    <span class="md-ellipsis">
      
        Enrichissement avec Calcul de Risque
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interactive-queries-pour-acces-direct" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interactive Queries pour Accès Direct
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecons-et-bonnes-pratiques" class="md-nav__link">
    <span class="md-ellipsis">
      
        Leçons et Bonnes Pratiques
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gestion-de-la-retrocompatibilite-et-de-levolution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gestion de la Rétrocompatibilité et de l'Évolution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#considerations-de-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Considérations de Performance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supervision-et-alerting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Supervision et Alerting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iii89-resume" class="md-nav__link">
    <span class="md-ellipsis">
      
        III.8.9 Résumé
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="III.8.9 Résumé">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fondements-conceptuels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Fondements Conceptuels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture-et-traitement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture et Traitement
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#garanties-et-fiabilite" class="md-nav__link">
    <span class="md-ellipsis">
      
        Garanties et Fiabilité
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#positionnement-ecosysteme" class="md-nav__link">
    <span class="md-ellipsis">
      
        Positionnement Écosystème
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#considerations-operationnelles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Considérations Opérationnelles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evolutions-et-tendances" class="md-nav__link">
    <span class="md-ellipsis">
      
        Évolutions et Tendances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommandations-pour-les-architectes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommandations pour les Architectes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perspectives-futures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Perspectives Futures
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.9_Gestion_Kafka_Entreprise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.9 — Gestion Kafka en entreprise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.10_Organisation_Projet_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.10 — Organisation d'un projet Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.11_Operer_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.11 — Opérer Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapitre_III.12_Avenir_Kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    III.12 — L'avenir de Kafka
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume IV — Apache Iceberg et Lakehouse
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume IV — Apache Iceberg et Lakehouse
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.1_Monde_Lakehouse_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.1 — Le monde Lakehouse et Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.2_Anatomie_Technique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.2 — Anatomie technique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.3_Mise_Pratique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.3 — Mise en pratique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.4_Preparer_Passage_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.4 — Préparer le passage à Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.5_Selection_Couche_Stockage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.5 — Sélection de la couche de stockage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.6_Architecture_Couche_Ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.6 — Architecture de la couche d'ingestion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.7_Implementation_Couche_Catalogue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.7 — Implémentation de la couche catalogue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.8_Conception_Couche_Federation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.8 — Conception de la couche de fédération
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.9_Comprendre_Couche_Consommation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.9 — Comprendre la couche de consommation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.10_Maintenir_Lakehouse_Production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.10 — Maintenir le Lakehouse en production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.11_Operationnaliser_Apache_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.11 — Opérationnaliser Apache Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.12_Evolution_Streaming_Lakehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.12 — Évolution du streaming Lakehouse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.13_Securite_Gouvernance_Conformite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.13 — Sécurité, gouvernance et conformité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.14_Integration_Microsoft_Fabric_PowerBI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.14 — Intégration Microsoft Fabric et Power BI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.15_Contexte_Canadien_Etudes_Cas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.15 — Contexte canadien et études de cas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.16_Conclusion_Perspectives_2026_2030/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IV.16 — Conclusion et perspectives 2026-2030
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.Annexe_A_Specification_Apache_Iceberg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annexe A — Spécification Apache Iceberg
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_IV_Apache_Iceberg_Lakehouse/Chapitre_IV.Annexe_B_Glossaire/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annexe B — Glossaire
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Volume V — Développeur Renaissance
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Volume V — Développeur Renaissance
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.0_Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.0 — Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.1_Convergence_Ages_Or/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.1 — Convergence des âges d'or
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.2_Curiosite_Appliquee/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.2 — Curiosité appliquée
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.3_Pensee_Systemique/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.3 — Pensée systémique
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.4_Nouvelle_Communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.4 — Nouvelle communication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.5_Imperatif_Qualite_Responsabilite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.5 — Impératif qualité et responsabilité
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.6_Capital_Humain_Profil_Polymathe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.6 — Capital humain et profil polymathe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.7_Art_Batir_Futur/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.7 — L'art de bâtir le futur
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.8_Bibliotheque_Developpeur_Renaissance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.8 — Bibliothèque du développeur Renaissance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.9_Mandat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.9 — Mandat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Volume_V_Developpeur_Renaissance/Chapitre_V.10_Spec_Driven_Development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    V.10 — Spec-Driven Development
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="chapitre-iii8-conception-dapplication-de-traitement-de-flux-en-continu">Chapitre III.8 - CONCEPTION D'APPLICATION DE TRAITEMENT DE FLUX EN CONTINU<a class="headerlink" href="#chapitre-iii8-conception-dapplication-de-traitement-de-flux-en-continu" title="Permanent link">&para;</a></h1>
<hr />
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Le traitement de flux en continu représente l'une des évolutions les plus significatives de l'architecture des systèmes d'information des deux dernières décennies. Alors que les entreprises accumulent des volumes de données toujours croissants, la capacité à extraire de la valeur de ces données en temps réel devient un avantage concurrentiel déterminant. Les organisations qui maîtrisent le traitement en continu peuvent réagir instantanément aux événements métier, détecter les anomalies dès leur apparition et offrir des expériences personnalisées à leurs clients au moment précis où celles-ci importent le plus.</p>
<p>Apache Kafka, en tant que plateforme de streaming événementiel de référence, a introduit Kafka Streams comme bibliothèque native de traitement de flux. Cette bibliothèque incarne une philosophie architecturale distinctive : plutôt que de déployer un système de traitement séparé avec ses propres contraintes opérationnelles, Kafka Streams s'intègre directement dans les applications Java et Scala existantes. Cette approche élimine la complexité d'un système distribué additionnel tout en préservant les garanties de fiabilité et de performance que les architectes exigent des systèmes de production.</p>
<p>Ce chapitre explore en profondeur la conception d'applications de traitement de flux avec Kafka Streams. Nous examinerons d'abord la transition paradigmatique du traitement par lots vers le streaming, avant de plonger dans l'architecture fondamentale de Kafka Streams. Les sections suivantes couvriront le développement d'applications, la gestion de l'état, le positionnement dans l'écosystème des outils de streaming, les considérations opérationnelles critiques, et un cas d'usage concret illustrant l'implémentation d'une vue client 360 en temps réel.</p>
<hr />
<h2 id="iii81-lere-du-temps-reel-du-batch-au-streaming">III.8.1 L'Ère du Temps Réel : Du Batch au Streaming<a class="headerlink" href="#iii81-lere-du-temps-reel-du-batch-au-streaming" title="Permanent link">&para;</a></h2>
<h3 id="la-transformation-du-paradigme-de-traitement">La Transformation du Paradigme de Traitement<a class="headerlink" href="#la-transformation-du-paradigme-de-traitement" title="Permanent link">&para;</a></h3>
<p>Pendant des décennies, le traitement par lots a constitué le paradigme dominant de l'analyse de données en entreprise. Les architectures traditionnelles collectaient les données tout au long de la journée pour les traiter durant des fenêtres nocturnes, produisant des rapports et des analyses disponibles le lendemain matin. Ce modèle, bien que fonctionnel, impose une latence inhérente qui devient de plus en plus problématique dans un environnement commercial où les décisions doivent être prises en millisecondes plutôt qu'en heures.</p>
<p>L'émergence du traitement de flux en continu représente une rupture fondamentale avec cette approche. Plutôt que d'accumuler les données pour un traitement différé, les systèmes de streaming traitent chaque événement dès son arrivée, permettant des réponses instantanées aux conditions changeantes. Cette transformation ne constitue pas simplement une optimisation technique ; elle redéfinit les possibilités métier elles-mêmes.</p>
<blockquote>
<p><strong>Perspective stratégique</strong>
La capacité à traiter les données en temps réel transforme fondamentalement la proposition de valeur d'une entreprise. Une banque qui détecte la fraude en quelques millisecondes plutôt qu'en quelques heures peut prévenir les pertes avant qu'elles ne se produisent. Un détaillant qui personnalise l'expérience d'achat en temps réel peut augmenter significativement ses taux de conversion. Le streaming n'est pas une amélioration incrémentale ; c'est un changement de paradigme qui crée de nouvelles catégories de valeur métier.</p>
</blockquote>
<h3 id="les-limites-intrinseques-du-batch-processing">Les Limites Intrinsèques du Batch Processing<a class="headerlink" href="#les-limites-intrinseques-du-batch-processing" title="Permanent link">&para;</a></h3>
<p>Le traitement par lots souffre de plusieurs limitations structurelles qui deviennent de plus en plus contraignantes dans l'environnement numérique moderne. La première concerne la latence irréductible : même avec des optimisations agressives, le batch impose un délai entre l'occurrence d'un événement et sa prise en compte dans les analyses. Pour certains cas d'usage, cette latence est acceptable. Pour d'autres, elle rend le système fondamentalement inadapté.</p>
<p>La deuxième limitation concerne l'utilisation des ressources. Les architectures batch créent des pics de charge prévisibles mais intenses, suivis de périodes d'inactivité. Cette variabilité complique le dimensionnement de l'infrastructure et conduit souvent à un surdimensionnement coûteux pour absorber les pointes de traitement.</p>
<p>La troisième limitation touche à la complexité de la gestion des données en mouvement. Lorsqu'un système batch traite des données qui ont changé depuis le début du traitement, des incohérences peuvent apparaître. Les mécanismes de réconciliation nécessaires ajoutent une complexité significative aux pipelines de données.</p>
<h3 id="lemergence-du-paradigme-streaming">L'Émergence du Paradigme Streaming<a class="headerlink" href="#lemergence-du-paradigme-streaming" title="Permanent link">&para;</a></h3>
<p>Le traitement de flux en continu inverse fondamentalement l'approche du batch. Plutôt que de considérer les données comme des ensembles statiques à traiter périodiquement, le streaming traite les données comme des flux continus d'événements. Chaque événement est traité dès son arrivée, et les résultats sont disponibles immédiatement.</p>
<p>Cette approche apporte plusieurs avantages architecturaux majeurs. La latence devient minimale, limitée uniquement par le temps de traitement de chaque événement plutôt que par des fenêtres de batch arbitraires. L'utilisation des ressources devient plus uniforme, éliminant les pics et les creux caractéristiques du batch. La gestion des données en mouvement devient naturelle, car le système est conçu dès le départ pour traiter des flux plutôt que des instantanés.</p>
<p>Le streaming introduit également de nouveaux défis. La gestion de l'état dans un contexte distribué devient plus complexe. Les garanties de traitement exact-une-fois (exactly-once) requièrent des mécanismes sophistiqués. La récupération après panne doit être conçue avec soin pour préserver la cohérence des résultats.</p>
<h3 id="la-convergence-batch-et-streaming">La Convergence Batch et Streaming<a class="headerlink" href="#la-convergence-batch-et-streaming" title="Permanent link">&para;</a></h3>
<p>L'évolution récente de l'industrie montre une convergence entre les paradigmes batch et streaming. Les architectures modernes reconnaissent que ces deux approches ne sont pas mutuellement exclusives mais complémentaires. Le streaming excelle pour le traitement à faible latence des événements récents, tandis que le batch reste pertinent pour les analyses historiques profondes et les retraitements massifs.</p>
<p>Cette convergence se manifeste notamment dans le concept d'architecture Lambda, qui maintient des pipelines parallèles pour le batch et le streaming, et plus récemment dans l'architecture Kappa, qui unifie les deux approches autour d'un journal d'événements immuable. Apache Kafka, avec Kafka Streams, se positionne naturellement dans cette convergence en permettant le traitement de flux tout en préservant l'historique complet des événements pour d'éventuels retraitements.</p>
<h3 id="les-cas-dusage-transformateurs-du-streaming">Les Cas d'Usage Transformateurs du Streaming<a class="headerlink" href="#les-cas-dusage-transformateurs-du-streaming" title="Permanent link">&para;</a></h3>
<p>Le traitement en temps réel débloque des catégories entières de cas d'usage impossibles avec le batch. La détection de fraude illustre parfaitement cette transformation : une transaction frauduleuse détectée en 50 millisecondes peut être bloquée avant qu'elle ne soit complétée, alors qu'une détection après 24 heures ne permet que de constater les dégâts.</p>
<p>La personnalisation en temps réel constitue un autre exemple emblématique. Un site de commerce électronique qui ajuste ses recommandations pendant la navigation d'un utilisateur peut augmenter significativement ses taux de conversion. Cette personnalisation requiert la capacité de traiter les clics, les recherches et les comportements de navigation en quelques millisecondes.</p>
<p>La surveillance opérationnelle et l'observabilité bénéficient également du streaming. Les équipes DevOps modernes s'attendent à voir les métriques et les alertes en temps réel, pas dans un rapport du lendemain. Le traitement de flux permet de détecter les anomalies, de corréler les événements et de déclencher des alertes instantanément.</p>
<p>L'Internet des Objets (IoT) représente peut-être le cas d'usage le plus naturel pour le streaming. Les capteurs génèrent des flux continus de données qui doivent être traitées immédiatement pour être utiles. Une alerte de température critique dans un entrepôt frigorifique perd toute sa valeur si elle arrive avec 24 heures de retard.</p>
<blockquote>
<p><strong>Note de terrain</strong>
<em>Contexte</em> : Migration d'un système de détection d'anomalies batch vers le streaming pour une entreprise de télécommunications
<em>Défi</em> : Le système batch détectait les anomalies réseau avec 6 heures de retard, période pendant laquelle les problèmes s'aggravaient considérablement
<em>Solution</em> : Implémentation d'un pipeline Kafka Streams traitant les métriques réseau en temps réel, avec détection d'anomalies basée sur des fenêtres glissantes de 5 minutes
<em>Leçon</em> : Le passage au streaming a réduit le temps moyen de détection de 6 heures à 30 secondes, permettant une intervention proactive plutôt que réactive. L'impact métier a largement justifié l'investissement technique</p>
</blockquote>
<hr />
<h2 id="iii82-introduction-a-kafka-streams">III.8.2 Introduction à Kafka Streams<a class="headerlink" href="#iii82-introduction-a-kafka-streams" title="Permanent link">&para;</a></h2>
<h3 id="philosophie-et-positionnement">Philosophie et Positionnement<a class="headerlink" href="#philosophie-et-positionnement" title="Permanent link">&para;</a></h3>
<p>Kafka Streams incarne une philosophie architecturale distinctive dans l'écosystème du traitement de flux. Contrairement aux frameworks traditionnels comme Apache Flink ou Apache Spark Streaming, qui nécessitent le déploiement et la gestion d'un cluster de traitement séparé, Kafka Streams est une bibliothèque cliente qui s'intègre directement dans les applications Java et Scala standard.</p>
<p>Cette approche présente des implications profondes pour l'architecture des systèmes. Une application Kafka Streams n'est pas un composant spécialisé déployé dans une infrastructure dédiée ; c'est une application Java ordinaire qui peut être déployée, mise à l'échelle et supervisée avec les mêmes outils et processus que n'importe quelle autre application de l'entreprise. Cette normalité opérationnelle constitue l'un des attraits majeurs de Kafka Streams pour les équipes qui souhaitent adopter le traitement de flux sans introduire une nouvelle catégorie d'infrastructure à gérer.</p>
<blockquote>
<p><strong>Définition formelle</strong>
Kafka Streams est une bibliothèque cliente pour construire des applications et des microservices où les données d'entrée et de sortie sont stockées dans des clusters Apache Kafka. Elle combine la simplicité d'écriture et de déploiement d'applications Java standard côté client avec les avantages de la technologie cluster côté serveur de Kafka.</p>
</blockquote>
<h3 id="caracteristiques-fondamentales">Caractéristiques Fondamentales<a class="headerlink" href="#caracteristiques-fondamentales" title="Permanent link">&para;</a></h3>
<p>Kafka Streams offre un ensemble de caractéristiques qui la distinguent des autres solutions de traitement de flux. La première est l'absence de dépendances externes : hormis Apache Kafka lui-même, Kafka Streams ne nécessite aucun système supplémentaire. Il n'y a pas de cluster de traitement à déployer, pas de ZooKeeper additionnel à gérer, pas de gestionnaire de ressources comme YARN ou Mesos à configurer.</p>
<p>La deuxième caractéristique concerne la tolérance aux pannes native. Kafka Streams exploite les mécanismes de Kafka pour assurer la durabilité et la récupération. L'état local est sauvegardé dans des topics Kafka de changelog, permettant une restauration automatique en cas de panne. Les garanties de traitement exact-une-fois sont intégrées, tirant parti des transactions Kafka introduites dans les versions récentes de la plateforme.</p>
<p>La troisième caractéristique est la scalabilité élastique. Une application Kafka Streams peut être mise à l'échelle simplement en démarrant de nouvelles instances. Le framework redistribue automatiquement les tâches entre les instances disponibles, sans intervention manuelle ni configuration complexe.</p>
<h3 id="architecture-de-haut-niveau">Architecture de Haut Niveau<a class="headerlink" href="#architecture-de-haut-niveau" title="Permanent link">&para;</a></h3>
<p>L'architecture de Kafka Streams repose sur plusieurs concepts fondamentaux. Au niveau le plus élevé, une application Kafka Streams définit une topologie de traitement, un graphe acyclique dirigé (DAG) de processeurs qui transforment les données entrantes.</p>
<p>La topologie se compose de processeurs sources, qui lisent les données depuis des topics Kafka ; de processeurs de traitement, qui effectuent les transformations ; et de processeurs puits, qui écrivent les résultats vers des topics Kafka. Cette structure permet de construire des pipelines de traitement arbitrairement complexes, depuis de simples filtres jusqu'à des agrégations multi-tables avec gestion d'état.</p>
<p>L'exécution de la topologie est distribuée en tâches (tasks), chaque tâche traitant une partition spécifique des topics d'entrée. Les tâches sont réparties entre les threads de traitement au sein de chaque instance de l'application, et entre les instances de l'application au sein du cluster logique. Cette distribution permet une parallélisation naturelle du traitement, proportionnelle au nombre de partitions des topics d'entrée.</p>
<h3 id="modele-de-programmation-dual">Modèle de Programmation Dual<a class="headerlink" href="#modele-de-programmation-dual" title="Permanent link">&para;</a></h3>
<p>Kafka Streams offre deux APIs complémentaires pour définir les topologies de traitement. L'API DSL (Domain-Specific Language) fournit une interface déclarative de haut niveau, permettant de définir les transformations avec des méthodes fluides comme <code>filter()</code>, <code>map()</code>, <code>groupByKey()</code>, <code>aggregate()</code>, et <code>join()</code>. Cette API convient à la majorité des cas d'usage et permet un développement rapide.</p>
<p>L'API Processor, de plus bas niveau, offre un contrôle fin sur le traitement de chaque enregistrement. Elle convient aux scénarios nécessitant des comportements personnalisés que l'API DSL ne supporte pas directement. Les deux APIs peuvent être combinées au sein d'une même application, permettant d'utiliser l'approche la plus appropriée pour chaque partie de la topologie.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1">// Exemple d&#39;utilisation de l&#39;API DSL</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">StreamsBuilder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StreamsBuilder</span><span class="p">();</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="s">&quot;transactions&quot;</span><span class="p">);</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fraudCounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="na">isSuspicious</span><span class="p">())</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">TimeWindows</span><span class="p">.</span><span class="na">ofSizeWithNoGrace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">fraudCounts</span><span class="p">.</span><span class="na">toStream</span><span class="p">()</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">    </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&quot;fraud-alerts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Produced</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">stringSerde</span><span class="p">,</span><span class="w"> </span><span class="n">longSerde</span><span class="p">));</span>
</code></pre></div>
<h3 id="evolutions-recentes-de-kafka-streams">Évolutions Récentes de Kafka Streams<a class="headerlink" href="#evolutions-recentes-de-kafka-streams" title="Permanent link">&para;</a></h3>
<p>Les versions récentes de Kafka (3.8, 3.9 et le futur 4.0) ont apporté des améliorations significatives à Kafka Streams :</p>
<p><strong>Kafka 3.8</strong> a introduit le partage des magasins d'état entre applications (State Store Sharing), permettant à plusieurs applications d'accéder aux mêmes données sans duplication au niveau des topics. Cette fonctionnalité est particulièrement utile pour les scénarios où plusieurs microservices doivent accéder à des données de référence communes.</p>
<p><strong>Kafka 3.8</strong> a également introduit des assignateurs de tâches personnalisables (Customizable Task Assignors), remplaçant la configuration interne précédente. Cette flexibilité permet d'optimiser la distribution des tâches selon les contraintes spécifiques de l'application.</p>
<p>Le découplage de la restauration du traitement (Decoupled Restoration), également introduit dans Kafka 3.8, permet aux tâches de commencer à traiter les nouveaux enregistrements pendant que la restauration de l'état se poursuit en arrière-plan. Cette fonctionnalité réduit drastiquement l'impact des redémarrages sur la disponibilité de l'application.</p>
<p><strong>Kafka 3.9</strong>, la dernière version de la série 3.x, prépare la transition vers Kafka 4.0 en améliorant la migration ZooKeeper vers KRaft et en stabilisant les fonctionnalités introduites précédemment.</p>
<p><strong>Kafka 4.0</strong>, attendu en 2025, élimine complètement la dépendance à ZooKeeper. Le mode KRaft devient le seul mode de fonctionnement supporté. Cette simplification architecturale bénéficie indirectement à Kafka Streams en réduisant la complexité opérationnelle du cluster sous-jacent.</p>
<p>Les évolutions futures incluent le nouveau protocole de rebalance pour les consommateurs (KIP-848), qui promet des rebalances plus rapides et moins disruptives. L'adoption de ce protocole par Kafka Streams (KIP-1071) est en cours d'implémentation et devrait être disponible dans les prochaines versions.</p>
<blockquote>
<p><strong>Perspective stratégique</strong>
La trajectoire d'évolution de Kafka Streams démontre l'engagement de la communauté à améliorer continuellement la plateforme. Pour les architectes, il est crucial de suivre ces évolutions et de planifier les mises à jour en fonction des fonctionnalités qui bénéficieraient le plus à leurs applications. La migration vers Kafka 4.0 représente un jalon important qui nécessite une préparation anticipée, notamment pour les organisations utilisant encore ZooKeeper</p>
</blockquote>
<hr />
<h2 id="iii83-architecture-et-concepts-cles">III.8.3 Architecture et Concepts Clés<a class="headerlink" href="#iii83-architecture-et-concepts-cles" title="Permanent link">&para;</a></h2>
<h3 id="topologie-de-traitement">Topologie de Traitement<a class="headerlink" href="#topologie-de-traitement" title="Permanent link">&para;</a></h3>
<p>La topologie constitue le cœur conceptuel d'une application Kafka Streams. Elle définit comment les données circulent depuis les sources vers les puits, en passant par les transformations intermédiaires. Comprendre la topologie est essentiel pour concevoir des applications performantes et pour diagnostiquer les problèmes en production.</p>
<p>Une topologie peut être décomposée en sous-topologies indépendantes. Deux sous-topologies sont indépendantes si elles n'échangent pas de données directement et ne partagent pas de magasins d'état. Cette décomposition est importante car elle détermine comment le travail peut être parallélisé : les sous-topologies indépendantes peuvent s'exécuter de manière totalement découplée.</p>
<p>La visualisation de la topologie aide à comprendre le flux de données et à identifier les goulots d'étranglement potentiels. Kafka Streams fournit la méthode <code>describe()</code> sur l'objet Topology, qui produit une représentation textuelle de la structure de traitement.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">Topology</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">topology</span><span class="p">.</span><span class="na">describe</span><span class="p">());</span>
</code></pre></div>
<h4 id="anatomie-dune-topologie">Anatomie d'une Topologie<a class="headerlink" href="#anatomie-dune-topologie" title="Permanent link">&para;</a></h4>
<p>Une topologie se compose de plusieurs types de nœuds interconnectés :</p>
<p><strong>Nœuds sources (Source Nodes)</strong> : Ces nœuds représentent les points d'entrée des données dans la topologie. Chaque nœud source est associé à un ou plusieurs topics Kafka d'où il lit les enregistrements.</p>
<p><strong>Nœuds de traitement (Processor Nodes)</strong> : Ces nœuds effectuent les transformations sur les données. Ils reçoivent des enregistrements de leurs prédécesseurs, appliquent une logique de traitement, et transmettent les résultats à leurs successeurs.</p>
<p><strong>Nœuds puits (Sink Nodes)</strong> : Ces nœuds représentent les points de sortie de la topologie. Ils écrivent les enregistrements traités vers des topics Kafka de destination.</p>
<p><strong>Magasins d'état</strong> : Bien qu'ils ne soient pas des nœuds de traitement au sens strict, les magasins d'état sont associés à certains nœuds de traitement et leur permettent de maintenir un état entre les enregistrements.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Topologies:
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>   Sub-topology: 0
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    Source: KSTREAM-SOURCE-0000000000 (topics: [input-topic])
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>      --&gt; KSTREAM-FILTER-0000000001
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    Processor: KSTREAM-FILTER-0000000001 (stores: [])
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>      --&gt; KSTREAM-MAP-0000000002
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>      &lt;-- KSTREAM-SOURCE-0000000000
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    Processor: KSTREAM-MAP-0000000002 (stores: [])
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>      --&gt; KSTREAM-SINK-0000000003
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>      &lt;-- KSTREAM-FILTER-0000000001
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>    Sink: KSTREAM-SINK-0000000003 (topic: output-topic)
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>      &lt;-- KSTREAM-MAP-0000000002
</code></pre></div>
<h4 id="optimisation-de-la-topologie">Optimisation de la Topologie<a class="headerlink" href="#optimisation-de-la-topologie" title="Permanent link">&para;</a></h4>
<p>La structure de la topologie influence directement les performances de l'application. Plusieurs considérations guident l'optimisation :</p>
<p><strong>Réduction des repartitionnements</strong> : Chaque opération de repartitionnement crée un topic intermédiaire et ajoute de la latence. Structurez la topologie pour minimiser ces opérations en regroupant les transformations sur la même clé.</p>
<p><strong>Fusion des opérations</strong> : Kafka Streams fusionne automatiquement certaines opérations consécutives (comme plusieurs <code>map()</code> successifs) en un seul nœud de traitement. Cependant, certaines combinaisons ne peuvent pas être fusionnées.</p>
<p><strong>Parallélisation via sous-topologies</strong> : Si votre logique contient des chemins de traitement indépendants, structurez-les comme des sous-topologies distinctes pour bénéficier d'un parallélisme optimal.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">// Exemple de topologie optimisée avec chemins parallèles</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">StreamsBuilder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StreamsBuilder</span><span class="p">();</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="o">&gt;</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="s">&quot;events&quot;</span><span class="p">);</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c1">// Chemin 1 : Agrégation des métriques</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">events</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="na">getType</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;METRIC&quot;</span><span class="p">))</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span><span class="p">.</span><span class="na">aggregate</span><span class="p">(</span><span class="cm">/* ... */</span><span class="p">)</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">    </span><span class="p">.</span><span class="na">toStream</span><span class="p">()</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">    </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&quot;metric-aggregates&quot;</span><span class="p">);</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c1">// Chemin 2 : Alertes en temps réel (sous-topologie indépendante)</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="n">events</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">    </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">event</span><span class="p">.</span><span class="na">getSeverity</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">    </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&quot;alerts&quot;</span><span class="p">);</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="c1">// Ces deux chemins s&#39;exécutent en parallèle car ils ne partagent pas d&#39;état</span>
</code></pre></div>
<blockquote>
<p><strong>Décision architecturale</strong>
<em>Contexte</em> : Application avec topologie complexe comprenant 15 étapes de transformation
<em>Options</em> : (1) Une seule topologie monolithique, (2) Plusieurs applications avec topics intermédiaires
<em>Décision</em> : Division en 3 applications distinctes avec topics intermédiaires bien définis. Bien que cela ajoute de la latence (quelques millisecondes), cela simplifie considérablement le débogage, permet le scaling indépendant de chaque étape, et facilite les mises à jour partielles sans redéployer l'ensemble</p>
</blockquote>
<h3 id="flux-et-tables-la-dualite-fondamentale">Flux et Tables : La Dualité Fondamentale<a class="headerlink" href="#flux-et-tables-la-dualite-fondamentale" title="Permanent link">&para;</a></h3>
<p>Kafka Streams repose sur une dualité conceptuelle fondamentale entre les flux (streams) et les tables. Cette dualité, inspirée des bases de données et des systèmes de traitement d'événements, constitue l'un des apports théoriques les plus significatifs de Kafka Streams.</p>
<p>Un flux (KStream) représente une séquence infinie d'événements. Chaque événement est une insertion indépendante : si la même clé apparaît plusieurs fois, chaque occurrence représente un nouvel événement distinct. Les flux conviennent à la modélisation des événements, des transactions, des clics utilisateur, ou de toute donnée où chaque occurrence a une signification propre.</p>
<p>Une table (KTable) représente l'état actuel pour chaque clé. Chaque événement est une mise à jour (upsert) : si la même clé apparaît plusieurs fois, seule la valeur la plus récente est conservée. Les tables conviennent à la modélisation des entités, des profils utilisateur, des configurations, ou de toute donnée où seule la version actuelle importe.</p>
<blockquote>
<p><strong>Définition formelle</strong>
La dualité flux-table établit qu'un flux peut être transformé en table par agrégation (chaque nouvelle valeur pour une clé remplace la précédente), et qu'une table peut être transformé en flux par journal des modifications (chaque changement devient un événement dans le flux). Cette dualité est à la base de nombreux patrons de traitement dans Kafka Streams.</p>
</blockquote>
<h3 id="partitions-et-parallelisme">Partitions et Parallélisme<a class="headerlink" href="#partitions-et-parallelisme" title="Permanent link">&para;</a></h3>
<p>Le modèle de parallélisme de Kafka Streams dérive directement du modèle de partitionnement de Kafka. Chaque partition d'un topic d'entrée correspond à une tâche de traitement. Les tâches constituent l'unité fondamentale de parallélisme : elles peuvent être distribuées entre les threads d'une instance et entre les instances d'une application.</p>
<p>Le nombre maximal de tâches parallèles est déterminé par le nombre de partitions des topics d'entrée. Si un topic d'entrée possède 12 partitions, l'application peut avoir au maximum 12 tâches actives simultanément. Démarrer plus d'instances que de partitions résultera en instances inactives, attendant qu'une partition leur soit assignée.</p>
<p>Cette relation entre partitions et parallélisme a des implications importantes pour le dimensionnement. Lors de la conception d'une application Kafka Streams, le nombre de partitions des topics d'entrée doit être choisi en anticipant le niveau de parallélisme souhaité. Augmenter le nombre de partitions après coup est possible mais nécessite une planification soignée.</p>
<h3 id="magasins-detat-state-stores">Magasins d'État (State Stores)<a class="headerlink" href="#magasins-detat-state-stores" title="Permanent link">&para;</a></h3>
<p>Les magasins d'état permettent aux applications Kafka Streams de maintenir un état local pour les opérations avec état comme les agrégations, les jointures, et les fenêtrages. Par défaut, Kafka Streams utilise RocksDB comme moteur de stockage, offrant des performances élevées avec une empreinte mémoire contrôlée.</p>
<p>Chaque magasin d'état est local à une tâche spécifique. Cette localité est essentielle pour la performance : les opérations d'état n'impliquent pas de communication réseau. Cependant, elle signifie également que l'état d'une tâche n'est pas directement accessible depuis une autre tâche.</p>
<p>Pour assurer la durabilité, chaque modification d'un magasin d'état est également écrite dans un topic Kafka de changelog. Ce topic permet la restauration de l'état après une panne ou lors du redémarrage d'une tâche sur une nouvelle instance. Les topics de changelog utilisent la compaction, conservant uniquement la dernière valeur pour chaque clé.</p>
<h4 id="types-de-magasins-detat">Types de Magasins d'État<a class="headerlink" href="#types-de-magasins-detat" title="Permanent link">&para;</a></h4>
<p>Kafka Streams propose plusieurs types de magasins d'état, chacun optimisé pour des patterns d'accès spécifiques :</p>
<p><strong>KeyValueStore</strong> : Le type le plus courant, offrant des opérations get/put/delete par clé. Idéal pour les agrégations simples et les tables de référence.</p>
<p><strong>WindowStore</strong> : Optimisé pour les données fenêtrées, permettant des requêtes par clé et par intervalle temporel. Utilisé automatiquement par les opérations de fenêtrage.</p>
<p><strong>SessionStore</strong> : Spécialisé pour les fenêtres de session, gérant les sessions d'activité définies par des gaps d'inactivité.</p>
<p><strong>TimestampedKeyValueStore</strong> : Variante du KeyValueStore qui conserve également l'horodatage de la dernière mise à jour pour chaque clé.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">// Configuration personnalisée d&#39;un magasin d&#39;état</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">StoreBuilder</span><span class="o">&lt;</span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">storeBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="n">Stores</span><span class="p">.</span><span class="na">keyValueStoreBuilder</span><span class="p">(</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">        </span><span class="n">Stores</span><span class="p">.</span><span class="na">persistentKeyValueStore</span><span class="p">(</span><span class="s">&quot;my-store&quot;</span><span class="p">),</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">        </span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">        </span><span class="n">Serdes</span><span class="p">.</span><span class="na">Long</span><span class="p">()</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">    </span><span class="p">.</span><span class="na">withCachingEnabled</span><span class="p">()</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">    </span><span class="p">.</span><span class="na">withLoggingEnabled</span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">        </span><span class="s">&quot;retention.ms&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;604800000&quot;</span><span class="w">  </span><span class="c1">// 7 jours</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span><span class="p">));</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="n">builder</span><span class="p">.</span><span class="na">addStateStore</span><span class="p">(</span><span class="n">storeBuilder</span><span class="p">);</span>
</code></pre></div>
<h4 id="optimisation-rocksdb">Optimisation RocksDB<a class="headerlink" href="#optimisation-rocksdb" title="Permanent link">&para;</a></h4>
<p>RocksDB, le moteur de stockage par défaut, offre de nombreuses options de configuration pour optimiser les performances selon les caractéristiques de la charge de travail :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OptimizedRocksDBConfig</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">RocksDBConfigSetter</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setConfig</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">storeName</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="w"> </span><span class="n">options</span><span class="p">,</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">                          </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">configs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">        </span><span class="c1">// Configuration pour charges de travail intensives en écriture</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">        </span><span class="n">BlockBasedTableConfig</span><span class="w"> </span><span class="n">tableConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BlockBasedTableConfig</span><span class="p">();</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">        </span><span class="n">tableConfig</span><span class="p">.</span><span class="na">setBlockCacheSize</span><span class="p">(</span><span class="mi">50</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024L</span><span class="p">);</span><span class="w">  </span><span class="c1">// 50 MB</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">        </span><span class="n">tableConfig</span><span class="p">.</span><span class="na">setBlockSize</span><span class="p">(</span><span class="mi">4096</span><span class="p">);</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">        </span><span class="n">tableConfig</span><span class="p">.</span><span class="na">setCacheIndexAndFilterBlocks</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setTableFormatConfig</span><span class="p">(</span><span class="n">tableConfig</span><span class="p">);</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setMaxWriteBufferNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setWriteBufferSize</span><span class="p">(</span><span class="mi">16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w">  </span><span class="c1">// 16 MB</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setMinWriteBufferNumberToMerge</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">        </span><span class="c1">// Compression pour réduire l&#39;espace disque</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setCompressionType</span><span class="p">(</span><span class="n">CompressionType</span><span class="p">.</span><span class="na">LZ4_COMPRESSION</span><span class="p">);</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="w">        </span><span class="c1">// Optimisation des compactions</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setMaxBackgroundCompactions</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setMaxBackgroundFlushes</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="p">}</span>
</code></pre></div>
<blockquote>
<p><strong>Décision architecturale</strong>
<em>Contexte</em> : Application avec état volumineux (50 Go par instance) et latence critique
<em>Options</em> : (1) RocksDB par défaut, (2) RocksDB optimisé, (3) Magasin externe (Redis/DynamoDB)
<em>Décision</em> : RocksDB optimisé avec répliques standby. Un magasin externe ajouterait une latence réseau inacceptable pour notre SLA de 10ms. Les optimisations RocksDB (bloom filters, caches ajustés, compaction configurée) ont réduit la latence p99 de 15ms à 3ms</p>
</blockquote>
<h3 id="semantique-temporelle">Sémantique Temporelle<a class="headerlink" href="#semantique-temporelle" title="Permanent link">&para;</a></h3>
<p>Le temps joue un rôle central dans le traitement de flux. Kafka Streams distingue plusieurs notions de temps, chacune appropriée à des scénarios différents.</p>
<p>Le temps de l'événement (event time) correspond au moment où l'événement s'est produit dans le monde réel. Il est généralement encodé dans l'enregistrement lui-même et représente la sémantique la plus riche pour les analyses temporelles.</p>
<p>Le temps d'ingestion (ingestion time) correspond au moment où Kafka a reçu l'enregistrement. Il offre un compromis entre la précision du temps d'événement et la simplicité du temps de traitement.</p>
<p>Le temps de traitement (processing time) correspond au moment où l'application traite l'enregistrement. Il est le plus simple à utiliser mais peut produire des résultats non déterministes si les événements arrivent dans le désordre.</p>
<p>Par défaut, Kafka Streams utilise le temps de l'événement, extrait de l'horodatage natif des enregistrements Kafka. Un extracteur de temps personnalisé peut être configuré pour utiliser un champ spécifique de la valeur.</p>
<hr />
<h2 id="iii84-developpement-dapplications">III.8.4 Développement d'Applications<a class="headerlink" href="#iii84-developpement-dapplications" title="Permanent link">&para;</a></h2>
<h3 id="structure-dune-application-kafka-streams">Structure d'une Application Kafka Streams<a class="headerlink" href="#structure-dune-application-kafka-streams" title="Permanent link">&para;</a></h3>
<p>Une application Kafka Streams typique suit une structure bien définie. Elle commence par la configuration des propriétés, définit la topologie de traitement, crée l'objet KafkaStreams, et gère le cycle de vie de l'application.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FraudDetectionApp</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">        </span><span class="c1">// Configuration</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">        </span><span class="n">Properties</span><span class="w"> </span><span class="n">props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">APPLICATION_ID_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;fraud-detection&quot;</span><span class="p">);</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">BOOTSTRAP_SERVERS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;kafka:9092&quot;</span><span class="p">);</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">                  </span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">().</span><span class="na">getClass</span><span class="p">());</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">                  </span><span class="n">TransactionSerde</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">PROCESSING_GUARANTEE_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">                  </span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">EXACTLY_ONCE_V2</span><span class="p">);</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">        </span><span class="c1">// Topologie</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">        </span><span class="n">StreamsBuilder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StreamsBuilder</span><span class="p">();</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">        </span><span class="n">buildTopology</span><span class="p">(</span><span class="n">builder</span><span class="p">);</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">        </span><span class="n">Topology</span><span class="w"> </span><span class="n">topology</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">        </span><span class="c1">// Création et démarrage</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="w">        </span><span class="n">KafkaStreams</span><span class="w"> </span><span class="n">streams</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">KafkaStreams</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span><span class="w"> </span><span class="n">props</span><span class="p">);</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="w">        </span><span class="c1">// Gestion du cycle de vie</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="w">        </span><span class="n">Runtime</span><span class="p">.</span><span class="na">getRuntime</span><span class="p">().</span><span class="na">addShutdownHook</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">streams</span><span class="p">::</span><span class="n">close</span><span class="p">));</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">        </span><span class="n">streams</span><span class="p">.</span><span class="na">start</span><span class="p">();</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">buildTopology</span><span class="p">(</span><span class="n">StreamsBuilder</span><span class="w"> </span><span class="n">builder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="w">        </span><span class="c1">// Définition de la topologie</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="w">        </span><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="w">            </span><span class="n">builder</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span><span class="s">&quot;transactions&quot;</span><span class="p">);</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="w">        </span><span class="c1">// Traitement</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="w">        </span><span class="n">transactions</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000</span><span class="p">)</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="w">            </span><span class="p">.</span><span class="na">mapValues</span><span class="p">(</span><span class="n">tx</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">analyzeRisk</span><span class="p">(</span><span class="n">tx</span><span class="p">))</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">risk</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">risk</span><span class="p">.</span><span class="na">getScore</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.8</span><span class="p">)</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="w">            </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&quot;high-risk-transactions&quot;</span><span class="p">);</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="p">}</span>
</code></pre></div>
<h3 id="transformations-stateless">Transformations Stateless<a class="headerlink" href="#transformations-stateless" title="Permanent link">&para;</a></h3>
<p>Les transformations sans état ne nécessitent pas de maintenir d'information entre les enregistrements. Elles traitent chaque enregistrement indépendamment, ce qui les rend simples à comprendre et à paralléliser.</p>
<p><strong>Filter</strong> sélectionne les enregistrements satisfaisant un prédicat :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="o">&gt;</span><span class="w"> </span><span class="n">highValueOrders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getTotal</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
</code></pre></div>
<p><strong>Map</strong> transforme les clés et/ou les valeurs :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">EnrichedOrder</span><span class="o">&gt;</span><span class="w"> </span><span class="n">enriched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="p">.</span><span class="na">map</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">KeyValue</span><span class="p">.</span><span class="na">pair</span><span class="p">(</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">        </span><span class="n">order</span><span class="p">.</span><span class="na">getCustomerId</span><span class="p">(),</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">        </span><span class="n">enrichOrder</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">    </span><span class="p">));</span>
</code></pre></div>
<p><strong>FlatMap</strong> permet de produire zéro, un ou plusieurs enregistrements pour chaque entrée :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">LineItem</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lineItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="p">.</span><span class="na">flatMapValues</span><span class="p">(</span><span class="n">order</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getLineItems</span><span class="p">());</span>
</code></pre></div>
<p><strong>Branch</strong> divise un flux selon des prédicats :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">branches</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">    </span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="n">Named</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;branch-&quot;</span><span class="p">))</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="p">.</span><span class="na">branch</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">isUrgent</span><span class="p">(),</span><span class="w"> </span><span class="n">Branched</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;urgent&quot;</span><span class="p">))</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="p">.</span><span class="na">branch</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">isStandard</span><span class="p">(),</span><span class="w"> </span><span class="n">Branched</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;standard&quot;</span><span class="p">))</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="p">.</span><span class="na">defaultBranch</span><span class="p">(</span><span class="n">Branched</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;other&quot;</span><span class="p">));</span>
</code></pre></div>
<h3 id="transformations-stateful">Transformations Stateful<a class="headerlink" href="#transformations-stateful" title="Permanent link">&para;</a></h3>
<p>Les transformations avec état maintiennent des informations entre les enregistrements. Elles sont plus puissantes mais nécessitent une gestion soignée de l'état.</p>
<p><strong>Agrégation</strong> combine les valeurs pour chaque clé :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderCounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">totalsByCustomer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">KeyValue</span><span class="p">.</span><span class="na">pair</span><span class="p">(</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">        </span><span class="n">order</span><span class="p">.</span><span class="na">getCustomerId</span><span class="p">(),</span><span class="w"> </span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">        </span><span class="n">order</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="p">))</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span><span class="p">.</span><span class="na">aggregate</span><span class="p">(</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">        </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">        </span><span class="p">(</span><span class="n">customerId</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">total</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getTotal</span><span class="p">(),</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">        </span><span class="n">Materialized</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">Serdes</span><span class="p">.</span><span class="na">Double</span><span class="p">())</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">    </span><span class="p">);</span>
</code></pre></div>
<p><strong>Fenêtrage</strong> applique des agrégations sur des fenêtres temporelles :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1">// Fenêtres tumbling (non chevauchantes)</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">Windowed</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clicksPerMinute</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clicks</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">TimeWindows</span><span class="p">.</span><span class="na">ofSizeWithNoGrace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1">// Fenêtres hopping (chevauchantes)</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">Windowed</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">clicksPerMinuteSliding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clicks</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">TimeWindows</span><span class="p">.</span><span class="na">ofSizeAndGrace</span><span class="p">(</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">        </span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">        </span><span class="n">Duration</span><span class="p">.</span><span class="na">ofSeconds</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="w">    </span><span class="p">).</span><span class="na">advanceBy</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">    </span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c1">// Fenêtres de session</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">Windowed</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sessionCounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clicks</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">SessionWindows</span><span class="p">.</span><span class="na">ofInactivityGapWithNoGrace</span><span class="p">(</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">        </span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">    </span><span class="p">))</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">    </span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
</code></pre></div>
<h3 id="jointures">Jointures<a class="headerlink" href="#jointures" title="Permanent link">&para;</a></h3>
<p>Les jointures combinent des données de plusieurs sources. Kafka Streams supporte plusieurs types de jointures, chacun avec ses propres caractéristiques.</p>
<p><strong>Jointure Stream-Stream</strong> combine deux flux sur une fenêtre temporelle :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">EnrichedClick</span><span class="o">&gt;</span><span class="w"> </span><span class="n">enrichedClicks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clicks</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">    </span><span class="p">.</span><span class="na">join</span><span class="p">(</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">        </span><span class="n">impressions</span><span class="p">,</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">        </span><span class="p">(</span><span class="n">click</span><span class="p">,</span><span class="w"> </span><span class="n">impression</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EnrichedClick</span><span class="p">(</span><span class="n">click</span><span class="p">,</span><span class="w"> </span><span class="n">impression</span><span class="p">),</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">        </span><span class="n">JoinWindows</span><span class="p">.</span><span class="na">ofTimeDifferenceWithNoGrace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">)),</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">        </span><span class="n">StreamJoined</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">clickSerde</span><span class="p">,</span><span class="w"> </span><span class="n">impressionSerde</span><span class="p">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="p">);</span>
</code></pre></div>
<p><strong>Jointure Stream-Table</strong> enrichit un flux avec des données de référence :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">EnrichedOrder</span><span class="o">&gt;</span><span class="w"> </span><span class="n">enrichedOrders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="p">.</span><span class="na">join</span><span class="p">(</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">        </span><span class="n">customers</span><span class="p">,</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">        </span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">customer</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EnrichedOrder</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">customer</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="p">);</span>
</code></pre></div>
<p><strong>Jointure Table-Table</strong> combine deux tables :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="n">profiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customers</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="p">.</span><span class="na">join</span><span class="p">(</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">        </span><span class="n">addresses</span><span class="p">,</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">        </span><span class="p">(</span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="p">(</span><span class="n">customer</span><span class="p">,</span><span class="w"> </span><span class="n">address</span><span class="p">)</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="p">);</span>
</code></pre></div>
<h4 id="globalktable-pour-les-donnees-de-reference">GlobalKTable pour les Données de Référence<a class="headerlink" href="#globalktable-pour-les-donnees-de-reference" title="Permanent link">&para;</a></h4>
<p>Les GlobalKTable diffèrent des KTable standards en ce qu'elles répliquent l'intégralité des données sur chaque instance de l'application. Cette caractéristique les rend idéales pour les petites tables de référence qui doivent être jointes avec n'importe quelle partition d'un flux.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">// Chargement d&#39;une table de référence globale</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="n">GlobalKTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Country</span><span class="o">&gt;</span><span class="w"> </span><span class="n">countries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">globalTable</span><span class="p">(</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="s">&quot;countries&quot;</span><span class="p">,</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="n">Consumed</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">countrySerde</span><span class="p">),</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="n">Materialized</span><span class="p">.</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Country</span><span class="p">,</span><span class="w"> </span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">Bytes</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;&gt;</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">        </span><span class="nf">as</span><span class="p">(</span><span class="s">&quot;countries-store&quot;</span><span class="p">)</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">        </span><span class="p">.</span><span class="na">withKeySerde</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">())</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">        </span><span class="p">.</span><span class="na">withValueSerde</span><span class="p">(</span><span class="n">countrySerde</span><span class="p">)</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="p">);</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c1">// Jointure avec une GlobalKTable (pas de co-partitionnement requis)</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">EnrichedTransaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">enriched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">    </span><span class="p">.</span><span class="na">join</span><span class="p">(</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">        </span><span class="n">countries</span><span class="p">,</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">        </span><span class="p">(</span><span class="n">txKey</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="na">getCountryCode</span><span class="p">(),</span><span class="w">  </span><span class="c1">// Extracteur de clé</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">        </span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">EnrichedTransaction</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">country</span><span class="p">)</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="w">    </span><span class="p">);</span>
</code></pre></div>
<p>Les GlobalKTable éliminent le besoin de co-partitionnement, mais au prix d'une consommation mémoire accrue puisque toutes les données sont répliquées sur chaque instance.</p>
<h4 id="considerations-sur-le-co-partitionnement">Considérations sur le Co-partitionnement<a class="headerlink" href="#considerations-sur-le-co-partitionnement" title="Permanent link">&para;</a></h4>
<p>Pour les jointures entre KStream et KTable (non globales), les topics impliqués doivent être co-partitionnés : ils doivent avoir le même nombre de partitions et utiliser la même stratégie de partitionnement. Si cette condition n'est pas respectée, Kafka Streams lève une exception au démarrage.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="c1">// Repartitionnement pour assurer le co-partitionnement</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Order</span><span class="o">&gt;</span><span class="w"> </span><span class="n">repartitionedOrders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orders</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">    </span><span class="p">.</span><span class="na">selectKey</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">order</span><span class="p">.</span><span class="na">getCustomerId</span><span class="p">())</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">    </span><span class="p">.</span><span class="na">repartition</span><span class="p">(</span><span class="n">Repartitioned</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">orderSerde</span><span class="p">)</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">        </span><span class="p">.</span><span class="na">withName</span><span class="p">(</span><span class="s">&quot;orders-by-customer&quot;</span><span class="p">)</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">        </span><span class="p">.</span><span class="na">withNumberOfPartitions</span><span class="p">(</span><span class="n">customers</span><span class="p">.</span><span class="na">queryableStoreName</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">            </span><span class="n">getPartitionCount</span><span class="p">(</span><span class="s">&quot;customers&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">));</span>
</code></pre></div>
<blockquote>
<p><strong>Note de terrain</strong>
<em>Contexte</em> : Jointure entre un flux de transactions et une table de clients dans un système bancaire
<em>Défi</em> : Les topics avaient des nombres de partitions différents (transactions : 24, clients : 12), causant des erreurs au démarrage
<em>Solution</em> : Plutôt que de modifier les topics existants (risqué en production), nous avons créé un topic intermédiaire avec repartitionnement explicite. Le coût en latence était acceptable (quelques millisecondes supplémentaires)
<em>Leçon</em> : Planifier le co-partitionnement dès la conception des topics évite des contournements coûteux. Documentez les dépendances de partitionnement entre topics
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>&gt; **Note de terrain**
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>&gt; *Contexte* : Migration d&#39;un système batch de rapprochement de transactions vers Kafka Streams
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>&gt; *Défi* : Le système batch utilisait des jointures complexes sur des fenêtres de 24 heures, ce qui semblait impossible à reproduire en streaming
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>&gt; *Solution* : Nous avons utilisé des jointures Stream-Stream avec des fenêtres étendues, combinées avec un topic de rétention longue pour les transactions non appariées. Un processus de réconciliation secondaire traite les cas limites
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>&gt; *Leçon* : Les jointures en streaming nécessitent souvent une conception différente des jointures batch. Le résultat peut être plus complexe mais offre des résultats en temps réel plutôt qu&#39;en fin de journée
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>### Sérialisation et SerDes
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>La sérialisation constitue un aspect critique des applications Kafka Streams, souvent sous-estimé lors de la conception initiale. Les SerDes (Serializer/Deserializer) définissent comment les clés et valeurs sont converties entre leur représentation Java et leur format binaire pour le transport et le stockage.
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>#### Configuration des SerDes
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>Kafka Streams requiert des SerDes pour toutes les opérations impliquant des lectures ou écritures vers Kafka ou les magasins d&#39;état. Les SerDes peuvent être configurés globalement via les propriétés de l&#39;application ou spécifiés explicitement pour chaque opération.
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>```java
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>// Configuration globale des SerDes par défaut
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, 
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>          Serdes.String().getClass());
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, 
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>          Serdes.String().getClass());
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>// Spécification explicite pour une opération
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>KStream&lt;String, Transaction&gt; transactions = builder.stream(
<a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>    &quot;transactions&quot;,
<a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>    Consumed.with(Serdes.String(), transactionSerde)
<a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>);
<a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>
<a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>// Spécification pour une écriture
<a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>enrichedTransactions.to(
<a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>    &quot;enriched-transactions&quot;,
<a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>    Produced.with(Serdes.String(), enrichedTransactionSerde)
<a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>);
</code></pre></div></p>
</blockquote>
<h4 id="serdes-personnalises">SerDes Personnalisés<a class="headerlink" href="#serdes-personnalises" title="Permanent link">&para;</a></h4>
<p>Pour les objets métier complexes, la création de SerDes personnalisés est souvent nécessaire. L'approche recommandée consiste à implémenter l'interface Serde ou à utiliser un framework de sérialisation comme Avro, Protobuf, ou JSON avec Jackson.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TransactionSerde</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serde</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ObjectMapper</span><span class="w"> </span><span class="n">mapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectMapper</span><span class="p">()</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">        </span><span class="p">.</span><span class="na">registerModule</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JavaTimeModule</span><span class="p">())</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">        </span><span class="p">.</span><span class="na">configure</span><span class="p">(</span><span class="n">SerializationFeature</span><span class="p">.</span><span class="na">WRITE_DATES_AS_TIMESTAMPS</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Serializer</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">serializer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">topic</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">writeValueAsBytes</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">JsonProcessingException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SerializationException</span><span class="p">(</span><span class="s">&quot;Erreur de sérialisation&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Deserializer</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">deserializer</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">topic</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">readValue</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SerializationException</span><span class="p">(</span><span class="s">&quot;Erreur de désérialisation&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a><span class="w">        </span><span class="p">};</span>
<a id="__codelineno-19-28" name="__codelineno-19-28" href="#__codelineno-19-28"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-19-29" name="__codelineno-19-29" href="#__codelineno-19-29"></a><span class="p">}</span>
<a id="__codelineno-19-30" name="__codelineno-19-30" href="#__codelineno-19-30"></a>
<a id="__codelineno-19-31" name="__codelineno-19-31" href="#__codelineno-19-31"></a><span class="c1">// Utilisation d&#39;un SerDes générique avec Jackson</span>
<a id="__codelineno-19-32" name="__codelineno-19-32" href="#__codelineno-19-32"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JsonSerde</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Serde</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-33" name="__codelineno-19-33" href="#__codelineno-19-33"></a>
<a id="__codelineno-19-34" name="__codelineno-19-34" href="#__codelineno-19-34"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ObjectMapper</span><span class="w"> </span><span class="n">mapper</span><span class="p">;</span>
<a id="__codelineno-19-35" name="__codelineno-19-35" href="#__codelineno-19-35"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">targetType</span><span class="p">;</span>
<a id="__codelineno-19-36" name="__codelineno-19-36" href="#__codelineno-19-36"></a>
<a id="__codelineno-19-37" name="__codelineno-19-37" href="#__codelineno-19-37"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">JsonSerde</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">targetType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-19-38" name="__codelineno-19-38" href="#__codelineno-19-38"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">targetType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">targetType</span><span class="p">;</span>
<a id="__codelineno-19-39" name="__codelineno-19-39" href="#__codelineno-19-39"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">mapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ObjectMapper</span><span class="p">()</span>
<a id="__codelineno-19-40" name="__codelineno-19-40" href="#__codelineno-19-40"></a><span class="w">            </span><span class="p">.</span><span class="na">registerModule</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">JavaTimeModule</span><span class="p">())</span>
<a id="__codelineno-19-41" name="__codelineno-19-41" href="#__codelineno-19-41"></a><span class="w">            </span><span class="p">.</span><span class="na">configure</span><span class="p">(</span><span class="n">DeserializationFeature</span><span class="p">.</span><span class="na">FAIL_ON_UNKNOWN_PROPERTIES</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<a id="__codelineno-19-42" name="__codelineno-19-42" href="#__codelineno-19-42"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-19-43" name="__codelineno-19-43" href="#__codelineno-19-43"></a>
<a id="__codelineno-19-44" name="__codelineno-19-44" href="#__codelineno-19-44"></a><span class="w">    </span><span class="c1">// ... implémentation similaire</span>
<a id="__codelineno-19-45" name="__codelineno-19-45" href="#__codelineno-19-45"></a><span class="p">}</span>
</code></pre></div>
<h4 id="integration-avec-schema-registry">Intégration avec Schema Registry<a class="headerlink" href="#integration-avec-schema-registry" title="Permanent link">&para;</a></h4>
<p>Pour les environnements de production, l'utilisation de Schema Registry avec Avro ou Protobuf offre des avantages significatifs : gestion centralisée des schémas, validation de compatibilité, et évolution contrôlée des formats de données.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1">// Configuration pour Avro avec Schema Registry</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">serdeConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">serdeConfig</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;schema.registry.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;http://schema-registry:8081&quot;</span><span class="p">);</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="n">serdeConfig</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;specific.avro.reader&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="c1">// Serde Avro spécifique</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">SpecificAvroSerde</span><span class="o">&lt;</span><span class="n">TransactionAvro</span><span class="o">&gt;</span><span class="w"> </span><span class="n">transactionSerde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpecificAvroSerde</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">transactionSerde</span><span class="p">.</span><span class="na">configure</span><span class="p">(</span><span class="n">serdeConfig</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span><span class="w">  </span><span class="c1">// false = pour les valeurs</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="c1">// Serde Avro générique (pour les schémas dynamiques)</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="n">GenericAvroSerde</span><span class="w"> </span><span class="n">genericSerde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">GenericAvroSerde</span><span class="p">();</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="n">genericSerde</span><span class="p">.</span><span class="na">configure</span><span class="p">(</span><span class="n">serdeConfig</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</code></pre></div>
<h4 id="bonnes-pratiques-de-serialisation">Bonnes Pratiques de Sérialisation<a class="headerlink" href="#bonnes-pratiques-de-serialisation" title="Permanent link">&para;</a></h4>
<p>Plusieurs bonnes pratiques émergent de l'expérience de production avec les SerDes :</p>
<p><strong>Gestion des nulls</strong> : Assurez-vous que vos SerDes gèrent correctement les valeurs nulles, particulièrement importantes pour les tombstones dans les tables compactées.</p>
<p><strong>Performance</strong> : Les SerDes sont invoqués pour chaque enregistrement. Évitez la création d'objets coûteux à chaque appel ; préférez les instances réutilisables.</p>
<p><strong>Versioning</strong> : Planifiez l'évolution des schémas dès le départ. Les schémas Avro avec des valeurs par défaut pour les nouveaux champs facilitent les migrations.</p>
<p><strong>Tests</strong> : Testez explicitement vos SerDes avec des cas limites : nulls, chaînes vides, caractères spéciaux, dates aux bornes.</p>
<blockquote>
<p><strong>Anti-patron</strong>
Évitez d'utiliser la sérialisation Java native (ObjectInputStream/ObjectOutputStream) pour les SerDes. Cette approche est inefficace en termes de taille, fragile face aux changements de classe, et pose des risques de sécurité. Préférez des formats explicites comme Avro, Protobuf, ou JSON</p>
</blockquote>
<hr />
<h2 id="iii85-gestion-de-letat-coherence-et-tolerance-aux-pannes">III.8.5 Gestion de l'État, Cohérence et Tolérance aux Pannes<a class="headerlink" href="#iii85-gestion-de-letat-coherence-et-tolerance-aux-pannes" title="Permanent link">&para;</a></h2>
<h3 id="mecanismes-de-persistance-de-letat">Mécanismes de Persistance de l'État<a class="headerlink" href="#mecanismes-de-persistance-de-letat" title="Permanent link">&para;</a></h3>
<p>La gestion de l'état constitue l'un des défis les plus significatifs du traitement de flux distribué. Kafka Streams adopte une approche élégante qui combine stockage local performant et durabilité via Kafka.</p>
<p>Chaque tâche maintient son état dans un magasin local, par défaut implémenté avec RocksDB. RocksDB offre d'excellentes performances pour les charges de travail de type clé-valeur, avec une empreinte mémoire contrôlée grâce à son architecture Log-Structured Merge-Tree (LSM).</p>
<p>Simultanément, chaque modification de l'état est écrite dans un topic Kafka de changelog. Ce topic sert de sauvegarde durable de l'état. En cas de panne, lorsqu'une tâche redémarre sur une nouvelle instance, elle peut restaurer son état en rejouant le changelog depuis le début.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="c1">// Configuration des magasins d&#39;état</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">STATE_DIR_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/var/kafka-streams/state&quot;</span><span class="p">);</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">REPLICATION_FACTOR_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="c1">// Configuration RocksDB personnalisée</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">ROCKSDB_CONFIG_SETTER_CLASS_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">          </span><span class="n">CustomRocksDBConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomRocksDBConfig</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">RocksDBConfigSetter</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setConfig</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">storeName</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">                          </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">configs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">        </span><span class="c1">// Optimisation pour les écritures intensives</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setMaxWriteBufferNumber</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setWriteBufferSize</span><span class="p">(</span><span class="mi">64</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="w">        </span><span class="c1">// Compression</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="w">        </span><span class="n">options</span><span class="p">.</span><span class="na">setCompressionType</span><span class="p">(</span><span class="n">CompressionType</span><span class="p">.</span><span class="na">LZ4_COMPRESSION</span><span class="p">);</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="p">}</span>
</code></pre></div>
<h3 id="garanties-de-traitement">Garanties de Traitement<a class="headerlink" href="#garanties-de-traitement" title="Permanent link">&para;</a></h3>
<p>Kafka Streams offre trois niveaux de garanties de traitement, configurables selon les besoins de l'application.</p>
<p><strong>At-least-once</strong> garantit que chaque enregistrement sera traité au moins une fois. En cas de panne, certains enregistrements peuvent être retraités, produisant potentiellement des doublons. Cette garantie offre les meilleures performances mais nécessite que l'application tolère les doublons ou implémente sa propre déduplication.</p>
<p><strong>At-most-once</strong> garantit qu'aucun enregistrement ne sera traité plus d'une fois, mais certains peuvent être perdus en cas de panne. Cette garantie convient aux applications où la perte occasionnelle est acceptable mais les doublons problématiques.</p>
<p><strong>Exactly-once</strong> garantit que chaque enregistrement sera traité exactement une fois, même en cas de panne. Kafka Streams implémente cette garantie via les transactions Kafka, coordonnant les lectures, les écritures d'état, et les écritures de sortie en une seule transaction atomique.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1">// Configuration exactly-once</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">PROCESSING_GUARANTEE_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">          </span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">EXACTLY_ONCE_V2</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p><strong>Décision architecturale</strong>
<em>Contexte</em> : Système de traitement de paiements nécessitant une cohérence parfaite
<em>Options</em> : (1) At-least-once avec déduplication applicative, (2) Exactly-once natif
<em>Décision</em> : Exactly-once natif (EXACTLY_ONCE_V2) malgré l'overhead de 5-10% car la complexité de la déduplication applicative et le risque d'erreurs dépassaient le coût de performance. Pour un système financier, la garantie intégrée offre plus de confiance que du code personnalisé</p>
</blockquote>
<h3 id="restauration-et-recuperation">Restauration et Récupération<a class="headerlink" href="#restauration-et-recuperation" title="Permanent link">&para;</a></h3>
<p>La restauration de l'état après une panne est un processus critique qui peut impacter significativement la disponibilité de l'application. Kafka Streams offre plusieurs mécanismes pour optimiser ce processus.</p>
<p>Les topics de changelog utilisent la compaction, éliminant les anciennes valeurs pour chaque clé. Cela limite la quantité de données à rejouer lors de la restauration. Cependant, pour des états volumineux, la restauration peut toujours prendre un temps significatif.</p>
<p>Les répliques standby (standby replicas) maintiennent des copies de l'état sur d'autres instances. En cas de panne, une réplique standby peut prendre le relais rapidement, sans restauration complète depuis le changelog.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1">// Configuration des répliques standby</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">NUM_STANDBY_REPLICAS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
</code></pre></div>
<p>Le découplage de la restauration du traitement, introduit dans Kafka 3.8, permet aux tâches de commencer à traiter les nouveaux enregistrements pendant que la restauration de l'état se poursuit en arrière-plan. Cette fonctionnalité réduit significativement l'impact des redémarrages sur la latence de traitement.</p>
<h3 id="coherence-et-ordering">Cohérence et Ordering<a class="headerlink" href="#coherence-et-ordering" title="Permanent link">&para;</a></h3>
<p>Kafka Streams préserve l'ordonnancement des enregistrements au niveau des partitions. Les enregistrements d'une même partition sont traités dans l'ordre exact où ils ont été produits. Cette garantie est essentielle pour de nombreuses applications où l'ordre des événements a une signification métier.</p>
<p>Cependant, l'ordonnancement n'est pas garanti entre partitions différentes. Si une application nécessite un ordonnancement global, elle doit soit utiliser un topic avec une seule partition (sacrifiant le parallélisme), soit implémenter une logique de tri explicite.</p>
<p>Pour les opérations de jointure, Kafka Streams gère la synchronisation entre les flux impliqués. Le mécanisme de fenêtrage temporel définit la fenêtre pendant laquelle des enregistrements de flux différents peuvent être joints, permettant de gérer les arrivées désordonnées.</p>
<h4 id="gestion-des-evenements-tardifs">Gestion des Événements Tardifs<a class="headerlink" href="#gestion-des-evenements-tardifs" title="Permanent link">&para;</a></h4>
<p>Les systèmes de streaming doivent composer avec la réalité des événements qui arrivent en retard. Un événement peut être retardé par des latences réseau, des redémarrages de producteurs, ou simplement par les caractéristiques du système source.</p>
<p>Kafka Streams offre plusieurs mécanismes pour gérer les événements tardifs :</p>
<p><strong>Grace period</strong> : Les fenêtres temporelles peuvent être configurées avec une période de grâce (grace period) pendant laquelle les événements tardifs sont encore acceptés. Après cette période, les événements sont ignorés.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">Windowed</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">events</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">TimeWindows</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">        </span><span class="p">.</span><span class="na">ofSizeWithNoGrace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">        </span><span class="p">.</span><span class="na">grace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="w">  </span><span class="c1">// Accepte les événements jusqu&#39;à 1 minute de retard</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="p">.</span><span class="na">count</span><span class="p">();</span>
</code></pre></div>
<p><strong>Suppression explicite</strong> : L'opérateur <code>suppress()</code> permet de contrôler quand les résultats d'une agrégation sont émis, évitant les émissions intermédiaires qui pourraient être révisées par des événements tardifs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">Windowed</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">finalCounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">counts</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="p">.</span><span class="na">suppress</span><span class="p">(</span><span class="n">Suppressed</span><span class="p">.</span><span class="na">untilWindowCloses</span><span class="p">(</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">        </span><span class="n">Suppressed</span><span class="p">.</span><span class="na">BufferConfig</span><span class="p">.</span><span class="na">unbounded</span><span class="p">()));</span>
</code></pre></div>
<p><strong>Watermarks implicites</strong> : Kafka Streams utilise implicitement les horodatages des enregistrements comme indicateurs de progression temporelle. Le framework avance automatiquement la notion de "temps actuel" basé sur les événements observés.</p>
<h4 id="idempotence-et-deduplication">Idempotence et Déduplication<a class="headerlink" href="#idempotence-et-deduplication" title="Permanent link">&para;</a></h4>
<p>Dans certains scénarios, des enregistrements dupliqués peuvent arriver dans le flux d'entrée. Les causes incluent les réessais des producteurs, les doublons dans les systèmes sources, ou les bugs applicatifs.</p>
<p>Si la logique métier requiert l'unicité des événements, plusieurs approches de déduplication sont possibles :</p>
<p><strong>Déduplication par fenêtre</strong> : Utiliser une agrégation fenêtrée pour tracker les identifiants déjà vus.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deduplicated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">events</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">TimeWindows</span><span class="p">.</span><span class="na">ofSizeWithNoGrace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofHours</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">    </span><span class="p">.</span><span class="na">reduce</span><span class="p">((</span><span class="n">event1</span><span class="p">,</span><span class="w"> </span><span class="n">event2</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">event1</span><span class="p">)</span><span class="w">  </span><span class="c1">// Garde le premier</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="w">    </span><span class="p">.</span><span class="na">toStream</span><span class="p">()</span>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="w">    </span><span class="p">.</span><span class="na">map</span><span class="p">((</span><span class="n">windowedKey</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">KeyValue</span><span class="p">.</span><span class="na">pair</span><span class="p">(</span><span class="n">windowedKey</span><span class="p">.</span><span class="na">key</span><span class="p">(),</span><span class="w"> </span><span class="n">event</span><span class="p">));</span>
</code></pre></div>
<p><strong>Déduplication par table</strong> : Maintenir une table des identifiants uniques.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1">// Filtrage des doublons via jointure avec une table de tracking</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">seen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">events</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">    </span><span class="p">.</span><span class="na">aggregate</span><span class="p">(</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="w">        </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a><span class="w">        </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">existing</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a><span class="w">        </span><span class="n">Materialized</span><span class="p">.</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">Bytes</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;&gt;</span>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="w">            </span><span class="nf">as</span><span class="p">(</span><span class="s">&quot;seen-events&quot;</span><span class="p">)</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="w">            </span><span class="p">.</span><span class="na">withRetention</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofHours</span><span class="p">(</span><span class="mi">24</span><span class="p">)));</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Event</span><span class="o">&gt;</span><span class="w"> </span><span class="n">unique</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">events</span>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="w">    </span><span class="p">.</span><span class="na">leftJoin</span><span class="p">(</span><span class="n">seen</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">seenKey</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">seenKey</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="w">    </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p><strong>Note de terrain</strong>
<em>Contexte</em> : Système de traitement de commandes avec des producteurs parfois instables
<em>Défi</em> : Des commandes dupliquées apparaissaient occasionnellement, causant des problèmes de facturation
<em>Solution</em> : Implémentation d'une déduplication par fenêtre de 24 heures sur l'identifiant de commande. Les doublons sont loggés pour investigation mais filtrés du traitement principal
<em>Leçon</em> : La déduplication a un coût en mémoire et en traitement. Dimensionnez la fenêtre de déduplication selon la probabilité réelle de doublons et le délai maximum acceptable entre les occurrences</p>
</blockquote>
<hr />
<h2 id="iii86-positionnement-dans-lecosysteme">III.8.6 Positionnement dans l'Écosystème<a class="headerlink" href="#iii86-positionnement-dans-lecosysteme" title="Permanent link">&para;</a></h2>
<h3 id="comparaison-avec-apache-flink">Comparaison avec Apache Flink<a class="headerlink" href="#comparaison-avec-apache-flink" title="Permanent link">&para;</a></h3>
<p>Apache Flink représente l'alternative la plus directe à Kafka Streams dans l'écosystème du traitement de flux. Les deux technologies partagent des objectifs similaires mais diffèrent fondamentalement dans leur approche architecturale.</p>
<p>Flink adopte un modèle de cluster : l'utilisateur déploie un cluster Flink (avec JobManager et TaskManagers), puis soumet des jobs à ce cluster. Cette architecture offre une grande puissance et flexibilité, avec des fonctionnalités avancées comme les savepoints, le traitement batch natif, et des APIs de haut niveau incluant SQL et CEP.</p>
<p>Kafka Streams adopte un modèle de bibliothèque : le code de traitement s'exécute directement dans l'application, sans infrastructure supplémentaire. Cette approche simplifie considérablement le déploiement et les opérations, au prix de certaines fonctionnalités avancées.</p>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Kafka Streams</th>
<th>Apache Flink</th>
</tr>
</thead>
<tbody>
<tr>
<td>Modèle de déploiement</td>
<td>Bibliothèque embarquée</td>
<td>Cluster dédié</td>
</tr>
<tr>
<td>Dépendances</td>
<td>Kafka uniquement</td>
<td>Cluster Flink, gestionnaire de ressources</td>
</tr>
<tr>
<td>Persistance de l'état</td>
<td>Topics changelog Kafka</td>
<td>Checkpoints (S3, HDFS, etc.)</td>
</tr>
<tr>
<td>Traitement batch</td>
<td>Via retraitement du journal</td>
<td>Natif, unifié avec streaming</td>
</tr>
<tr>
<td>SQL</td>
<td>Via ksqlDB (externe)</td>
<td>Flink SQL intégré</td>
</tr>
<tr>
<td>Complexité opérationnelle</td>
<td>Faible</td>
<td>Élevée</td>
</tr>
<tr>
<td>Cas d'usage optimaux</td>
<td>Microservices, transformations Kafka-centric</td>
<td>Analyses complexes, très grandes échelles</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Perspective stratégique</strong>
Le choix entre Kafka Streams et Flink dépend souvent du profil de l'équipe et de l'infrastructure existante. Une équipe avec une forte expertise Kafka et une architecture orientée microservices trouvera Kafka Streams naturel. Une équipe avec des data engineers spécialisés et des besoins d'analyses complexes multi-sources bénéficiera davantage de Flink. Dans de nombreuses organisations, les deux technologies coexistent, chacune servant les cas d'usage où elle excelle.</p>
</blockquote>
<h3 id="comparaison-avec-ksqldb">Comparaison avec ksqlDB<a class="headerlink" href="#comparaison-avec-ksqldb" title="Permanent link">&para;</a></h3>
<p>ksqlDB est construit sur Kafka Streams et offre une interface SQL pour le traitement de flux. Il représente une abstraction de niveau supérieur, permettant aux utilisateurs de définir des pipelines de traitement avec des requêtes SQL plutôt que du code Java.</p>
<p>Cette approche abaisse la barrière d'entrée : des analystes et des développeurs familiers avec SQL peuvent créer des applications de streaming sans maîtriser les subtilités de Kafka Streams. Cependant, elle introduit également des contraintes : les cas d'usage non expressibles en SQL nécessitent des fonctions définies par l'utilisateur (UDF) ou un retour à Kafka Streams natif.</p>
<p>ksqlDB adopte un modèle de déploiement de serveur, similaire à Flink. Les requêtes sont soumises à un cluster ksqlDB qui gère leur exécution. Ce modèle simplifie certains aspects (pas besoin de compiler et déployer du code Java) mais réintroduit une infrastructure à gérer.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1">-- Exemple ksqlDB équivalent au code Kafka Streams précédent</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">STREAM</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">    </span><span class="n">transaction_id</span><span class="w"> </span><span class="n">STRING</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">    </span><span class="n">amount</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">,</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">    </span><span class="n">customer_id</span><span class="w"> </span><span class="n">STRING</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="p">)</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">    </span><span class="n">KAFKA_TOPIC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;transactions&#39;</span><span class="p">,</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="w">    </span><span class="n">VALUE_FORMAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;JSON&#39;</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="p">);</span>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">fraud_counts</span><span class="w"> </span><span class="k">AS</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="k">SELECT</span><span class="w"> </span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="w">    </span><span class="n">customer_id</span><span class="p">,</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">suspicious_count</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="k">FROM</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="k">WHERE</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">10000</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="n">WINDOW</span><span class="w"> </span><span class="n">TUMBLING</span><span class="w"> </span><span class="p">(</span><span class="k">SIZE</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">MINUTES</span><span class="p">)</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">customer_id</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="n">EMIT</span><span class="w"> </span><span class="n">CHANGES</span><span class="p">;</span>
</code></pre></div>
<h3 id="integration-avec-lecosysteme-kafka">Intégration avec l'Écosystème Kafka<a class="headerlink" href="#integration-avec-lecosysteme-kafka" title="Permanent link">&para;</a></h3>
<p>Kafka Streams s'intègre naturellement avec les autres composants de l'écosystème Kafka. Kafka Connect peut alimenter les topics d'entrée depuis des sources externes et consommer les topics de sortie vers des systèmes cibles. Schema Registry assure la cohérence des schémas à travers les producteurs et consommateurs.</p>
<p>Cette intégration crée une plateforme cohérente où les données circulent de bout en bout avec des garanties de schéma, de livraison et de traitement. Une architecture typique combine Kafka Connect pour l'ingestion et l'export, Kafka Streams pour les transformations, et potentiellement ksqlDB pour les analyses ad hoc.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>│   Sources       │     │     Kafka       │     │  Destinations   │
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>│  (Databases,    │────▶│                 │────▶│  (Databases,    │
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>│   APIs, etc.)   │     │   + Streams     │     │   Lakes, etc.)  │
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>└─────────────────┘     │   Processing    │     └─────────────────┘
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>        │               └─────────────────┘              │
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>        │                       │                        │
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>        └──────── Kafka Connect ────────┴──── Kafka Connect ─────┘
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>                                │
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>                         Schema Registry
</code></pre></div>
<h3 id="integration-avec-schema-registry_1">Intégration avec Schema Registry<a class="headerlink" href="#integration-avec-schema-registry_1" title="Permanent link">&para;</a></h3>
<p>L'intégration avec Confluent Schema Registry renforce la fiabilité des applications Kafka Streams en assurant la compatibilité des schémas entre producteurs et consommateurs.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">// Configuration pour utiliser Schema Registry avec Avro</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;schema.registry.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;http://schema-registry:8081&quot;</span><span class="p">);</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">          </span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">().</span><span class="na">getClass</span><span class="p">());</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">          </span><span class="n">SpecificAvroSerde</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="c1">// Création d&#39;un Serde Avro avec configuration</span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">serdeConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="n">serdeConfig</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;schema.registry.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;http://schema-registry:8081&quot;</span><span class="p">);</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="n">SpecificAvroSerde</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">transactionSerde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpecificAvroSerde</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a><span class="n">transactionSerde</span><span class="p">.</span><span class="na">configure</span><span class="p">(</span><span class="n">serdeConfig</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a><span class="c1">// Utilisation dans la topologie</span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">transactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">stream</span><span class="p">(</span>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a><span class="w">    </span><span class="s">&quot;transactions&quot;</span><span class="p">,</span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="w">    </span><span class="n">Consumed</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">transactionSerde</span><span class="p">)</span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a><span class="p">);</span>
</code></pre></div>
<p>Les schémas Avro ou Protobuf permettent l'évolution contrôlée des formats de données. Les règles de compatibilité (backward, forward, full) de Schema Registry garantissent que les changements de schéma n'interrompront pas les applications existantes.</p>
<h3 id="patterns-darchitecture-avec-kafka-streams">Patterns d'Architecture avec Kafka Streams<a class="headerlink" href="#patterns-darchitecture-avec-kafka-streams" title="Permanent link">&para;</a></h3>
<p>Plusieurs patterns architecturaux émergent de l'utilisation de Kafka Streams en entreprise :</p>
<p><strong>Pattern Event Sourcing</strong> : Kafka sert de journal d'événements immuable, et Kafka Streams matérialise les vues dérivées. Ce pattern est particulièrement puissant pour les systèmes nécessitant un historique complet et la capacité de reconstruire l'état à partir des événements.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="c1">// Event sourcing : agrégation des événements en état</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountEvents</span>
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="w">    </span><span class="p">.</span><span class="na">groupByKey</span><span class="p">()</span>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="w">    </span><span class="p">.</span><span class="na">aggregate</span><span class="p">(</span>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">        </span><span class="n">Account</span><span class="p">::</span><span class="k">new</span><span class="p">,</span>
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">        </span><span class="p">(</span><span class="n">accountId</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">,</span><span class="w"> </span><span class="n">account</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">account</span><span class="p">.</span><span class="na">apply</span><span class="p">(</span><span class="n">event</span><span class="p">),</span>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a><span class="w">        </span><span class="n">Materialized</span><span class="p">.</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Account</span><span class="p">,</span><span class="w"> </span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">Bytes</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;&gt;</span>
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">            </span><span class="nf">as</span><span class="p">(</span><span class="s">&quot;account-store&quot;</span><span class="p">)</span>
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="p">);</span>
</code></pre></div>
<p><strong>Pattern CQRS (Command Query Responsibility Segregation)</strong> : Les commandes sont publiées vers des topics Kafka, traitées par des consommateurs qui mettent à jour l'état autoritatif, puis Kafka Streams construit des vues optimisées pour les requêtes.</p>
<p><strong>Pattern Saga</strong> : Pour les transactions distribuées, Kafka Streams peut orchestrer des sagas en maintenant l'état de la transaction et en émettant les commandes de compensation en cas d'échec.</p>
<h3 id="integration-avec-lintelligence-artificielle-et-le-machine-learning">Intégration avec l'Intelligence Artificielle et le Machine Learning<a class="headerlink" href="#integration-avec-lintelligence-artificielle-et-le-machine-learning" title="Permanent link">&para;</a></h3>
<p>L'intégration de Kafka Streams avec les pipelines d'intelligence artificielle et d'apprentissage automatique représente une tendance majeure de l'industrie. Cette convergence permet de déployer des modèles d'IA en production avec une inférence en temps réel sur les flux de données.</p>
<h4 id="feature-engineering-en-temps-reel">Feature Engineering en Temps Réel<a class="headerlink" href="#feature-engineering-en-temps-reel" title="Permanent link">&para;</a></h4>
<p>Le feature engineering constitue souvent le goulot d'étranglement des pipelines ML. Kafka Streams permet de calculer des features en temps réel, éliminant le décalage entre les features d'entraînement et celles utilisées en production.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c1">// Calcul de features en temps réel pour un modèle de fraude</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="n">KTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerFeatures</span><span class="o">&gt;</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="w">    </span><span class="p">.</span><span class="na">groupBy</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">KeyValue</span><span class="p">.</span><span class="na">pair</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="na">getCustomerId</span><span class="p">(),</span><span class="w"> </span><span class="n">tx</span><span class="p">))</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w">    </span><span class="p">.</span><span class="na">windowedBy</span><span class="p">(</span><span class="n">TimeWindows</span><span class="p">.</span><span class="na">ofSizeWithNoGrace</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofHours</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">    </span><span class="p">.</span><span class="na">aggregate</span><span class="p">(</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">        </span><span class="n">CustomerFeatures</span><span class="p">::</span><span class="k">new</span><span class="p">,</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">        </span><span class="p">(</span><span class="n">customerId</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">features</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">features</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">            </span><span class="p">.</span><span class="na">incrementTransactionCount</span><span class="p">()</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">            </span><span class="p">.</span><span class="na">updateAverageAmount</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="na">getAmount</span><span class="p">())</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="w">            </span><span class="p">.</span><span class="na">updateMaxAmount</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="na">getAmount</span><span class="p">())</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">            </span><span class="p">.</span><span class="na">addMerchantCategory</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="na">getMerchantCategory</span><span class="p">())</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="w">            </span><span class="p">.</span><span class="na">calculateVelocity</span><span class="p">(),</span>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="w">        </span><span class="n">Materialized</span><span class="p">.</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerFeatures</span><span class="p">,</span><span class="w"> </span><span class="n">WindowStore</span><span class="o">&lt;</span><span class="n">Bytes</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;&gt;</span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="w">            </span><span class="nf">as</span><span class="p">(</span><span class="s">&quot;customer-features-store&quot;</span><span class="p">)</span>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="w">    </span><span class="p">)</span>
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w">    </span><span class="p">.</span><span class="na">toStream</span><span class="p">()</span>
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="w">    </span><span class="p">.</span><span class="na">map</span><span class="p">((</span><span class="n">windowedKey</span><span class="p">,</span><span class="w"> </span><span class="n">features</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="w">        </span><span class="n">KeyValue</span><span class="p">.</span><span class="na">pair</span><span class="p">(</span><span class="n">windowedKey</span><span class="p">.</span><span class="na">key</span><span class="p">(),</span><span class="w"> </span><span class="n">features</span><span class="p">))</span>
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="w">    </span><span class="p">.</span><span class="na">toTable</span><span class="p">();</span>
</code></pre></div>
<h4 id="inference-de-modeles-en-streaming">Inférence de Modèles en Streaming<a class="headerlink" href="#inference-de-modeles-en-streaming" title="Permanent link">&para;</a></h4>
<p>Les modèles ML peuvent être invoqués directement dans le flux de traitement Kafka Streams. Pour maintenir les performances, les modèles sont généralement chargés en mémoire et invoqués de manière synchrone.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FraudDetectionProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ValueTransformer</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="p">,</span><span class="w"> </span><span class="n">ScoredTransaction</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">OnnxRuntime</span><span class="w"> </span><span class="n">modelRuntime</span><span class="p">;</span>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerFeatures</span><span class="o">&gt;</span><span class="w"> </span><span class="n">featureStore</span><span class="p">;</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="n">ProcessorContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">featureStore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getStateStore</span><span class="p">(</span><span class="s">&quot;customer-features-store&quot;</span><span class="p">);</span>
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a><span class="w">        </span><span class="c1">// Chargement du modèle ONNX</span>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">modelRuntime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OnnxRuntime</span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="s">&quot;fraud-model.onnx&quot;</span><span class="p">);</span>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ScoredTransaction</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="n">Transaction</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a><span class="w">        </span><span class="c1">// Récupération des features</span>
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a><span class="w">        </span><span class="n">CustomerFeatures</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">featureStore</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">tx</span><span class="p">.</span><span class="na">getCustomerId</span><span class="p">());</span>
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">features</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a><span class="w">            </span><span class="n">features</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CustomerFeatures</span><span class="p">.</span><span class="na">defaultFeatures</span><span class="p">();</span>
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a><span class="w">        </span><span class="c1">// Construction du vecteur d&#39;entrée</span>
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a><span class="w">        </span><span class="kt">float</span><span class="o">[]</span><span class="w"> </span><span class="n">inputVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">features</span><span class="p">.</span><span class="na">toModelInput</span><span class="p">(</span><span class="n">tx</span><span class="p">);</span>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a><span class="w">        </span><span class="c1">// Inférence</span>
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a><span class="w">        </span><span class="kt">float</span><span class="w"> </span><span class="n">fraudScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modelRuntime</span><span class="p">.</span><span class="na">predict</span><span class="p">(</span><span class="n">inputVector</span><span class="p">);</span>
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a>
<a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ScoredTransaction</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">fraudScore</span><span class="p">);</span>
<a id="__codelineno-33-28" name="__codelineno-33-28" href="#__codelineno-33-28"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-33-29" name="__codelineno-33-29" href="#__codelineno-33-29"></a><span class="p">}</span>
<a id="__codelineno-33-30" name="__codelineno-33-30" href="#__codelineno-33-30"></a>
<a id="__codelineno-33-31" name="__codelineno-33-31" href="#__codelineno-33-31"></a><span class="c1">// Intégration dans la topologie</span>
<a id="__codelineno-33-32" name="__codelineno-33-32" href="#__codelineno-33-32"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">ScoredTransaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">scoredTransactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-33-33" name="__codelineno-33-33" href="#__codelineno-33-33"></a><span class="w">    </span><span class="p">.</span><span class="na">transformValues</span><span class="p">(</span><span class="n">FraudDetectionProcessor</span><span class="p">::</span><span class="k">new</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;customer-features-store&quot;</span><span class="p">);</span>
</code></pre></div>
<h4 id="mise-a-jour-des-modeles-en-production">Mise à Jour des Modèles en Production<a class="headerlink" href="#mise-a-jour-des-modeles-en-production" title="Permanent link">&para;</a></h4>
<p>La mise à jour des modèles ML sans interruption de service est un défi opérationnel significatif. Plusieurs stratégies sont possibles avec Kafka Streams :</p>
<p><strong>Rechargement à chaud</strong> : Le modèle est stocké dans un topic Kafka et chargé via une GlobalKTable. Les mises à jour du modèle sont publiées vers ce topic et propagées automatiquement à toutes les instances.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1">// Chargement du modèle depuis un topic Kafka</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">GlobalKTable</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">modelTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">globalTable</span><span class="p">(</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">    </span><span class="s">&quot;ml-models&quot;</span><span class="p">,</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">    </span><span class="n">Consumed</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">Serdes</span><span class="p">.</span><span class="na">ByteArray</span><span class="p">()),</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">    </span><span class="n">Materialized</span><span class="p">.</span><span class="na">as</span><span class="p">(</span><span class="s">&quot;models-store&quot;</span><span class="p">)</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="p">);</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="c1">// Le processeur récupère la dernière version du modèle</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DynamicModelProcessor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ValueTransformer</span><span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">modelStore</span><span class="p">;</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">volatile</span><span class="w"> </span><span class="n">OnnxRuntime</span><span class="w"> </span><span class="n">currentModel</span><span class="p">;</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">volatile</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">modelVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ScoredTransaction</span><span class="w"> </span><span class="nf">transform</span><span class="p">(</span><span class="n">Transaction</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="w">        </span><span class="c1">// Vérification de mise à jour du modèle</span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a><span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">modelBytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modelStore</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;fraud-model-v2&quot;</span><span class="p">);</span>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">modelBytes</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">needsReload</span><span class="p">(</span><span class="n">modelBytes</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="w">            </span><span class="n">reloadModel</span><span class="p">(</span><span class="n">modelBytes</span><span class="p">);</span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="w">        </span><span class="c1">// Inférence avec le modèle courant</span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">currentModel</span><span class="p">.</span><span class="na">predict</span><span class="p">(</span><span class="n">tx</span><span class="p">);</span>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a><span class="p">}</span>
</code></pre></div>
<p><strong>Déploiement canari</strong> : Plusieurs versions du modèle coexistent, et le routage vers l'une ou l'autre est contrôlé par configuration.</p>
<blockquote>
<p><strong>Perspective stratégique</strong>
L'intégration du ML dans les pipelines Kafka Streams représente une convergence stratégique majeure. Les organisations qui maîtrisent cette intégration peuvent déployer des capacités prédictives en temps réel : détection de fraude, recommandations personnalisées, maintenance prédictive. Cette capacité devient un différenciateur concurrentiel significatif dans de nombreux secteurs</p>
<p><strong>Perspective stratégique</strong>
L'écosystème Kafka offre une flexibilité exceptionnelle pour composer des architectures adaptées aux besoins spécifiques. Une organisation peut commencer avec Kafka Streams pour des transformations simples, ajouter ksqlDB pour les analyses ad hoc, et éventuellement introduire Flink pour les cas d'usage les plus exigeants. Cette approche incrémentale réduit les risques et permet une montée en compétences progressive des équipes.</p>
</blockquote>
<hr />
<h2 id="iii87-considerations-operationnelles">III.8.7 Considérations Opérationnelles<a class="headerlink" href="#iii87-considerations-operationnelles" title="Permanent link">&para;</a></h2>
<h3 id="dimensionnement-et-capacite">Dimensionnement et Capacité<a class="headerlink" href="#dimensionnement-et-capacite" title="Permanent link">&para;</a></h3>
<p>Le dimensionnement d'une application Kafka Streams requiert une compréhension des facteurs qui influencent les performances et les ressources nécessaires.</p>
<p>Le nombre de partitions des topics d'entrée détermine le parallélisme maximal. Une règle empirique suggère de prévoir suffisamment de partitions pour le niveau de parallélisme anticipé, avec une marge pour la croissance future. Augmenter le nombre de partitions après coup est possible mais complexe.</p>
<p>La mémoire requise dépend principalement de la taille de l'état maintenu. Pour les applications avec état, chaque tâche maintient une portion de l'état en mémoire (via les caches RocksDB). La configuration des caches et des write buffers influence significativement l'empreinte mémoire.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="c1">// Configuration mémoire</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">CACHE_MAX_BYTES_BUFFERING_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">          </span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w"> </span><span class="c1">// 100 MB de cache global</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">COMMIT_INTERVAL_MS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span>
</code></pre></div>
<p>Le nombre de threads par instance influence l'utilisation du CPU. Par défaut, Kafka Streams utilise un thread par instance. Augmenter ce nombre permet de paralléliser le traitement sur les cœurs disponibles, mais ajoute de la complexité dans la gestion des ressources.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">NUM_STREAM_THREADS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
</code></pre></div>
<h3 id="surveillance-et-metriques">Surveillance et Métriques<a class="headerlink" href="#surveillance-et-metriques" title="Permanent link">&para;</a></h3>
<p>Kafka Streams expose un ensemble riche de métriques via JMX, couvrant tous les aspects du traitement. Ces métriques sont essentielles pour comprendre le comportement de l'application et détecter les problèmes.</p>
<p>Les métriques de traitement incluent le nombre d'enregistrements traités, la latence de traitement, et le taux de traitement. Elles permettent de comprendre la charge et les performances de l'application.</p>
<p>Les métriques d'état couvrent la taille des magasins d'état, les opérations de lecture/écriture, et le temps de restauration. Elles aident à anticiper les besoins en stockage et à diagnostiquer les problèmes de performance liés à l'état.</p>
<p>Les métriques de consommateur reflètent le lag (retard) par rapport aux producteurs, les rebalances, et les erreurs de consommation. Le lag est particulièrement critique : un lag croissant indique que l'application ne suit pas le rythme d'arrivée des données.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="c1">// Accès programmatique aux métriques</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="n">Map</span><span class="o">&lt;</span><span class="n">MetricName</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Metric</span><span class="o">&gt;</span><span class="w"> </span><span class="n">metrics</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">streams</span><span class="p">.</span><span class="na">metrics</span><span class="p">();</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">MetricName</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Metric</span><span class="o">&gt;</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">metrics</span><span class="p">.</span><span class="na">entrySet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">().</span><span class="na">name</span><span class="p">().</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;process-rate&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">printf</span><span class="p">(</span><span class="s">&quot;%s: %s%n&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="w">            </span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">().</span><span class="na">name</span><span class="p">(),</span><span class="w"> </span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="w">            </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">().</span><span class="na">metricValue</span><span class="p">());</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="p">}</span>
</code></pre></div>
<blockquote>
<p><strong>Note de terrain</strong>
<em>Contexte</em> : Déploiement en production d'une application Kafka Streams de traitement de clics
<em>Défi</em> : Pics de latence inexpliqués corrélés avec les heures de pointe
<em>Solution</em> : L'analyse des métriques a révélé que les compactions RocksDB causaient des pics de latence. Nous avons ajusté les paramètres de compaction pour étaler le travail et configuré des alertes sur les métriques de compaction
<em>Leçon</em> : Les métriques granulaires de Kafka Streams et RocksDB sont indispensables pour le diagnostic. Investir dans un tableau de bord complet avant la mise en production évite des heures de débogage ultérieur</p>
</blockquote>
<h3 id="deploiement-et-mise-a-lechelle">Déploiement et Mise à l'Échelle<a class="headerlink" href="#deploiement-et-mise-a-lechelle" title="Permanent link">&para;</a></h3>
<p>Le déploiement d'applications Kafka Streams suit les pratiques standard des applications Java. Aucune infrastructure spécifique n'est requise ; l'application peut être déployée sur des machines virtuelles, dans des conteneurs, ou sur Kubernetes.</p>
<p>La mise à l'échelle horizontale s'effectue simplement en démarrant de nouvelles instances. Kafka Streams coordonne automatiquement la redistribution des tâches via le protocole de group membership de Kafka. Ce processus, appelé rebalance, redistribue les partitions entre les instances disponibles.</p>
<p>Les rebalances peuvent causer une interruption temporaire du traitement pendant que les tâches migrent et restaurent leur état. Plusieurs stratégies permettent de minimiser cet impact :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1">// Configuration pour minimiser l&#39;impact des rebalances</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">NUM_STANDBY_REPLICAS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">ConsumerConfig</span><span class="p">.</span><span class="na">MAX_POLL_INTERVAL_MS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">300000</span><span class="p">);</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">ConsumerConfig</span><span class="p">.</span><span class="na">SESSION_TIMEOUT_MS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">30000</span><span class="p">);</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="c1">// Sticky assignor pour minimiser les migrations</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">ConsumerConfig</span><span class="p">.</span><span class="na">PARTITION_ASSIGNMENT_STRATEGY_CONFIG</span><span class="p">,</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">          </span><span class="s">&quot;org.apache.kafka.clients.consumer.StickyAssignor&quot;</span><span class="p">);</span>
</code></pre></div>
<h4 id="pieges-courants-a-eviter">Pièges Courants à Éviter<a class="headerlink" href="#pieges-courants-a-eviter" title="Permanent link">&para;</a></h4>
<p>L'expérience du terrain révèle plusieurs pièges fréquents que les équipes rencontrent lors de l'adoption de Kafka Streams :</p>
<p><strong>Sous-estimation de la taille de l'état</strong> : Les agrégations et jointures accumulent de l'état qui peut croître rapidement. Surveillez la taille des magasins d'état et planifiez le stockage en conséquence.</p>
<p><strong>Configuration de rétention inadaptée</strong> : Les topics de changelog doivent avoir une rétention suffisante pour permettre la restauration complète de l'état. Une rétention trop courte peut causer des pertes de données.</p>
<p><strong>Negliger les métriques</strong> : Les applications de streaming génèrent un volume important de métriques. Sans surveillance adéquate, les problèmes peuvent passer inaperçus jusqu'à ce qu'ils deviennent critiques.</p>
<p><strong>Ignorer les tests</strong> : La bibliothèque TopologyTestDriver permet de tester les topologies sans cluster Kafka. Négliger ces tests conduit à des surprises en production.</p>
<p><strong>Couplage fort entre services</strong> : Bien que Kafka Streams simplifie les transformations Kafka-à-Kafka, évitez de créer des chaînes de dépendances trop longues qui compliquent les opérations.</p>
<h3 id="deploiement-sur-kubernetes">Déploiement sur Kubernetes<a class="headerlink" href="#deploiement-sur-kubernetes" title="Permanent link">&para;</a></h3>
<p>Le déploiement d'applications Kafka Streams sur Kubernetes est devenu le standard dans les environnements infonuagiques modernes. Cette plateforme offre des capacités d'orchestration qui complètent naturellement les caractéristiques de Kafka Streams.</p>
<h4 id="configuration-kubernetes-de-base">Configuration Kubernetes de Base<a class="headerlink" href="#configuration-kubernetes-de-base" title="Permanent link">&para;</a></h4>
<p>Un déploiement Kafka Streams typique sur Kubernetes utilise un Deployment (ou StatefulSet pour les applications avec état volumineux) avec des configurations appropriées pour la haute disponibilité.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer-360-streams</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer-360</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer-360</span>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer-360</span>
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">streams-app</span>
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.example.com/customer-360:v1.2.0</span>
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="w">        </span><span class="nt">resources</span><span class="p">:</span>
<a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a><span class="w">          </span><span class="nt">requests</span><span class="p">:</span>
<a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a><span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2Gi&quot;</span>
<a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a><span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000m&quot;</span>
<a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a><span class="w">          </span><span class="nt">limits</span><span class="p">:</span>
<a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a><span class="w">            </span><span class="nt">memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4Gi&quot;</span>
<a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a><span class="w">            </span><span class="nt">cpu</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2000m&quot;</span>
<a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KAFKA_BOOTSTRAP_SERVERS</span>
<a id="__codelineno-39-29" name="__codelineno-39-29" href="#__codelineno-39-29"></a><span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<a id="__codelineno-39-30" name="__codelineno-39-30" href="#__codelineno-39-30"></a><span class="w">            </span><span class="nt">configMapKeyRef</span><span class="p">:</span>
<a id="__codelineno-39-31" name="__codelineno-39-31" href="#__codelineno-39-31"></a><span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka-config</span>
<a id="__codelineno-39-32" name="__codelineno-39-32" href="#__codelineno-39-32"></a><span class="w">              </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bootstrap-servers</span>
<a id="__codelineno-39-33" name="__codelineno-39-33" href="#__codelineno-39-33"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">APPLICATION_SERVER</span>
<a id="__codelineno-39-34" name="__codelineno-39-34" href="#__codelineno-39-34"></a><span class="w">          </span><span class="nt">valueFrom</span><span class="p">:</span>
<a id="__codelineno-39-35" name="__codelineno-39-35" href="#__codelineno-39-35"></a><span class="w">            </span><span class="nt">fieldRef</span><span class="p">:</span>
<a id="__codelineno-39-36" name="__codelineno-39-36" href="#__codelineno-39-36"></a><span class="w">              </span><span class="nt">fieldPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status.podIP</span>
<a id="__codelineno-39-37" name="__codelineno-39-37" href="#__codelineno-39-37"></a><span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<a id="__codelineno-39-38" name="__codelineno-39-38" href="#__codelineno-39-38"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="__codelineno-39-39" name="__codelineno-39-39" href="#__codelineno-39-39"></a><span class="w">          </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<a id="__codelineno-39-40" name="__codelineno-39-40" href="#__codelineno-39-40"></a><span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<a id="__codelineno-39-41" name="__codelineno-39-41" href="#__codelineno-39-41"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-dir</span>
<a id="__codelineno-39-42" name="__codelineno-39-42" href="#__codelineno-39-42"></a><span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/kafka-streams</span>
<a id="__codelineno-39-43" name="__codelineno-39-43" href="#__codelineno-39-43"></a><span class="w">        </span><span class="nt">livenessProbe</span><span class="p">:</span>
<a id="__codelineno-39-44" name="__codelineno-39-44" href="#__codelineno-39-44"></a><span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<a id="__codelineno-39-45" name="__codelineno-39-45" href="#__codelineno-39-45"></a><span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health/live</span>
<a id="__codelineno-39-46" name="__codelineno-39-46" href="#__codelineno-39-46"></a><span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="__codelineno-39-47" name="__codelineno-39-47" href="#__codelineno-39-47"></a><span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<a id="__codelineno-39-48" name="__codelineno-39-48" href="#__codelineno-39-48"></a><span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<a id="__codelineno-39-49" name="__codelineno-39-49" href="#__codelineno-39-49"></a><span class="w">        </span><span class="nt">readinessProbe</span><span class="p">:</span>
<a id="__codelineno-39-50" name="__codelineno-39-50" href="#__codelineno-39-50"></a><span class="w">          </span><span class="nt">httpGet</span><span class="p">:</span>
<a id="__codelineno-39-51" name="__codelineno-39-51" href="#__codelineno-39-51"></a><span class="w">            </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/health/ready</span>
<a id="__codelineno-39-52" name="__codelineno-39-52" href="#__codelineno-39-52"></a><span class="w">            </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<a id="__codelineno-39-53" name="__codelineno-39-53" href="#__codelineno-39-53"></a><span class="w">          </span><span class="nt">initialDelaySeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<a id="__codelineno-39-54" name="__codelineno-39-54" href="#__codelineno-39-54"></a><span class="w">          </span><span class="nt">periodSeconds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<a id="__codelineno-39-55" name="__codelineno-39-55" href="#__codelineno-39-55"></a><span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<a id="__codelineno-39-56" name="__codelineno-39-56" href="#__codelineno-39-56"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-dir</span>
<a id="__codelineno-39-57" name="__codelineno-39-57" href="#__codelineno-39-57"></a><span class="w">        </span><span class="nt">emptyDir</span><span class="p">:</span>
<a id="__codelineno-39-58" name="__codelineno-39-58" href="#__codelineno-39-58"></a><span class="w">          </span><span class="nt">sizeLimit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10Gi</span>
</code></pre></div>
<h4 id="gestion-de-letat-avec-des-volumes-persistants">Gestion de l'État avec des Volumes Persistants<a class="headerlink" href="#gestion-de-letat-avec-des-volumes-persistants" title="Permanent link">&para;</a></h4>
<p>Pour les applications avec un état volumineux où la restauration depuis le changelog serait trop longue, l'utilisation de volumes persistants peut accélérer significativement les redémarrages.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">StatefulSet</span>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stateful-streams-app</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">  </span><span class="nt">serviceName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">streams-headless</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">stateful-streams</span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">streams-app</span>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="w">        </span><span class="nt">volumeMounts</span><span class="p">:</span>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-storage</span>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="w">          </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/kafka-streams</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="w">  </span><span class="nt">volumeClaimTemplates</span><span class="p">:</span>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state-storage</span>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="w">      </span><span class="nt">accessModes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;ReadWriteOnce&quot;</span><span class="p p-Indicator">]</span>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="w">      </span><span class="nt">storageClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fast-ssd</span>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="w">      </span><span class="nt">resources</span><span class="p">:</span>
<a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a><span class="w">        </span><span class="nt">requests</span><span class="p">:</span>
<a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a><span class="w">          </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50Gi</span>
</code></pre></div>
<h4 id="auto-scaling-horizontal">Auto-scaling Horizontal<a class="headerlink" href="#auto-scaling-horizontal" title="Permanent link">&para;</a></h4>
<p>Le Horizontal Pod Autoscaler (HPA) peut être configuré pour ajuster automatiquement le nombre de réplicas en fonction de métriques personnalisées, notamment le lag consommateur.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autoscaling/v2</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HorizontalPodAutoscaler</span>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="nt">metadata</span><span class="p">:</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">streams-hpa</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="nt">spec</span><span class="p">:</span>
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">  </span><span class="nt">scaleTargetRef</span><span class="p">:</span>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="w">    </span><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer-360-streams</span>
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="w">  </span><span class="nt">minReplicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">  </span><span class="nt">maxReplicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">  </span><span class="nt">metrics</span><span class="p">:</span>
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">External</span>
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span>
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="w">      </span><span class="nt">metric</span><span class="p">:</span>
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a><span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kafka_consumer_lag</span>
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a><span class="w">        </span><span class="nt">selector</span><span class="p">:</span>
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a><span class="w">          </span><span class="nt">matchLabels</span><span class="p">:</span>
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a><span class="w">            </span><span class="nt">consumer_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customer-360-app</span>
<a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="w">      </span><span class="nt">target</span><span class="p">:</span>
<a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AverageValue</span>
<a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a><span class="w">        </span><span class="nt">averageValue</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
</code></pre></div>
<blockquote>
<p><strong>Note de terrain</strong>
<em>Contexte</em> : Déploiement d'une application Kafka Streams critique sur un cluster Kubernetes géré (GKE)
<em>Défi</em> : Les rebalances fréquentes lors des mises à l'échelle automatiques causaient des pics de latence
<em>Solution</em> : Configuration d'un PodDisruptionBudget pour limiter les disruptions, utilisation de standby replicas, et ajustement des seuils HPA pour éviter les oscillations
<em>Leçon</em> : L'auto-scaling de Kafka Streams sur Kubernetes requiert une configuration soignée pour éviter les rebalances excessives. Préférez des seuils conservateurs et des fenêtres de stabilisation longues</p>
</blockquote>
<h3 id="gestion-des-erreurs-et-resilience">Gestion des Erreurs et Résilience<a class="headerlink" href="#gestion-des-erreurs-et-resilience" title="Permanent link">&para;</a></h3>
<p>Les applications de streaming doivent gérer gracieusement les erreurs pour maintenir la disponibilité. Kafka Streams offre plusieurs mécanismes pour la gestion des erreurs.</p>
<p>Les erreurs de désérialisation surviennent quand un enregistrement ne peut pas être décodé selon le schéma attendu. Par défaut, ces erreurs arrêtent l'application. Un handler personnalisé permet un comportement plus tolérant :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">DEFAULT_DESERIALIZATION_EXCEPTION_HANDLER_CLASS_CONFIG</span><span class="p">,</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">          </span><span class="n">LogAndContinueExceptionHandler</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="c1">// Ou un handler personnalisé</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomDeserializationHandler</span><span class="w"> </span>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">    </span><span class="kd">implements</span><span class="w"> </span><span class="n">DeserializationExceptionHandler</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">    </span><span class="nd">@Override</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">DeserializationHandlerResponse</span><span class="w"> </span><span class="nf">handle</span><span class="p">(</span><span class="n">ProcessorContext</span><span class="w"> </span><span class="n">context</span><span class="p">,</span>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">                                                  </span><span class="n">ConsumerRecord</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">record</span><span class="p">,</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">                                                  </span><span class="n">Exception</span><span class="w"> </span><span class="n">exception</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Erreur de désérialisation: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">        </span><span class="n">metrics</span><span class="p">.</span><span class="na">incrementCounter</span><span class="p">(</span><span class="s">&quot;deserialization.errors&quot;</span><span class="p">);</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">DeserializationHandlerResponse</span><span class="p">.</span><span class="na">CONTINUE</span><span class="p">;</span>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="p">}</span>
</code></pre></div>
<p>Les erreurs de production surviennent quand un enregistrement ne peut pas être écrit vers le topic de destination. Un handler similaire permet de gérer ces cas :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">DEFAULT_PRODUCTION_EXCEPTION_HANDLER_CLASS_CONFIG</span><span class="p">,</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">          </span><span class="n">CustomProductionHandler</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</code></pre></div>
<p>Les exceptions non gérées dans la logique de traitement peuvent être capturées via un uncaught exception handler :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">streams</span><span class="p">.</span><span class="na">setUncaughtExceptionHandler</span><span class="p">((</span><span class="n">thread</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">    </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Exception non gérée dans {}: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">thread</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="p">);</span>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">StreamsUncaughtExceptionHandler</span><span class="p">.</span><span class="na">StreamThreadExceptionResponse</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">        </span><span class="p">.</span><span class="na">REPLACE_THREAD</span><span class="p">;</span>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="p">});</span>
</code></pre></div>
<h3 id="tests-des-applications-kafka-streams">Tests des Applications Kafka Streams<a class="headerlink" href="#tests-des-applications-kafka-streams" title="Permanent link">&para;</a></h3>
<p>Le test des applications Kafka Streams est facilité par la bibliothèque TopologyTestDriver, qui permet d'exécuter les topologies sans cluster Kafka réel.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FraudDetectionTest</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TopologyTestDriver</span><span class="w"> </span><span class="n">testDriver</span><span class="p">;</span>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TestInputTopic</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inputTopic</span><span class="p">;</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TestOutputTopic</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Alert</span><span class="o">&gt;</span><span class="w"> </span><span class="n">outputTopic</span><span class="p">;</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">    </span><span class="nd">@BeforeEach</span>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">        </span><span class="n">Properties</span><span class="w"> </span><span class="n">props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">APPLICATION_ID_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">);</span>
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w">        </span><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">BOOTSTRAP_SERVERS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;dummy:9092&quot;</span><span class="p">);</span>
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w">        </span><span class="n">StreamsBuilder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StreamsBuilder</span><span class="p">();</span>
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="w">        </span><span class="n">FraudDetectionApp</span><span class="p">.</span><span class="na">buildTopology</span><span class="p">(</span><span class="n">builder</span><span class="p">);</span>
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="w">        </span><span class="n">testDriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TopologyTestDriver</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">(),</span><span class="w"> </span><span class="n">props</span><span class="p">);</span>
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a><span class="w">        </span><span class="n">inputTopic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testDriver</span><span class="p">.</span><span class="na">createInputTopic</span><span class="p">(</span>
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="w">            </span><span class="s">&quot;transactions&quot;</span><span class="p">,</span>
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">StringSerializer</span><span class="p">(),</span>
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">TransactionSerializer</span><span class="p">()</span>
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a><span class="w">        </span><span class="n">outputTopic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">testDriver</span><span class="p">.</span><span class="na">createOutputTopic</span><span class="p">(</span>
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a><span class="w">            </span><span class="s">&quot;fraud-alerts&quot;</span><span class="p">,</span>
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">StringDeserializer</span><span class="p">(),</span>
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">AlertDeserializer</span><span class="p">()</span>
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a><span class="w">        </span><span class="p">);</span>
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a>
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldDetectHighValueTransaction</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a><span class="w">        </span><span class="c1">// Given</span>
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a><span class="w">        </span><span class="n">Transaction</span><span class="w"> </span><span class="n">tx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Transaction</span><span class="p">(</span><span class="s">&quot;tx-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;customer-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">15000.0</span><span class="p">);</span>
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a>
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a><span class="w">        </span><span class="c1">// When</span>
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a><span class="w">        </span><span class="n">inputTopic</span><span class="p">.</span><span class="na">pipeInput</span><span class="p">(</span><span class="s">&quot;tx-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">);</span>
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a>
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a><span class="w">        </span><span class="c1">// Then</span>
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a><span class="w">        </span><span class="n">assertFalse</span><span class="p">(</span><span class="n">outputTopic</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">());</span>
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a><span class="w">        </span><span class="n">Alert</span><span class="w"> </span><span class="n">alert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">outputTopic</span><span class="p">.</span><span class="na">readValue</span><span class="p">();</span>
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a><span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="s">&quot;customer-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alert</span><span class="p">.</span><span class="na">getCustomerId</span><span class="p">());</span>
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a><span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">AlertType</span><span class="p">.</span><span class="na">HIGH_VALUE</span><span class="p">,</span><span class="w"> </span><span class="n">alert</span><span class="p">.</span><span class="na">getType</span><span class="p">());</span>
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a>
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a><span class="w">    </span><span class="nd">@Test</span>
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldAggregateTransactionsInWindow</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a><span class="w">        </span><span class="c1">// Test des agrégations fenêtrées</span>
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a><span class="w">        </span><span class="n">Instant</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Instant</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a>
<a id="__codelineno-45-51" name="__codelineno-45-51" href="#__codelineno-45-51"></a><span class="w">        </span><span class="n">inputTopic</span><span class="p">.</span><span class="na">pipeInput</span><span class="p">(</span><span class="s">&quot;tx-1&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-45-52" name="__codelineno-45-52" href="#__codelineno-45-52"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Transaction</span><span class="p">(</span><span class="s">&quot;tx-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;customer-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0</span><span class="p">),</span><span class="w"> </span><span class="n">now</span><span class="p">);</span>
<a id="__codelineno-45-53" name="__codelineno-45-53" href="#__codelineno-45-53"></a><span class="w">        </span><span class="n">inputTopic</span><span class="p">.</span><span class="na">pipeInput</span><span class="p">(</span><span class="s">&quot;tx-2&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-45-54" name="__codelineno-45-54" href="#__codelineno-45-54"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Transaction</span><span class="p">(</span><span class="s">&quot;tx-2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;customer-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">200.0</span><span class="p">),</span><span class="w"> </span><span class="n">now</span><span class="p">.</span><span class="na">plusSeconds</span><span class="p">(</span><span class="mi">60</span><span class="p">));</span>
<a id="__codelineno-45-55" name="__codelineno-45-55" href="#__codelineno-45-55"></a><span class="w">        </span><span class="n">inputTopic</span><span class="p">.</span><span class="na">pipeInput</span><span class="p">(</span><span class="s">&quot;tx-3&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-45-56" name="__codelineno-45-56" href="#__codelineno-45-56"></a><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Transaction</span><span class="p">(</span><span class="s">&quot;tx-3&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;customer-1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">300.0</span><span class="p">),</span><span class="w"> </span><span class="n">now</span><span class="p">.</span><span class="na">plusSeconds</span><span class="p">(</span><span class="mi">120</span><span class="p">));</span>
<a id="__codelineno-45-57" name="__codelineno-45-57" href="#__codelineno-45-57"></a>
<a id="__codelineno-45-58" name="__codelineno-45-58" href="#__codelineno-45-58"></a><span class="w">        </span><span class="c1">// Avancer le temps pour fermer la fenêtre</span>
<a id="__codelineno-45-59" name="__codelineno-45-59" href="#__codelineno-45-59"></a><span class="w">        </span><span class="n">testDriver</span><span class="p">.</span><span class="na">advanceWallClockTime</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMinutes</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
<a id="__codelineno-45-60" name="__codelineno-45-60" href="#__codelineno-45-60"></a>
<a id="__codelineno-45-61" name="__codelineno-45-61" href="#__codelineno-45-61"></a><span class="w">        </span><span class="c1">// Vérifier les résultats agrégés</span>
<a id="__codelineno-45-62" name="__codelineno-45-62" href="#__codelineno-45-62"></a><span class="w">        </span><span class="n">KeyValueStore</span><span class="o">&lt;</span><span class="n">Windowed</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-45-63" name="__codelineno-45-63" href="#__codelineno-45-63"></a><span class="w">            </span><span class="n">testDriver</span><span class="p">.</span><span class="na">getWindowStore</span><span class="p">(</span><span class="s">&quot;transaction-counts&quot;</span><span class="p">);</span>
<a id="__codelineno-45-64" name="__codelineno-45-64" href="#__codelineno-45-64"></a><span class="w">        </span><span class="c1">// ... assertions</span>
<a id="__codelineno-45-65" name="__codelineno-45-65" href="#__codelineno-45-65"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-45-66" name="__codelineno-45-66" href="#__codelineno-45-66"></a>
<a id="__codelineno-45-67" name="__codelineno-45-67" href="#__codelineno-45-67"></a><span class="w">    </span><span class="nd">@AfterEach</span>
<a id="__codelineno-45-68" name="__codelineno-45-68" href="#__codelineno-45-68"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">tearDown</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-45-69" name="__codelineno-45-69" href="#__codelineno-45-69"></a><span class="w">        </span><span class="n">testDriver</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
<a id="__codelineno-45-70" name="__codelineno-45-70" href="#__codelineno-45-70"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-45-71" name="__codelineno-45-71" href="#__codelineno-45-71"></a><span class="p">}</span>
</code></pre></div>
<h3 id="debogage-et-analyse-post-mortem">Débogage et Analyse Post-Mortem<a class="headerlink" href="#debogage-et-analyse-post-mortem" title="Permanent link">&para;</a></h3>
<p>Le débogage des applications Kafka Streams en production présente des défis uniques liés à la nature distribuée et continue du traitement. Plusieurs techniques facilitent le diagnostic :</p>
<p><strong>Traçage des enregistrements</strong> : L'injection d'identifiants de corrélation dans les enregistrements permet de suivre leur parcours à travers la topologie.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">TracedTransaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">traced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="w">    </span><span class="p">.</span><span class="na">mapValues</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">traceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MDC</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;traceId&quot;</span><span class="p">);</span>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">traceId</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="w">            </span><span class="n">traceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UUID</span><span class="p">.</span><span class="na">randomUUID</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span>
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TracedTransaction</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="w"> </span><span class="n">traceId</span><span class="p">);</span>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="w">    </span><span class="p">});</span>
</code></pre></div>
<p><strong>Points d'observation</strong> : L'opérateur <code>peek()</code> permet d'inspecter les enregistrements sans modifier le flux :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Transaction</span><span class="o">&gt;</span><span class="w"> </span><span class="n">observed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transactions</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="w">    </span><span class="p">.</span><span class="na">peek</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Processing transaction: key={}, value={}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">);</span>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">        </span><span class="n">metrics</span><span class="p">.</span><span class="na">recordProcessing</span><span class="p">(</span><span class="n">tx</span><span class="p">);</span>
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w">    </span><span class="p">});</span>
</code></pre></div>
<p><strong>Topics de débogage</strong> : La publication vers des topics dédiés au débogage capture les états intermédiaires pour analyse ultérieure :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="c1">// Topic de débogage pour les transformations intermédiaires</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="n">enrichedTransactions</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="w">    </span><span class="p">.</span><span class="na">filter</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">isDebugEnabled</span><span class="p">())</span>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="w">    </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&quot;debug-enriched-transactions&quot;</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p><strong>Anti-patron</strong>
Évitez d'activer un logging verbeux en production permanente. Le volume de logs généré par une application de streaming peut être considérable et impacter les performances. Préférez un logging conditionnel (par échantillonnage ou par flag dynamique) ou des métriques agrégées pour la surveillance continue
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>---
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>## III.8.8 Cas d&#39;Usage : Vue Client 360 en Temps Réel
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>### Contexte et Objectifs
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>La vue client 360 représente l&#39;un des cas d&#39;usage les plus courants et les plus valorisés du traitement de flux en entreprise. L&#39;objectif est de consolider en temps réel toutes les interactions d&#39;un client avec l&#39;entreprise, permettant une compréhension instantanée et complète de chaque relation client.
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>Dans ce cas d&#39;usage, nous allons concevoir une application Kafka Streams qui agrège les données de plusieurs sources : transactions, clics web, interactions service client, et activité sur l&#39;application mobile. Le résultat est un profil client enrichi, mis à jour en temps réel, qui peut alimenter des systèmes de personnalisation, de détection de risque, ou de service client.
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a>### Architecture de la Solution
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a>
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a>L&#39;architecture repose sur plusieurs topics Kafka alimentés par différentes sources, et une application Kafka Streams qui consolide ces flux en un profil unifié.
</code></pre></div>
┌──────────────┐   ┌──────────────┐   ┌──────────────┐   ┌──────────────┐
│ Transactions │   │   Clicks     │   │   Support    │   │    Mobile    │
│   (CDC)      │   │   (Events)   │   │   (Events)   │   │   (Events)   │
└──────┬───────┘   └──────┬───────┘   └──────┬───────┘   └──────┬───────┘
       │                  │                  │                  │
       ▼                  ▼                  ▼                  ▼
┌──────────────────────────────────────────────────────────────────────┐
│                         Apache Kafka                                  │
│  [transactions]    [web-clicks]    [support-tickets]    [mobile-events] │
└──────────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌──────────────────────────────────────────────────────────────────────┐
│                      Kafka Streams App                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  │
│  │ Transaction │  │   Click     │  │   Support   │  │   Mobile    │  │
│  │  Processor  │  │  Processor  │  │  Processor  │  │  Processor  │  │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  │
│         │                │                │                │         │
│         └────────────────┼────────────────┼────────────────┘         │
│                          ▼                ▼                          │
│                   ┌─────────────────────────────┐                    │
│                   │    Customer Profile Store   │                    │
│                   │        (KTable)             │                    │
│                   └──────────────┬──────────────┘                    │
└──────────────────────────────────┼───────────────────────────────────┘
                                   ▼
                          [customer-profiles]
                                   │
                                   ▼
                    ┌─────────────────────────────┐
                    │  Downstream Systems         │
                    │  (Personalization, CRM...)  │
                    └─────────────────────────────┘
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>### Implémentation
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>L&#39;implémentation commence par la définition des modèles de données et des sérialiseurs :
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>```java
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>// Modèles de données
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>@Data
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>public class CustomerProfile {
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>    private String customerId;
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>    private double totalSpent;
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>    private int transactionCount;
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>    private int clickCount;
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a>    private int supportTicketCount;
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a>    private int mobileSessionCount;
<a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a>    private Instant lastTransaction;
<a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a>    private Instant lastClick;
<a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a>    private Instant lastSupportContact;
<a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a>    private Instant lastMobileActivity;
<a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a>    private double riskScore;
<a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a>    private Instant updatedAt;
<a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a>
<a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a>    public CustomerProfile merge(CustomerProfile other) {
<a id="__codelineno-50-23" name="__codelineno-50-23" href="#__codelineno-50-23"></a>        this.totalSpent += other.totalSpent;
<a id="__codelineno-50-24" name="__codelineno-50-24" href="#__codelineno-50-24"></a>        this.transactionCount += other.transactionCount;
<a id="__codelineno-50-25" name="__codelineno-50-25" href="#__codelineno-50-25"></a>        this.clickCount += other.clickCount;
<a id="__codelineno-50-26" name="__codelineno-50-26" href="#__codelineno-50-26"></a>        this.supportTicketCount += other.supportTicketCount;
<a id="__codelineno-50-27" name="__codelineno-50-27" href="#__codelineno-50-27"></a>        this.mobileSessionCount += other.mobileSessionCount;
<a id="__codelineno-50-28" name="__codelineno-50-28" href="#__codelineno-50-28"></a>        updateTimestamps(other);
<a id="__codelineno-50-29" name="__codelineno-50-29" href="#__codelineno-50-29"></a>        this.updatedAt = Instant.now();
<a id="__codelineno-50-30" name="__codelineno-50-30" href="#__codelineno-50-30"></a>        return this;
<a id="__codelineno-50-31" name="__codelineno-50-31" href="#__codelineno-50-31"></a>    }
<a id="__codelineno-50-32" name="__codelineno-50-32" href="#__codelineno-50-32"></a>}
<a id="__codelineno-50-33" name="__codelineno-50-33" href="#__codelineno-50-33"></a>
<a id="__codelineno-50-34" name="__codelineno-50-34" href="#__codelineno-50-34"></a>// Application principale
<a id="__codelineno-50-35" name="__codelineno-50-35" href="#__codelineno-50-35"></a>public class Customer360App {
<a id="__codelineno-50-36" name="__codelineno-50-36" href="#__codelineno-50-36"></a>
<a id="__codelineno-50-37" name="__codelineno-50-37" href="#__codelineno-50-37"></a>    public static void main(String[] args) {
<a id="__codelineno-50-38" name="__codelineno-50-38" href="#__codelineno-50-38"></a>        Properties props = createConfig();
<a id="__codelineno-50-39" name="__codelineno-50-39" href="#__codelineno-50-39"></a>        StreamsBuilder builder = new StreamsBuilder();
<a id="__codelineno-50-40" name="__codelineno-50-40" href="#__codelineno-50-40"></a>
<a id="__codelineno-50-41" name="__codelineno-50-41" href="#__codelineno-50-41"></a>        // Flux d&#39;entrée
<a id="__codelineno-50-42" name="__codelineno-50-42" href="#__codelineno-50-42"></a>        KStream&lt;String, Transaction&gt; transactions = 
<a id="__codelineno-50-43" name="__codelineno-50-43" href="#__codelineno-50-43"></a>            builder.stream(&quot;transactions&quot;, 
<a id="__codelineno-50-44" name="__codelineno-50-44" href="#__codelineno-50-44"></a>                Consumed.with(Serdes.String(), transactionSerde));
<a id="__codelineno-50-45" name="__codelineno-50-45" href="#__codelineno-50-45"></a>
<a id="__codelineno-50-46" name="__codelineno-50-46" href="#__codelineno-50-46"></a>        KStream&lt;String, ClickEvent&gt; clicks = 
<a id="__codelineno-50-47" name="__codelineno-50-47" href="#__codelineno-50-47"></a>            builder.stream(&quot;web-clicks&quot;,
<a id="__codelineno-50-48" name="__codelineno-50-48" href="#__codelineno-50-48"></a>                Consumed.with(Serdes.String(), clickSerde));
<a id="__codelineno-50-49" name="__codelineno-50-49" href="#__codelineno-50-49"></a>
<a id="__codelineno-50-50" name="__codelineno-50-50" href="#__codelineno-50-50"></a>        KStream&lt;String, SupportTicket&gt; supportTickets = 
<a id="__codelineno-50-51" name="__codelineno-50-51" href="#__codelineno-50-51"></a>            builder.stream(&quot;support-tickets&quot;,
<a id="__codelineno-50-52" name="__codelineno-50-52" href="#__codelineno-50-52"></a>                Consumed.with(Serdes.String(), supportSerde));
<a id="__codelineno-50-53" name="__codelineno-50-53" href="#__codelineno-50-53"></a>
<a id="__codelineno-50-54" name="__codelineno-50-54" href="#__codelineno-50-54"></a>        KStream&lt;String, MobileEvent&gt; mobileEvents = 
<a id="__codelineno-50-55" name="__codelineno-50-55" href="#__codelineno-50-55"></a>            builder.stream(&quot;mobile-events&quot;,
<a id="__codelineno-50-56" name="__codelineno-50-56" href="#__codelineno-50-56"></a>                Consumed.with(Serdes.String(), mobileSerde));
<a id="__codelineno-50-57" name="__codelineno-50-57" href="#__codelineno-50-57"></a>
<a id="__codelineno-50-58" name="__codelineno-50-58" href="#__codelineno-50-58"></a>        // Transformation en profils partiels
<a id="__codelineno-50-59" name="__codelineno-50-59" href="#__codelineno-50-59"></a>        KStream&lt;String, CustomerProfile&gt; txProfiles = transactions
<a id="__codelineno-50-60" name="__codelineno-50-60" href="#__codelineno-50-60"></a>            .map((key, tx) -&gt; KeyValue.pair(
<a id="__codelineno-50-61" name="__codelineno-50-61" href="#__codelineno-50-61"></a>                tx.getCustomerId(),
<a id="__codelineno-50-62" name="__codelineno-50-62" href="#__codelineno-50-62"></a>                CustomerProfile.fromTransaction(tx)
<a id="__codelineno-50-63" name="__codelineno-50-63" href="#__codelineno-50-63"></a>            ));
<a id="__codelineno-50-64" name="__codelineno-50-64" href="#__codelineno-50-64"></a>
<a id="__codelineno-50-65" name="__codelineno-50-65" href="#__codelineno-50-65"></a>        KStream&lt;String, CustomerProfile&gt; clickProfiles = clicks
<a id="__codelineno-50-66" name="__codelineno-50-66" href="#__codelineno-50-66"></a>            .map((key, click) -&gt; KeyValue.pair(
<a id="__codelineno-50-67" name="__codelineno-50-67" href="#__codelineno-50-67"></a>                click.getCustomerId(),
<a id="__codelineno-50-68" name="__codelineno-50-68" href="#__codelineno-50-68"></a>                CustomerProfile.fromClick(click)
<a id="__codelineno-50-69" name="__codelineno-50-69" href="#__codelineno-50-69"></a>            ));
<a id="__codelineno-50-70" name="__codelineno-50-70" href="#__codelineno-50-70"></a>
<a id="__codelineno-50-71" name="__codelineno-50-71" href="#__codelineno-50-71"></a>        KStream&lt;String, CustomerProfile&gt; supportProfiles = supportTickets
<a id="__codelineno-50-72" name="__codelineno-50-72" href="#__codelineno-50-72"></a>            .map((key, ticket) -&gt; KeyValue.pair(
<a id="__codelineno-50-73" name="__codelineno-50-73" href="#__codelineno-50-73"></a>                ticket.getCustomerId(),
<a id="__codelineno-50-74" name="__codelineno-50-74" href="#__codelineno-50-74"></a>                CustomerProfile.fromSupportTicket(ticket)
<a id="__codelineno-50-75" name="__codelineno-50-75" href="#__codelineno-50-75"></a>            ));
<a id="__codelineno-50-76" name="__codelineno-50-76" href="#__codelineno-50-76"></a>
<a id="__codelineno-50-77" name="__codelineno-50-77" href="#__codelineno-50-77"></a>        KStream&lt;String, CustomerProfile&gt; mobileProfiles = mobileEvents
<a id="__codelineno-50-78" name="__codelineno-50-78" href="#__codelineno-50-78"></a>            .map((key, event) -&gt; KeyValue.pair(
<a id="__codelineno-50-79" name="__codelineno-50-79" href="#__codelineno-50-79"></a>                event.getCustomerId(),
<a id="__codelineno-50-80" name="__codelineno-50-80" href="#__codelineno-50-80"></a>                CustomerProfile.fromMobileEvent(event)
<a id="__codelineno-50-81" name="__codelineno-50-81" href="#__codelineno-50-81"></a>            ));
<a id="__codelineno-50-82" name="__codelineno-50-82" href="#__codelineno-50-82"></a>
<a id="__codelineno-50-83" name="__codelineno-50-83" href="#__codelineno-50-83"></a>        // Fusion des flux
<a id="__codelineno-50-84" name="__codelineno-50-84" href="#__codelineno-50-84"></a>        KStream&lt;String, CustomerProfile&gt; allProfiles = txProfiles
<a id="__codelineno-50-85" name="__codelineno-50-85" href="#__codelineno-50-85"></a>            .merge(clickProfiles)
<a id="__codelineno-50-86" name="__codelineno-50-86" href="#__codelineno-50-86"></a>            .merge(supportProfiles)
<a id="__codelineno-50-87" name="__codelineno-50-87" href="#__codelineno-50-87"></a>            .merge(mobileProfiles);
<a id="__codelineno-50-88" name="__codelineno-50-88" href="#__codelineno-50-88"></a>
<a id="__codelineno-50-89" name="__codelineno-50-89" href="#__codelineno-50-89"></a>        // Agrégation en profil complet
<a id="__codelineno-50-90" name="__codelineno-50-90" href="#__codelineno-50-90"></a>        KTable&lt;String, CustomerProfile&gt; customerProfiles = allProfiles
<a id="__codelineno-50-91" name="__codelineno-50-91" href="#__codelineno-50-91"></a>            .groupByKey(Grouped.with(Serdes.String(), profileSerde))
<a id="__codelineno-50-92" name="__codelineno-50-92" href="#__codelineno-50-92"></a>            .aggregate(
<a id="__codelineno-50-93" name="__codelineno-50-93" href="#__codelineno-50-93"></a>                CustomerProfile::new,
<a id="__codelineno-50-94" name="__codelineno-50-94" href="#__codelineno-50-94"></a>                (customerId, partial, aggregate) -&gt; aggregate.merge(partial),
<a id="__codelineno-50-95" name="__codelineno-50-95" href="#__codelineno-50-95"></a>                Materialized.&lt;String, CustomerProfile, KeyValueStore&lt;Bytes, byte[]&gt;&gt;
<a id="__codelineno-50-96" name="__codelineno-50-96" href="#__codelineno-50-96"></a>                    as(&quot;customer-profile-store&quot;)
<a id="__codelineno-50-97" name="__codelineno-50-97" href="#__codelineno-50-97"></a>                    .withKeySerde(Serdes.String())
<a id="__codelineno-50-98" name="__codelineno-50-98" href="#__codelineno-50-98"></a>                    .withValueSerde(profileSerde)
<a id="__codelineno-50-99" name="__codelineno-50-99" href="#__codelineno-50-99"></a>            );
<a id="__codelineno-50-100" name="__codelineno-50-100" href="#__codelineno-50-100"></a>
<a id="__codelineno-50-101" name="__codelineno-50-101" href="#__codelineno-50-101"></a>        // Publication des profils mis à jour
<a id="__codelineno-50-102" name="__codelineno-50-102" href="#__codelineno-50-102"></a>        customerProfiles.toStream()
<a id="__codelineno-50-103" name="__codelineno-50-103" href="#__codelineno-50-103"></a>            .to(&quot;customer-profiles&quot;, 
<a id="__codelineno-50-104" name="__codelineno-50-104" href="#__codelineno-50-104"></a>                Produced.with(Serdes.String(), profileSerde));
<a id="__codelineno-50-105" name="__codelineno-50-105" href="#__codelineno-50-105"></a>
<a id="__codelineno-50-106" name="__codelineno-50-106" href="#__codelineno-50-106"></a>        // Création et démarrage
<a id="__codelineno-50-107" name="__codelineno-50-107" href="#__codelineno-50-107"></a>        KafkaStreams streams = new KafkaStreams(builder.build(), props);
<a id="__codelineno-50-108" name="__codelineno-50-108" href="#__codelineno-50-108"></a>        streams.start();
<a id="__codelineno-50-109" name="__codelineno-50-109" href="#__codelineno-50-109"></a>    }
<a id="__codelineno-50-110" name="__codelineno-50-110" href="#__codelineno-50-110"></a>}
</code></pre></div></p>
</blockquote>
<h3 id="enrichissement-avec-calcul-de-risque">Enrichissement avec Calcul de Risque<a class="headerlink" href="#enrichissement-avec-calcul-de-risque" title="Permanent link">&para;</a></h3>
<p>Le profil peut être enrichi avec des calculs dérivés, comme un score de risque basé sur les patterns d'activité :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1">// Enrichissement avec score de risque</span>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="n">KStream</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="n">enrichedProfiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">customerProfiles</span>
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">    </span><span class="p">.</span><span class="na">toStream</span><span class="p">()</span>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">    </span><span class="p">.</span><span class="na">mapValues</span><span class="p">(</span><span class="n">profile</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">riskScore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">calculateRiskScore</span><span class="p">(</span><span class="n">profile</span><span class="p">);</span>
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">        </span><span class="n">profile</span><span class="p">.</span><span class="na">setRiskScore</span><span class="p">(</span><span class="n">riskScore</span><span class="p">);</span>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">profile</span><span class="p">;</span>
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="nf">calculateRiskScore</span><span class="p">(</span><span class="n">CustomerProfile</span><span class="w"> </span><span class="n">profile</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a>
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="w">    </span><span class="c1">// Facteur : Montant moyen des transactions</span>
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">avgTransaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">getTotalSpent</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="w">        </span><span class="n">Math</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">getTransactionCount</span><span class="p">());</span>
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">avgTransaction</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">5000</span><span class="p">)</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span>
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a>
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="w">    </span><span class="c1">// Facteur : Ratio support/transactions</span>
<a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">supportRatio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">getSupportTicketCount</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="w">        </span><span class="n">Math</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">profile</span><span class="p">.</span><span class="na">getTransactionCount</span><span class="p">());</span>
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">supportRatio</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.3</span><span class="p">)</span><span class="w"> </span><span class="n">score</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span>
<a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a>
<a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a><span class="w">    </span><span class="c1">// Facteur : Activité récente</span>
<a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a><span class="w">    </span><span class="n">Instant</span><span class="w"> </span><span class="n">oneWeekAgo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Instant</span><span class="p">.</span><span class="na">now</span><span class="p">().</span><span class="na">minus</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofDays</span><span class="p">(</span><span class="mi">7</span><span class="p">));</span>
<a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profile</span><span class="p">.</span><span class="na">getLastTransaction</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>
<a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a><span class="w">        </span><span class="n">profile</span><span class="p">.</span><span class="na">getLastTransaction</span><span class="p">().</span><span class="na">isBefore</span><span class="p">(</span><span class="n">oneWeekAgo</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a><span class="w">        </span><span class="n">score</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Inactivité = risque de churn</span>
<a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a>
<a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">score</span><span class="p">);</span>
<a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a><span class="p">}</span>
</code></pre></div>
<h3 id="interactive-queries-pour-acces-direct">Interactive Queries pour Accès Direct<a class="headerlink" href="#interactive-queries-pour-acces-direct" title="Permanent link">&para;</a></h3>
<p>Kafka Streams permet d'interroger directement les magasins d'état via les Interactive Queries, évitant un aller-retour via Kafka pour les lectures :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1">// Configuration pour les interactive queries</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">APPLICATION_SERVER_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;localhost:8080&quot;</span><span class="p">);</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="c1">// Service REST pour exposer les profils</span>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="nd">@RestController</span>
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomerProfileService</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">KafkaStreams</span><span class="w"> </span><span class="n">streams</span><span class="p">;</span>
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
<a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/customers/{customerId}&quot;</span><span class="p">)</span>
<a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getProfile</span><span class="p">(</span>
<a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">            </span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">customerId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>
<a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="w">        </span><span class="n">ReadOnlyKeyValueStore</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="w">            </span><span class="n">streams</span><span class="p">.</span><span class="na">store</span><span class="p">(</span>
<a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="w">                </span><span class="n">StoreQueryParameters</span><span class="p">.</span><span class="na">fromNameAndType</span><span class="p">(</span>
<a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">                    </span><span class="s">&quot;customer-profile-store&quot;</span><span class="p">,</span>
<a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="w">                    </span><span class="n">QueryableStoreTypes</span><span class="p">.</span><span class="na">keyValueStore</span><span class="p">()</span>
<a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="w">                </span><span class="p">)</span>
<a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="w">            </span><span class="p">);</span>
<a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a>
<a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a><span class="w">        </span><span class="n">CustomerProfile</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">customerId</span><span class="p">);</span>
<a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profile</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">notFound</span><span class="p">().</span><span class="na">build</span><span class="p">();</span>
<a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">profile</span><span class="p">);</span>
<a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a>
<a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a><span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/customers/high-risk&quot;</span><span class="p">)</span>
<a id="__codelineno-52-30" name="__codelineno-52-30" href="#__codelineno-52-30"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getHighRiskProfiles</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-31" name="__codelineno-52-31" href="#__codelineno-52-31"></a><span class="w">        </span><span class="n">ReadOnlyKeyValueStore</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<a id="__codelineno-52-32" name="__codelineno-52-32" href="#__codelineno-52-32"></a><span class="w">            </span><span class="n">streams</span><span class="p">.</span><span class="na">store</span><span class="p">(</span>
<a id="__codelineno-52-33" name="__codelineno-52-33" href="#__codelineno-52-33"></a><span class="w">                </span><span class="n">StoreQueryParameters</span><span class="p">.</span><span class="na">fromNameAndType</span><span class="p">(</span>
<a id="__codelineno-52-34" name="__codelineno-52-34" href="#__codelineno-52-34"></a><span class="w">                    </span><span class="s">&quot;customer-profile-store&quot;</span><span class="p">,</span>
<a id="__codelineno-52-35" name="__codelineno-52-35" href="#__codelineno-52-35"></a><span class="w">                    </span><span class="n">QueryableStoreTypes</span><span class="p">.</span><span class="na">keyValueStore</span><span class="p">()</span>
<a id="__codelineno-52-36" name="__codelineno-52-36" href="#__codelineno-52-36"></a><span class="w">                </span><span class="p">)</span>
<a id="__codelineno-52-37" name="__codelineno-52-37" href="#__codelineno-52-37"></a><span class="w">            </span><span class="p">);</span>
<a id="__codelineno-52-38" name="__codelineno-52-38" href="#__codelineno-52-38"></a>
<a id="__codelineno-52-39" name="__codelineno-52-39" href="#__codelineno-52-39"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="n">highRisk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-52-40" name="__codelineno-52-40" href="#__codelineno-52-40"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">KeyValueIterator</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="o">&gt;</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">store</span><span class="p">.</span><span class="na">all</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-41" name="__codelineno-52-41" href="#__codelineno-52-41"></a><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">iter</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-42" name="__codelineno-52-42" href="#__codelineno-52-42"></a><span class="w">                </span><span class="n">CustomerProfile</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iter</span><span class="p">.</span><span class="na">next</span><span class="p">().</span><span class="na">value</span><span class="p">;</span>
<a id="__codelineno-52-43" name="__codelineno-52-43" href="#__codelineno-52-43"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">profile</span><span class="p">.</span><span class="na">getRiskScore</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-52-44" name="__codelineno-52-44" href="#__codelineno-52-44"></a><span class="w">                    </span><span class="n">highRisk</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">profile</span><span class="p">);</span>
<a id="__codelineno-52-45" name="__codelineno-52-45" href="#__codelineno-52-45"></a><span class="w">                </span><span class="p">}</span>
<a id="__codelineno-52-46" name="__codelineno-52-46" href="#__codelineno-52-46"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-52-47" name="__codelineno-52-47" href="#__codelineno-52-47"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-52-48" name="__codelineno-52-48" href="#__codelineno-52-48"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">highRisk</span><span class="p">;</span>
<a id="__codelineno-52-49" name="__codelineno-52-49" href="#__codelineno-52-49"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-52-50" name="__codelineno-52-50" href="#__codelineno-52-50"></a><span class="p">}</span>
</code></pre></div>
<h3 id="lecons-et-bonnes-pratiques">Leçons et Bonnes Pratiques<a class="headerlink" href="#lecons-et-bonnes-pratiques" title="Permanent link">&para;</a></h3>
<p>Ce cas d'usage illustre plusieurs bonnes pratiques pour les applications Kafka Streams en production :</p>
<p><strong>Conception modulaire</strong> : Chaque source de données est traitée indépendamment avant fusion. Cette approche facilite l'ajout de nouvelles sources et le débogage.</p>
<p><strong>Agrégation incrémentale</strong> : Le profil est construit incrémentalement, chaque événement ajoutant sa contribution. Cette approche est plus efficace que la reconstruction complète à chaque événement.</p>
<p><strong>Enrichissement dérivé</strong> : Les calculs complexes comme le score de risque sont appliqués après l'agrégation, évitant des recalculs inutiles.</p>
<p><strong>Exposition via Interactive Queries</strong> : L'accès direct aux magasins d'état offre une latence inférieure à la consommation du topic de sortie, idéale pour les cas d'usage temps réel.</p>
<h3 id="gestion-de-la-retrocompatibilite-et-de-levolution">Gestion de la Rétrocompatibilité et de l'Évolution<a class="headerlink" href="#gestion-de-la-retrocompatibilite-et-de-levolution" title="Permanent link">&para;</a></h3>
<p>Dans un système de production, le profil client évoluera au fil du temps. L'ajout de nouveaux champs, la modification des calculs, ou l'intégration de nouvelles sources de données nécessitent une gestion soignée de la rétrocompatibilité.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="c1">// Gestion de l&#39;évolution du schéma avec des valeurs par défaut</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomerProfile</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">    </span><span class="c1">// Champs existants...</span>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">    </span><span class="c1">// Nouveau champ ajouté en v2</span>
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">lifetimeValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a>
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="w">    </span><span class="c1">// Nouveau champ ajouté en v3</span>
<a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">preferredCategories</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a>
<a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">CustomerProfile</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">CustomerProfile</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a><span class="w">        </span><span class="c1">// Logique de merge existante...</span>
<a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a>
<a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a><span class="w">        </span><span class="c1">// Gestion des nouveaux champs avec valeurs par défaut</span>
<a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="na">lifetimeValue</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lifetimeValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">max</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">lifetimeValue</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">.</span><span class="na">lifetimeValue</span><span class="p">);</span>
<a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">other</span><span class="p">.</span><span class="na">preferredCategories</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-53-19" name="__codelineno-53-19" href="#__codelineno-53-19"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">preferredCategories</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="na">preferredCategories</span><span class="p">);</span>
<a id="__codelineno-53-20" name="__codelineno-53-20" href="#__codelineno-53-20"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-53-21" name="__codelineno-53-21" href="#__codelineno-53-21"></a>
<a id="__codelineno-53-22" name="__codelineno-53-22" href="#__codelineno-53-22"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
<a id="__codelineno-53-23" name="__codelineno-53-23" href="#__codelineno-53-23"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-53-24" name="__codelineno-53-24" href="#__codelineno-53-24"></a><span class="p">}</span>
</code></pre></div>
<p>L'utilisation de Schema Registry avec des règles de compatibilité forward ou full garantit que les nouvelles versions du schéma sont compatibles avec les anciennes données stockées dans les magasins d'état.</p>
<h3 id="considerations-de-performance">Considérations de Performance<a class="headerlink" href="#considerations-de-performance" title="Permanent link">&para;</a></h3>
<p>La vue client 360 peut traiter des volumes considérables d'événements. Plusieurs optimisations permettent de maintenir les performances :</p>
<p><strong>Caching des agrégats</strong> : Le cache de Kafka Streams réduit le nombre d'écritures vers RocksDB et les topics de changelog en consolidant les mises à jour rapprochées.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="c1">// Configuration du cache pour optimiser les performances</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">CACHE_MAX_BYTES_BUFFERING_CONFIG</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">          </span><span class="mi">50</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1024</span><span class="p">);</span><span class="w">  </span><span class="c1">// 50 MB</span>
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="n">props</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">StreamsConfig</span><span class="p">.</span><span class="na">COMMIT_INTERVAL_MS_CONFIG</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span><span class="w">  </span><span class="c1">// Commit fréquent</span>
</code></pre></div>
<p><strong>Partitionnement stratégique</strong> : Le partitionnement par identifiant client assure que toutes les données d'un même client sont traitées par la même tâche, évitant les repartitionnements coûteux.</p>
<p><strong>Compression des messages</strong> : L'activation de la compression sur les topics réduit la bande passante réseau et l'espace de stockage.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="c1">// Compression pour le topic de sortie</span>
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="n">customerProfiles</span><span class="p">.</span><span class="na">toStream</span><span class="p">()</span>
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">    </span><span class="p">.</span><span class="na">to</span><span class="p">(</span><span class="s">&quot;customer-profiles&quot;</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">        </span><span class="n">Produced</span><span class="p">.</span><span class="na">with</span><span class="p">(</span><span class="n">Serdes</span><span class="p">.</span><span class="na">String</span><span class="p">(),</span><span class="w"> </span><span class="n">profileSerde</span><span class="p">)</span>
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">            </span><span class="p">.</span><span class="na">withStreamPartitioner</span><span class="p">((</span><span class="n">topic</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">numPartitions</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="w">                </span><span class="n">Math</span><span class="p">.</span><span class="na">abs</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="na">hashCode</span><span class="p">())</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">numPartitions</span><span class="p">));</span>
</code></pre></div>
<blockquote>
<p><strong>Anti-patron</strong>
Évitez de faire des appels externes (bases de données, APIs) dans le traitement des enregistrements. Ces appels introduisent une latence imprévisible et peuvent créer des goulots d'étranglement. Préférez charger les données de référence dans une KTable ou GlobalKTable, ou utiliser un pattern de pré-enrichissement via Kafka Connect.</p>
</blockquote>
<h3 id="supervision-et-alerting">Supervision et Alerting<a class="headerlink" href="#supervision-et-alerting" title="Permanent link">&para;</a></h3>
<p>Un système de vue client 360 en production nécessite une supervision robuste. Les métriques clés à surveiller incluent :</p>
<p><strong>Métriques de traitement</strong> :
- Taux de traitement (records-per-second)
- Latence de bout en bout
- Lag consommateur par partition</p>
<p><strong>Métriques d'état</strong> :
- Taille des magasins d'état
- Temps de restauration après redémarrage
- Taux de hit du cache</p>
<p><strong>Métriques métier</strong> :
- Nombre de profils actifs
- Distribution des scores de risque
- Volume d'événements par source</p>
<p>```java
// Exposition des métriques métier personnalisées
public class CustomerMetrics {
    private final MeterRegistry registry;</p>
<div class="highlight"><pre><span></span><code>public void recordProfileUpdate(CustomerProfile profile) {
    registry.counter(&quot;customer.profile.updates&quot;,
        &quot;risk_category&quot;, categorize(profile.getRiskScore()))
        .increment();

    registry.gauge(&quot;customer.profile.size&quot;, 
        profile, p -&gt; p.getSerializedSize());
}

private String categorize(double riskScore) {
    if (riskScore &gt; 0.7) return &quot;high&quot;;
    if (riskScore &gt; 0.4) return &quot;medium&quot;;
    return &quot;low&quot;;
}
</code></pre></div>
<p>}</p>
<hr />
<h2 id="iii89-resume">III.8.9 Résumé<a class="headerlink" href="#iii89-resume" title="Permanent link">&para;</a></h2>
<p>Ce chapitre a exploré en profondeur la conception d'applications de traitement de flux en continu avec Kafka Streams. Les points essentiels à retenir sont les suivants.</p>
<h3 id="fondements-conceptuels">Fondements Conceptuels<a class="headerlink" href="#fondements-conceptuels" title="Permanent link">&para;</a></h3>
<p>Le traitement de flux représente un changement de paradigme par rapport au batch, permettant des réponses en temps réel aux événements métier. La dualité flux-table constitue un concept fondamental : les flux représentent des séquences infinies d'événements tandis que les tables représentent l'état actuel pour chaque clé.</p>
<p>Kafka Streams se distingue par son modèle de bibliothèque embarquée, éliminant le besoin d'un cluster de traitement séparé. Cette approche simplifie significativement les opérations tout en préservant les garanties de fiabilité.</p>
<h3 id="architecture-et-traitement">Architecture et Traitement<a class="headerlink" href="#architecture-et-traitement" title="Permanent link">&para;</a></h3>
<p>L'architecture de Kafka Streams repose sur les topologies de traitement, composées de processeurs sources, de transformation et puits. Le parallélisme dérive directement du partitionnement Kafka, chaque partition correspondant à une tâche de traitement.</p>
<p>Les transformations se divisent en opérations sans état (filter, map, flatMap) et avec état (agrégation, fenêtrage, jointures). Les opérations avec état utilisent des magasins locaux sauvegardés dans des topics changelog pour la durabilité.</p>
<h3 id="garanties-et-fiabilite">Garanties et Fiabilité<a class="headerlink" href="#garanties-et-fiabilite" title="Permanent link">&para;</a></h3>
<p>Kafka Streams offre des garanties de traitement configurables, incluant exactly-once semantics via les transactions Kafka. La restauration de l'état après panne s'effectue via les topics changelog, avec la possibilité de répliques standby pour accélérer la récupération.</p>
<p>L'ordonnancement est garanti au niveau des partitions. Les mécanismes de gestion des erreurs permettent une tolérance gracieuse aux enregistrements malformés ou aux échecs de production.</p>
<h3 id="positionnement-ecosysteme">Positionnement Écosystème<a class="headerlink" href="#positionnement-ecosysteme" title="Permanent link">&para;</a></h3>
<p>Kafka Streams se positionne comme solution optimale pour les applications Java/Scala Kafka-centric, particulièrement les microservices. Apache Flink convient aux scénarios nécessitant des analyses très complexes ou une échelle massive. ksqlDB offre une abstraction SQL au-dessus de Kafka Streams pour les cas d'usage expressibles en SQL.</p>
<h3 id="considerations-operationnelles">Considérations Opérationnelles<a class="headerlink" href="#considerations-operationnelles" title="Permanent link">&para;</a></h3>
<p>Le dimensionnement doit anticiper le parallélisme souhaité via le nombre de partitions. La surveillance repose sur les métriques JMX exposées par Kafka Streams, couvrant le traitement, l'état et la consommation. Le déploiement suit les pratiques standard des applications Java, avec mise à l'échelle automatique via rebalance.</p>
<h3 id="evolutions-et-tendances">Évolutions et Tendances<a class="headerlink" href="#evolutions-et-tendances" title="Permanent link">&para;</a></h3>
<p>Les versions récentes de Kafka ont introduit des améliorations significatives pour Kafka Streams : partage des magasins d'état, découplage de la restauration, et assignateurs de tâches personnalisables. Kafka 4.0, avec l'élimination de ZooKeeper et l'adoption exclusive de KRaft, simplifiera l'infrastructure sous-jacente.</p>
<p>Les tendances émergentes incluent l'intégration croissante avec les architectures cloud-native, l'adoption des patterns de unbundled state pour une élasticité accrue, et le développement de fonctionnalités d'intelligence artificielle opérationnelle (AIOps) pour l'optimisation automatique des applications de streaming.</p>
<h3 id="recommandations-pour-les-architectes">Recommandations pour les Architectes<a class="headerlink" href="#recommandations-pour-les-architectes" title="Permanent link">&para;</a></h3>
<p>Pour les architectes envisageant l'adoption de Kafka Streams, les recommandations suivantes émergent de l'analyse présentée dans ce chapitre :</p>
<p><strong>Commencez par les cas d'usage appropriés</strong> : Kafka Streams excelle pour les transformations Kafka-à-Kafka, les enrichissements en temps réel, et les agrégations avec état modéré. Pour les très grandes échelles ou les analyses complexes multi-sources, évaluez également Flink.</p>
<p><strong>Investissez dans la compréhension des fondamentaux</strong> : Une maîtrise solide des concepts de topologie, de dualité flux-table, et de gestion d'état est préalable à la conception d'applications robustes.</p>
<p><strong>Planifiez le partitionnement dès le départ</strong> : Le nombre de partitions détermine le parallélisme maximal. La modification ultérieure est possible mais complexe en production.</p>
<p><strong>Adoptez une approche progressive</strong> : Commencez par des transformations simples, ajoutez des fonctionnalités avec état graduellement, et construisez l'expertise de l'équipe en parallèle.</p>
<p><strong>Surveillez proactivement</strong> : Les métriques de Kafka Streams sont riches et détaillées. Investissez dans des tableaux de bord complets avant la mise en production.</p>
<p><strong>Préparez la migration vers Kafka 4.0</strong> : Si votre infrastructure utilise encore ZooKeeper, planifiez la migration vers KRaft via une version bridge (3.9) avant l'adoption de Kafka 4.0.</p>
<h3 id="perspectives-futures">Perspectives Futures<a class="headerlink" href="#perspectives-futures" title="Permanent link">&para;</a></h3>
<p>L'avenir de Kafka Streams s'inscrit dans plusieurs tendances majeures de l'industrie. L'intégration avec les pipelines d'intelligence artificielle et d'apprentissage automatique devient de plus en plus importante, avec des cas d'usage comme le feature engineering en temps réel et l'inférence de modèles sur les flux.</p>
<p>La convergence avec les architectures de lakehouse, notamment via l'intégration Apache Iceberg, permettra des flux de travail unifiés batch et streaming avec des garanties ACID.</p>
<p>L'adoption croissante des architectures serverless influencera également l'évolution de Kafka Streams, avec des patterns d'auto-scaling plus dynamiques et une intégration plus étroite avec les plateformes infonuagiques.</p>
<p>Pour les architectes d'entreprise, Kafka Streams représente aujourd'hui l'un des choix les plus matures et les plus opérationnellement viables pour le traitement de flux. Son intégration native avec l'écosystème Kafka, sa simplicité de déploiement, et ses garanties de fiabilité en font un candidat de premier plan pour les initiatives de modernisation vers des architectures réactives et événementielles.</p>
<hr />
<p><em>Fin du chapitre III.8</em></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Retour en haut de la page
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/agbruneau/CorpusInformatique" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.indexes", "toc.integrate", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>